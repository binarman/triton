============================= test session starts ==============================
platform linux -- Python 3.9.19, pytest-7.3.2, pluggy-1.4.0
rootdir: /triton/python
plugins: shard-0.1.2, flakefinder-1.1.0, cpp-2.3.0, xdist-3.3.1, hypothesis-5.35.1, xdoctest-1.1.0, rerunfailures-14.0
collected 1 item
Running 1 items in this shard

python/test/unit/hopper/test_flashattention.py q input:  tensor([[[[ 3.5400e-01,  2.0935e-01,  1.2292e-01,  ...,  1.2494e-01,
            6.1768e-02,  2.9053e-01],
          [ 2.7100e-01,  2.5488e-01,  1.6040e-01,  ...,  4.6387e-01,
            4.9072e-01,  1.8787e-01],
          [-1.4197e-01, -3.2568e-01,  2.5049e-01,  ..., -2.1790e-01,
           -2.5879e-02,  6.3110e-02],
          ...,
          [ 2.7588e-01,  2.8516e-01, -9.9121e-02,  ...,  1.7212e-01,
            1.5015e-02,  2.3816e-01],
          [ 1.2610e-01,  1.3757e-01,  1.9763e-01,  ...,  2.7881e-01,
            2.1240e-01,  1.1639e-01],
          [ 6.9885e-02,  9.4666e-02, -3.2129e-01,  ...,  1.9995e-01,
            1.1743e-01, -1.3574e-01]],

         [[ 3.2776e-02, -9.9243e-02,  1.2067e-01,  ...,  1.1395e-01,
           -1.1902e-02,  1.6980e-01],
          [-2.3401e-01,  1.2170e-01, -1.5320e-01,  ..., -3.8965e-01,
            3.5400e-02, -3.0396e-02],
          [ 1.1963e-02,  1.0724e-01,  3.4424e-01,  ..., -3.0713e-01,
           -4.3091e-02,  2.7588e-02],
          ...,
          [ 1.8054e-01,  4.4287e-01, -1.7932e-01,  ..., -5.6519e-02,
            1.9434e-01,  5.2490e-03],
          [ 9.7839e-02, -2.5293e-01,  1.2500e-01,  ...,  2.9102e-01,
            1.4905e-01,  3.4570e-01],
          [ 2.9370e-01, -2.1667e-01,  5.6641e-02,  ...,  1.2976e-01,
            4.1357e-01,  1.5369e-01]],

         [[ 2.4048e-02,  1.6602e-01, -2.7148e-01,  ...,  3.2178e-01,
            1.7493e-01,  1.8054e-01],
          [ 2.1460e-01,  1.1627e-01,  7.4341e-02,  ...,  2.4353e-02,
            1.1194e-01,  2.5146e-01],
          [ 1.7798e-01, -8.2520e-02,  1.1169e-02,  ..., -2.6318e-01,
            1.1829e-01,  5.5634e-02],
          ...,
          [ 8.8745e-02, -8.4106e-02,  4.9652e-02,  ..., -2.0056e-01,
            1.0052e-01,  9.3506e-02],
          [ 3.1128e-02,  3.1799e-02,  1.9263e-01,  ...,  3.3301e-01,
            1.8701e-01,  1.6284e-01],
          [-1.2793e-01,  5.7251e-02,  2.1936e-01,  ..., -1.5625e-02,
            1.6309e-01, -3.1616e-02]],

         ...,

         [[-1.9104e-01,  2.3682e-01,  7.8186e-02,  ..., -2.0447e-01,
            1.9385e-01, -1.2476e-01],
          [ 2.9297e-02,  4.5776e-02,  1.0260e-01,  ..., -1.5027e-01,
            1.3489e-01,  2.9688e-01],
          [ 4.8370e-02, -1.3611e-01,  1.3428e-01,  ...,  1.2524e-01,
            1.1292e-01, -2.0593e-01],
          ...,
          [ 1.3293e-01,  1.7114e-01, -8.3374e-02,  ..., -3.1982e-02,
            3.5303e-01,  8.4106e-02],
          [ 8.6121e-02,  1.4368e-01,  1.8787e-01,  ..., -7.2144e-02,
           -9.3140e-02,  2.1143e-01],
          [-2.5513e-02, -6.6895e-02,  1.0864e-01,  ...,  1.8933e-01,
           -3.3447e-02,  8.3008e-02]],

         [[ 1.7810e-01, -5.5664e-02,  2.5977e-01,  ...,  6.7139e-02,
            8.6121e-02,  4.4678e-01],
          [ 1.3489e-01,  2.8662e-01,  4.5044e-02,  ...,  9.5886e-02,
            1.2439e-01,  3.4729e-02],
          [-3.0615e-01,  2.4146e-01,  7.2388e-02,  ...,  6.5308e-02,
            1.2805e-01,  3.9185e-02],
          ...,
          [-2.9150e-01, -6.3477e-02,  7.1472e-02,  ...,  3.1445e-01,
            6.3477e-01,  3.5596e-01],
          [ 4.2969e-01,  1.3586e-01,  1.2537e-01,  ...,  2.5049e-01,
           -3.9917e-02, -5.9375e-01],
          [ 9.7412e-02,  5.9229e-01,  1.8164e-01,  ..., -3.7793e-01,
            1.6553e-01, -4.9194e-02]],

         [[-1.2402e-01,  2.3633e-01, -8.5205e-02,  ..., -3.1738e-01,
           -9.9365e-02,  2.7881e-01],
          [ 1.3965e-01,  5.0537e-02, -7.0190e-02,  ...,  1.6797e-01,
            3.2715e-01,  2.9102e-01],
          [-3.1689e-01,  1.6724e-01,  1.3794e-01,  ...,  1.9775e-01,
           -1.6711e-01,  7.8125e-02],
          ...,
          [-4.1748e-02,  3.3740e-01,  4.4727e-01,  ..., -8.3618e-02,
            2.0544e-01,  3.1799e-02],
          [-2.5391e-01,  1.5161e-01,  3.5400e-03,  ...,  1.0974e-01,
            1.9141e-01, -1.8787e-01],
          [ 3.4961e-01, -2.8125e-01,  1.6931e-01,  ...,  1.7297e-01,
            4.2529e-01,  2.8540e-01]]],


        [[[-1.2878e-02,  1.4294e-01,  1.2866e-01,  ...,  4.1357e-01,
            4.2725e-01, -9.1553e-03],
          [-4.9561e-01, -2.5146e-02,  1.5552e-01,  ...,  1.7859e-01,
           -4.6143e-02,  6.6956e-02],
          [-1.2207e-01,  4.6753e-02,  3.6914e-01,  ..., -8.7402e-02,
            2.3633e-01,  1.0986e-03],
          ...,
          [ 4.7394e-02,  4.8828e-04, -2.3425e-01,  ..., -1.0803e-01,
            1.8762e-01,  3.4717e-01],
          [ 3.4424e-01,  3.8477e-01,  2.0190e-01,  ..., -7.5195e-02,
            4.9072e-01, -2.2961e-01],
          [-2.0569e-01,  5.4932e-01,  1.9775e-02,  ..., -3.5522e-02,
            2.4805e-01,  1.1646e-01]],

         [[ 3.5449e-01, -1.3794e-02,  6.0028e-02,  ...,  4.6661e-02,
            2.7100e-01, -1.8567e-01],
          [ 2.5146e-01, -1.4453e-01,  9.1553e-03,  ...,  4.2511e-02,
            1.9849e-01,  6.2500e-01],
          [ 3.2080e-01,  3.9258e-01, -1.1597e-02,  ..., -4.4312e-02,
           -3.0762e-02, -1.7908e-01],
          ...,
          [ 3.2666e-01,  1.7578e-01,  1.1609e-01,  ..., -9.2529e-02,
           -1.3000e-01, -1.3489e-01],
          [ 2.2754e-01, -4.0649e-02, -1.7212e-02,  ...,  2.8296e-01,
            1.2781e-01, -7.3730e-02],
          [ 9.9976e-02, -2.4768e-01, -1.6235e-02,  ...,  3.8330e-01,
            1.7627e-01, -1.4270e-01]],

         [[ 4.1357e-01, -6.0913e-02,  7.9895e-02,  ..., -1.8835e-01,
           -5.7617e-02,  2.3450e-01],
          [-1.0327e-01,  5.2295e-01,  2.6709e-01,  ..., -1.4099e-01,
           -1.0864e-02,  2.6074e-01],
          [ 2.5317e-01, -1.7542e-01, -3.1836e-01,  ...,  1.6260e-01,
           -4.3335e-02, -2.3376e-01],
          ...,
          [ 2.3682e-02,  1.6174e-01,  5.6152e-01,  ...,  2.3743e-01,
           -5.6641e-02,  9.6191e-02],
          [ 3.9795e-01, -3.6328e-01,  2.9443e-01,  ...,  3.8232e-01,
            4.0137e-01, -1.0315e-01],
          [-1.0620e-01, -2.9663e-02, -2.9297e-03,  ...,  3.1616e-01,
           -4.6875e-01,  3.6475e-01]],

         ...,

         [[-4.4312e-02,  8.0811e-02, -6.2744e-02,  ...,  4.0479e-01,
            3.5059e-01,  3.2031e-01],
          [ 2.7051e-01, -2.6465e-01, -5.1636e-02,  ..., -9.8389e-02,
            1.2286e-01,  2.3157e-01],
          [ 3.9398e-02,  2.8857e-01,  6.4941e-01,  ...,  2.8027e-01,
           -1.1340e-01, -1.0840e-01],
          ...,
          [ 2.9639e-01,  4.9365e-01,  6.0669e-02,  ...,  2.2070e-01,
            1.0583e-01,  3.1250e-01],
          [-3.1885e-01,  2.9980e-01,  1.9409e-02,  ..., -4.4678e-02,
            3.6426e-01,  8.7097e-02],
          [ 4.0332e-01,  2.4878e-01, -7.0190e-03,  ...,  1.4368e-01,
           -1.4429e-01,  5.0488e-01]],

         [[ 3.0737e-01, -2.2888e-01,  2.9053e-02,  ...,  3.8965e-01,
            5.3772e-02,  4.7363e-02],
          [ 8.7402e-02, -1.0254e-01,  3.6768e-01,  ...,  1.6504e-01,
            3.4521e-01, -1.2854e-01],
          [ 2.4463e-01,  1.9946e-01, -7.0068e-02,  ...,  7.6172e-02,
           -3.8696e-02,  3.5095e-02],
          ...,
          [ 3.5706e-02,  4.8193e-01,  1.5552e-01,  ..., -2.3376e-01,
           -1.3611e-01,  6.3599e-02],
          [-6.3965e-02, -3.6499e-02,  2.6709e-01,  ...,  1.5784e-01,
           -4.3018e-01, -6.1646e-02],
          [ 3.8330e-01, -6.0425e-02,  1.2830e-01,  ...,  1.7358e-01,
            4.4873e-01, -6.2134e-02]],

         [[-6.1646e-03,  1.1597e-02, -2.0142e-02,  ...,  3.2178e-01,
            2.9834e-01,  4.5850e-01],
          [ 9.7656e-04,  3.8910e-02,  1.6516e-01,  ...,  7.5684e-03,
            2.5366e-01,  3.1104e-01],
          [ 5.8075e-02,  3.8037e-01,  1.1688e-01,  ...,  8.7891e-02,
            1.2915e-01,  9.6985e-02],
          ...,
          [ 1.4856e-01, -2.7979e-01, -3.6255e-02,  ...,  2.3914e-01,
            4.4824e-01,  6.7749e-03],
          [-1.6479e-03,  1.9250e-01,  1.7993e-01,  ...,  2.3108e-01,
            8.1787e-03, -1.1438e-01],
          [-2.2131e-01,  4.7021e-01, -1.8555e-02,  ...,  3.8574e-01,
            1.4624e-01,  1.6528e-01]]],


        [[[-2.3889e-01,  3.0078e-01, -1.4526e-01,  ..., -1.6174e-01,
            8.4839e-02,  2.6709e-01],
          [-2.9199e-01, -1.2183e-01,  1.6504e-01,  ...,  9.1064e-02,
            4.8340e-01,  1.3977e-01],
          [ 5.8301e-01,  2.1399e-01, -2.6367e-01,  ..., -1.0645e-01,
            3.8623e-01, -2.4719e-01],
          ...,
          [ 1.5454e-01, -3.4033e-01,  1.9531e-03,  ..., -1.2598e-01,
            2.3254e-01,  6.0394e-02],
          [ 3.2520e-01,  5.6445e-01, -1.4941e-01,  ...,  2.5732e-01,
            1.5137e-01,  1.3403e-01],
          [ 2.9858e-01,  1.2402e-01, -3.9062e-03,  ...,  3.2520e-01,
           -9.7046e-02,  3.4546e-01]],

         [[-9.1797e-02,  9.0637e-02,  1.3953e-01,  ...,  9.5764e-02,
            1.5991e-01,  2.5049e-01],
          [-1.0461e-01,  2.7466e-03,  1.7163e-01,  ..., -1.4978e-01,
            1.8872e-01,  1.2646e-01],
          [-4.0430e-01,  2.8955e-01,  4.7217e-01,  ..., -2.6123e-02,
            6.3965e-02,  1.3953e-01],
          ...,
          [ 1.7065e-01, -1.3928e-01,  1.7029e-02,  ...,  1.0767e-01,
           -4.1650e-01, -3.0518e-01],
          [-2.4231e-01,  7.6355e-02,  1.8420e-01,  ..., -1.6028e-01,
           -7.6660e-02,  3.8672e-01],
          [ 1.9202e-01,  5.6836e-01, -1.0864e-02,  ...,  2.5391e-01,
           -1.8469e-01,  4.7455e-02]],

         [[ 2.1143e-01,  4.8828e-01,  2.0801e-01,  ..., -9.9121e-02,
            5.1147e-02,  1.4038e-03],
          [ 1.6333e-01,  2.3315e-02, -2.2302e-01,  ...,  4.7852e-02,
           -2.0374e-01,  2.2461e-01],
          [-1.9324e-01,  1.6919e-01, -3.9795e-01,  ..., -3.6621e-02,
            4.7754e-01,  1.2769e-01],
          ...,
          [-1.5808e-01,  1.5369e-01, -2.0752e-03,  ..., -2.0911e-01,
            1.9897e-01,  3.1421e-01],
          [-1.1438e-01,  3.4131e-01, -1.1230e-02,  ...,  1.2048e-01,
            2.9321e-01,  2.9688e-01],
          [ 3.8037e-01,  2.2266e-01,  4.2432e-01,  ...,  2.6440e-01,
            1.7065e-01, -2.0508e-02]],

         ...,

         [[ 2.6611e-02, -3.8696e-02, -7.9346e-03,  ..., -4.3457e-02,
            1.8750e-01,  1.5234e-01],
          [ 1.6382e-01,  1.9104e-01,  5.1575e-02,  ...,  4.4531e-01,
            4.4708e-02,  2.7344e-01],
          [ 2.6123e-02,  3.9111e-01,  2.0935e-01,  ..., -1.4136e-01,
            4.6722e-02,  8.6487e-02],
          ...,
          [ 3.0420e-01, -2.4695e-01, -1.2988e-01,  ...,  1.3794e-02,
            1.5820e-01,  3.2275e-01],
          [ 5.0720e-02,  8.5083e-02,  1.9556e-01,  ..., -2.6318e-01,
            4.6387e-03, -2.9053e-02],
          [-2.0374e-01,  1.3416e-01,  4.7119e-02,  ..., -4.4800e-02,
           -2.8418e-01,  2.4902e-01]],

         [[ 1.6003e-01,  7.2754e-02, -1.4136e-01,  ...,  9.0332e-03,
            1.7517e-01,  2.2424e-01],
          [ 2.0874e-02, -2.1716e-01, -1.6199e-01,  ...,  1.9409e-02,
            6.9824e-02,  1.4673e-01],
          [ 8.1238e-02,  3.3765e-01,  3.6865e-01,  ..., -2.0129e-01,
            3.0762e-01, -1.5125e-01],
          ...,
          [ 1.9800e-01,  2.5488e-01, -5.2979e-02,  ..., -8.4595e-02,
           -1.4368e-01,  2.2473e-01],
          [-2.7954e-02,  2.8931e-02, -9.5459e-02,  ...,  6.0394e-02,
           -1.9421e-01, -9.9731e-02],
          [-6.6772e-02, -1.8347e-01,  7.5378e-02,  ...,  5.7666e-01,
            3.8818e-02,  1.1609e-01]],

         [[ 3.2690e-01, -7.9834e-02, -1.9910e-01,  ...,  4.0527e-01,
            8.4839e-03,  1.6394e-01],
          [ 2.1765e-01,  1.9299e-01,  2.6367e-01,  ..., -7.9224e-02,
            4.2139e-01, -1.5222e-01],
          [ 5.2783e-01,  7.5073e-02, -1.7212e-02,  ...,  3.4790e-03,
            2.5818e-02, -4.7119e-02],
          ...,
          [ 8.5693e-02, -1.6394e-01,  3.5693e-01,  ..., -8.9111e-03,
           -1.4880e-01, -1.2927e-01],
          [ 1.9031e-01,  4.2334e-01, -5.4321e-02,  ...,  7.1289e-02,
            4.1357e-01, -1.1389e-01],
          [ 2.2522e-01, -6.7749e-02,  5.1422e-02,  ..., -5.6763e-03,
            4.5850e-01, -3.9062e-02]]],


        [[[ 2.1680e-01,  2.1594e-01,  2.4036e-01,  ...,  2.4719e-01,
            3.5303e-01,  8.4839e-03],
          [ 5.6885e-02,  1.0883e-01, -3.1494e-02,  ...,  8.6792e-02,
            2.0312e-01,  7.7393e-02],
          [ 3.0249e-01,  1.0516e-01, -7.7393e-02,  ...,  4.2334e-01,
           -3.4863e-01,  1.0480e-01],
          ...,
          [-2.0325e-01,  1.9983e-01,  1.8115e-01,  ...,  2.9053e-02,
            4.9072e-01,  3.4961e-01],
          [ 1.5930e-01,  3.0762e-01, -4.1260e-02,  ...,  7.0679e-02,
           -8.1177e-02,  8.3862e-02],
          [-7.8857e-02,  5.3345e-02, -3.0078e-01,  ...,  1.9336e-01,
            1.5503e-01, -1.2500e-01]],

         [[ 3.4082e-01,  4.4775e-01, -6.8604e-02,  ..., -1.7517e-01,
            1.4771e-02, -1.4429e-01],
          [-2.1362e-03, -3.2568e-01,  1.3306e-01,  ...,  1.9971e-01,
            2.2424e-01,  5.8789e-01],
          [ 3.0762e-01,  6.0028e-02,  8.2153e-02,  ...,  5.7080e-01,
            2.8491e-01,  4.0894e-02],
          ...,
          [ 1.9409e-02,  3.2983e-01,  1.8970e-01,  ..., -8.4229e-03,
           -1.1914e-01, -1.7322e-01],
          [-8.2397e-02, -9.3140e-02,  1.0205e-01,  ...,  2.6184e-02,
           -4.9194e-02,  4.1602e-01],
          [ 4.3555e-01,  1.3025e-01,  2.0264e-01,  ..., -4.0649e-02,
           -9.1675e-02, -1.5320e-02]],

         [[ 3.0640e-01,  3.2764e-01,  7.8674e-02,  ...,  1.1493e-01,
           -2.6489e-02,  3.1055e-01],
          [ 3.2861e-01,  3.4619e-01,  1.1023e-01,  ...,  1.6736e-01,
            3.2812e-01,  2.7490e-01],
          [-5.3955e-02,  2.2144e-01, -9.5825e-03,  ..., -1.5051e-01,
            9.1553e-02,  1.6772e-01],
          ...,
          [ 6.8115e-02, -1.0938e-01,  1.3818e-01,  ...,  2.1094e-01,
            1.7676e-01, -1.6443e-01],
          [ 2.3499e-02,  9.3567e-02,  3.1799e-02,  ..., -2.5146e-02,
           -1.3574e-01, -1.2012e-01],
          [-1.0559e-02,  4.0802e-02, -9.1064e-02,  ...,  1.3147e-01,
            1.4783e-01,  2.5269e-02]],

         ...,

         [[ 2.0044e-01,  2.3401e-01, -3.2837e-02,  ..., -2.1545e-01,
            2.2534e-01,  3.2007e-01],
          [ 7.7759e-02,  2.0581e-01,  3.5254e-01,  ...,  3.6279e-01,
            3.5205e-01, -5.6763e-03],
          [ 3.3997e-02,  1.3684e-01,  1.0205e-01,  ...,  4.5557e-01,
           -1.1096e-01, -3.4790e-02],
          ...,
          [ 7.2449e-02,  6.0608e-02,  7.2632e-02,  ...,  3.5706e-02,
            3.3447e-01,  2.4646e-01],
          [-2.6123e-01,  4.1504e-01, -1.8152e-01,  ...,  4.2920e-01,
            3.1055e-01, -4.6875e-02],
          [-1.1731e-01,  4.6143e-01, -2.3499e-01,  ...,  2.8345e-01,
            2.1204e-01,  9.5398e-02]],

         [[ 4.3604e-01,  8.1543e-02,  3.9062e-02,  ...,  1.1658e-02,
            1.8127e-02,  1.5051e-01],
          [ 3.4937e-01,  2.2852e-01,  8.5388e-02,  ..., -1.7297e-01,
            3.1555e-02, -1.0254e-01],
          [ 9.2957e-02,  3.3374e-01,  6.2622e-02,  ..., -5.5664e-02,
            6.9275e-02, -2.0142e-02],
          ...,
          [ 3.4619e-01,  2.4084e-01,  2.9102e-01,  ...,  6.6772e-02,
            1.3306e-01, -1.1597e-02],
          [ 2.1790e-01,  5.5713e-01, -4.4678e-02,  ...,  4.7699e-02,
            1.7236e-01,  2.4878e-01],
          [-1.3806e-01, -1.7273e-01,  7.4219e-02,  ..., -2.3694e-01,
            1.7676e-01,  1.9409e-01]],

         [[ 2.7441e-01,  4.4189e-01, -3.4302e-02,  ...,  1.1694e-01,
            1.7432e-01, -3.8330e-02],
          [-5.0903e-02,  2.9688e-01, -1.3391e-01,  ..., -1.2329e-02,
            1.1530e-01,  9.8877e-03],
          [ 4.1846e-01,  6.6528e-03, -3.6279e-01,  ...,  1.7261e-01,
            2.4805e-01, -5.1025e-02],
          ...,
          [ 1.5820e-01,  4.1687e-02,  5.2783e-01,  ...,  3.7305e-01,
            1.5369e-01,  2.9102e-01],
          [-1.5051e-01,  2.1155e-01, -2.8320e-01,  ...,  3.0835e-01,
            5.0977e-01,  1.0626e-01],
          [ 3.8330e-01,  1.3733e-01,  3.2288e-02,  ...,  2.3633e-01,
           -2.1130e-01,  1.1407e-01]]]], dtype=torch.float16,
       requires_grad=True)
k input:  tensor([[[[ 0.5918,  0.3555,  0.6709,  ...,  0.4880,  0.2852,  0.1199],
          [ 0.6094,  0.1130,  0.2235,  ...,  0.1693,  0.2881,  0.3381],
          [ 0.4475,  0.1980,  0.0713,  ...,  0.2776,  0.4707,  0.1304],
          ...,
          [-0.0586,  0.3979,  0.4495,  ...,  0.4561,  0.8262,  0.2988],
          [ 0.4504,  0.5454,  0.3833,  ...,  0.0811,  0.2072,  0.3401],
          [ 0.4285,  0.4458,  0.4392,  ...,  0.1067,  0.3755,  0.3127]],

         [[ 0.2524,  0.2441,  0.1724,  ...,  0.2205,  0.6431,  0.3362],
          [ 0.2861,  0.5156,  0.0505,  ...,  0.2676,  0.4270,  0.4946],
          [ 0.2896,  0.4902,  0.1365,  ...,  0.3547, -0.0325,  0.3843],
          ...,
          [ 0.4031,  0.6348,  0.3955,  ...,  0.4885,  0.3145,  0.3262],
          [ 0.3718,  0.5859,  0.3442,  ...,  0.0493, -0.0298,  0.4819],
          [ 0.4929,  0.4873,  0.4810,  ...,  0.5640,  0.7031,  0.1779]],

         [[ 0.4639,  0.4800,  0.3723,  ...,  0.4702,  0.0962,  0.7046],
          [ 0.3965,  0.6738,  0.5200,  ...,  0.8193,  0.3120,  0.2617],
          [ 0.0952,  0.2969,  0.2849,  ..., -0.0503,  0.5688,  0.5366],
          ...,
          [ 0.2145,  0.3086,  0.4033,  ...,  0.3406,  0.3845,  0.5020],
          [ 0.2705,  0.3132,  0.3906,  ...,  0.5625,  0.3765,  0.3679],
          [ 0.1133,  0.5278,  0.3225,  ...,  0.2820,  0.4937,  0.0498]],

         ...,

         [[ 0.4712,  0.3740,  0.6963,  ...,  0.0913,  0.7788,  0.4626],
          [ 0.4312,  0.6270,  0.0645,  ...,  0.4653,  0.7622,  0.5898],
          [ 0.5049,  0.4021,  0.4512,  ...,  0.2720,  0.4275,  0.3853],
          ...,
          [ 0.0986,  0.3877,  0.3762,  ...,  0.3052,  0.5166,  0.4233],
          [ 0.2078,  0.2759,  0.6362,  ...,  0.4380,  0.5693,  0.5366],
          [ 0.4585,  0.6357,  0.5039,  ...,  0.6162,  0.2251,  0.4521]],

         [[ 0.5444,  0.2460,  0.3850,  ...,  0.2383,  0.6982,  0.3096],
          [ 0.1523,  1.0312,  0.5601,  ...,  0.2080,  0.4438,  0.4041],
          [ 0.5801,  0.2227,  0.8140,  ...,  0.5669,  0.2742,  0.4563],
          ...,
          [ 0.2896,  0.2268,  0.4380,  ..., -0.0591,  0.1976,  0.3560],
          [ 0.3728,  0.2046,  0.6392,  ...,  0.3440,  0.1147,  0.3572],
          [ 0.0425,  0.2156,  0.4280,  ...,  0.2974,  0.6338,  0.6294]],

         [[ 0.3108,  0.5312,  0.5146,  ...,  0.2319,  0.5234,  0.5859],
          [ 0.5078,  0.5903,  0.4795,  ...,  0.5454,  0.5200,  0.3850],
          [-0.0378,  0.4414,  0.4014,  ...,  0.3286,  0.3367,  0.4409],
          ...,
          [ 0.0139,  0.5693,  0.6152,  ...,  0.0249,  0.4893,  0.3259],
          [ 0.2961,  0.4509,  0.2671,  ..., -0.1045,  0.2805,  0.3765],
          [ 0.4470,  0.3306,  0.4126,  ...,  0.2520,  0.3430,  0.5176]]],


        [[[ 0.3047,  0.3325,  0.3765,  ...,  0.1534,  0.1416,  0.5723],
          [ 0.3052,  0.4614,  0.4573,  ...,  0.4414,  0.4292,  0.2512],
          [ 0.4604,  0.6289,  0.2566,  ...,  0.8926,  0.2842,  0.4067],
          ...,
          [ 0.3674,  0.4292,  0.7041,  ...,  0.3999,  0.2878,  0.6011],
          [ 0.7588,  0.1338,  0.3423,  ...,  0.3047,  0.3154,  0.3079],
          [ 0.0239,  0.3647,  0.3657,  ...,  0.6670,  0.5088,  0.1448]],

         [[ 0.1001,  0.0830,  0.3384,  ...,  0.4163,  0.5679,  0.8179],
          [ 0.5469,  0.2059,  0.0200,  ...,  0.5576,  0.5532,  0.2303],
          [ 0.3721,  0.2695,  0.2791,  ...,  0.2515,  0.3987,  0.5195],
          ...,
          [ 0.5610,  0.4355,  0.3723,  ...,  0.1252,  0.5254,  0.4595],
          [ 0.7163,  0.4167,  0.6768,  ...,  0.5142,  0.1184,  0.3938],
          [ 0.4011,  0.4529,  0.1064,  ...,  0.1697,  0.3850,  0.5273]],

         [[ 0.4971,  0.4614,  0.2407,  ...,  0.2588,  0.0374,  0.2954],
          [ 0.5820,  0.2603,  0.1873,  ...,  0.2477,  0.2981,  0.3022],
          [ 0.4133,  0.1957,  0.3838,  ...,  0.5405,  0.3794,  0.2949],
          ...,
          [ 0.2632,  0.2842,  0.4839,  ...,  0.6284,  0.2522,  0.5840],
          [ 0.5610,  0.1519,  0.3645,  ...,  0.5347,  0.2025,  0.5000],
          [ 0.5874,  0.3159,  0.0090,  ...,  0.0591,  0.5293,  0.5186]],

         ...,

         [[ 0.1888,  0.3694,  0.4561,  ...,  0.6670,  0.6992,  0.0962],
          [ 0.4980,  0.5815,  0.3916,  ...,  0.4424,  0.3403,  0.2112],
          [ 0.4302,  0.2137,  0.2542,  ..., -0.0554,  0.4021,  0.3818],
          ...,
          [ 0.2120,  0.2534,  0.3804,  ...,  0.6099,  0.4214,  0.1888],
          [ 0.7983,  0.4758,  0.4790,  ...,  0.4399,  0.2236,  0.3057],
          [ 0.3257,  0.2534,  0.3479,  ...,  0.0059,  0.3108,  0.2524]],

         [[-0.0601,  0.5879,  0.4836,  ...,  0.3757,  0.4121,  0.5171],
          [ 0.8896,  0.0669,  0.3655,  ...,  0.1996,  0.4863,  0.8140],
          [ 0.5742,  0.6748,  0.5200,  ...,  0.4565,  0.5322, -0.0398],
          ...,
          [ 0.2986,  0.8633,  0.1544,  ...,  0.3594,  0.3823,  0.5415],
          [ 0.2419,  0.3501,  0.2656,  ...,  0.7686,  0.4460,  0.3308],
          [ 0.3296,  0.3330,  0.2710,  ...,  0.4509,  0.4414, -0.0066]],

         [[ 0.2317,  0.4578,  0.3972,  ...,  0.1722,  0.5166,  0.4597],
          [ 0.0967,  0.4905,  0.1625,  ...,  0.1316,  0.4055,  0.3804],
          [ 0.2847,  0.5439,  0.6748,  ...,  0.4531,  0.0718,  0.6885],
          ...,
          [ 0.5293,  0.1743,  0.3262,  ...,  0.6582,  0.5117,  0.5806],
          [ 0.0505,  0.5513,  0.6299,  ...,  0.1353,  0.3655,  0.3188],
          [ 0.2549,  0.2822,  0.7256,  ...,  0.5996,  0.2041,  0.3599]]],


        [[[ 0.6270,  0.5576,  0.6445,  ...,  0.3982,  0.6089,  0.3730],
          [ 0.2554,  0.3879,  0.5488,  ...,  0.5596,  0.3215,  0.1915],
          [ 0.1674,  0.4492,  0.4954,  ...,  0.1553,  0.3823,  0.5215],
          ...,
          [-0.0176,  0.0212,  0.5908,  ...,  0.2961,  0.2915,  0.3188],
          [ 0.4395,  0.3152,  0.4500,  ...,  0.4512,  0.5303,  0.3210],
          [ 0.7056, -0.0278,  0.2241,  ...,  0.5361,  0.4800,  0.6865]],

         [[ 0.4785,  0.0474,  0.4194,  ...,  0.2932,  1.0898,  0.1779],
          [ 0.2505,  0.1827,  0.3176,  ...,  0.4946,  0.7285,  0.3225],
          [ 0.1729,  0.2642,  0.6631,  ...,  0.4031,  0.5581, -0.0737],
          ...,
          [ 0.4351,  0.3789,  0.3694,  ...,  0.6270,  0.2996,  0.6313],
          [ 0.6958,  0.7417,  0.4722,  ...,  0.4172,  0.5938,  0.3782],
          [ 0.4692,  0.2192,  0.6006,  ...,  0.6826,  0.4653,  0.3235]],

         [[ 0.1826,  0.3196,  0.6348,  ...,  0.3022,  0.4597,  0.4385],
          [ 0.1389,  0.3740,  0.6592,  ...,  0.3982,  0.4304,  0.2052],
          [ 0.5181,  0.5879,  0.5312,  ...,  0.3301,  0.1362,  0.5542],
          ...,
          [ 0.3167,  0.2883,  0.7871,  ...,  0.4348,  0.4326,  0.6289],
          [ 0.3245,  0.4399,  0.2656,  ...,  0.3621,  0.4062, -0.1611],
          [ 0.2202,  0.5840,  0.2075,  ...,  0.3879,  0.4158,  0.4119]],

         ...,

         [[ 0.4302,  0.5342,  0.6182,  ...,  0.5103,  0.4888,  0.6260],
          [ 0.7910,  0.4038,  0.3232,  ...,  0.5391,  0.2878,  0.7456],
          [ 0.2961,  0.3445,  0.6025,  ...,  0.1938,  0.5894,  0.6836],
          ...,
          [ 0.6045,  0.6533,  0.6670,  ...,  0.2432,  0.3955,  0.3044],
          [ 0.3135,  0.4280,  0.2971,  ...,  0.2115,  0.1523,  0.5562],
          [ 0.1841,  0.3882,  0.4319,  ...,  0.4932,  0.1145,  0.2666]],

         [[ 0.3091,  0.1377, -0.0171,  ...,  0.5098,  0.3198,  0.5205],
          [ 0.1937,  0.5747,  0.3926,  ...,  0.4771,  0.4497,  0.4302],
          [ 0.5298, -0.0891,  0.9023,  ...,  0.8940,  0.8530,  0.3896],
          ...,
          [ 0.4243,  0.2300,  0.0972,  ...,  0.0986,  0.5942, -0.0571],
          [ 0.2368,  0.5488,  0.4490,  ...,  0.4045,  0.1301,  0.2612],
          [-0.2432,  0.4209,  0.7588,  ...,  0.5049,  0.5820,  0.4995]],

         [[ 0.4810,  0.1111,  0.4097,  ...,  0.5972,  0.5068,  0.0095],
          [ 0.4241,  0.2715, -0.0542,  ...,  0.3826,  0.2798,  0.2439],
          [ 0.0884,  0.4199,  0.4749,  ...,  0.5181,  0.4333,  0.3003],
          ...,
          [-0.0149,  0.3572,  0.3008,  ...,  0.1135,  0.2964,  0.4910],
          [ 0.5146,  0.4907,  0.4224,  ...,  0.7568,  0.4475,  0.1008],
          [ 0.6641,  0.4749,  0.0791,  ...,  0.3308,  0.4338,  0.2135]]],


        [[[ 0.5981,  0.5332,  0.6602,  ...,  0.1769,  0.2869,  0.4761],
          [ 0.2744,  0.4705,  0.3870,  ...,  0.2903,  0.4302,  0.2500],
          [ 0.1196,  0.4539,  0.4246,  ...,  0.4102,  0.3584,  0.2930],
          ...,
          [ 0.3086,  0.6064,  0.5933,  ...,  0.3391,  0.2720,  0.5552],
          [ 0.3857,  0.3577,  0.0425,  ...,  0.1722,  0.6206,  0.3701],
          [ 0.3245,  0.3115,  0.2144,  ...,  0.1116,  0.6162,  0.2062]],

         [[ 0.4163,  0.1943,  0.3660,  ...,  0.3486,  0.6475,  0.5659],
          [ 0.8066,  0.4990,  0.5518,  ...,  0.3350,  0.5811,  0.0474],
          [ 0.0681,  0.7002,  0.3130,  ...,  0.5220,  0.4053,  0.5513],
          ...,
          [ 0.6138,  0.3936,  0.3674,  ...,  0.2527,  0.4622,  0.2986],
          [ 0.1801,  0.2327,  0.4309,  ...,  0.3188,  0.1924,  0.2981],
          [ 0.3950,  0.5615,  0.3721,  ...,  0.4780,  0.3108,  0.4695]],

         [[-0.1104,  0.0640,  0.3328,  ...,  0.4802,  0.4937,  0.5771],
          [ 0.4297,  0.2959,  0.3933,  ...,  0.5195,  0.5732,  0.1091],
          [ 0.2356,  0.2383,  0.4724,  ...,  0.4829,  0.5703,  0.3428],
          ...,
          [ 0.2109,  0.4751,  0.5181,  ...,  0.3569,  0.0588,  0.5840],
          [ 0.1863,  0.4277,  0.6113,  ...,  0.5571,  0.2040,  0.5557],
          [ 0.7749, -0.1938,  0.1968,  ...,  0.5322,  0.0413,  0.3381]],

         ...,

         [[ 0.1514,  0.3977,  0.6123,  ...,  0.7637,  0.4543,  0.6650],
          [ 0.7910,  0.3838,  0.5005,  ...,  0.5469,  0.1677,  0.1685],
          [ 0.4182,  0.3130,  0.6377,  ...,  0.3608,  0.5029,  0.1436],
          ...,
          [ 0.6113,  0.2457,  0.4004,  ...,  0.1431,  0.3979,  0.3396],
          [ 0.3032,  0.0796,  0.1798,  ...,  0.6416,  0.4487,  0.5044],
          [ 0.6167,  0.2101,  0.4521,  ...,  0.3989,  0.5454,  0.1250]],

         [[ 0.2001,  0.3398,  0.3816,  ...,  0.2179,  0.5283,  0.2717],
          [ 0.6875,  0.5698,  0.5820,  ...,  0.4158,  0.4756,  0.4487],
          [ 0.3359,  0.2888, -0.0574,  ...,  0.2588,  0.2983,  0.0054],
          ...,
          [ 0.3789,  0.2422,  0.5454,  ...,  0.5239,  0.3169,  0.5771],
          [ 0.4229,  0.6572,  0.3884,  ...,  0.3535,  0.2800,  0.4446],
          [ 0.4607,  0.6611,  0.3018,  ...,  0.5977,  0.2903,  0.3154]],

         [[ 0.5449,  0.2964,  0.5361,  ...,  0.0378,  0.7246,  0.4670],
          [ 0.3125,  0.5957,  0.7861,  ...,  0.2917,  0.4680,  0.2107],
          [ 0.5591,  0.9150,  0.6211,  ...,  0.2003,  0.6025,  0.4746],
          ...,
          [ 0.1925,  0.5015,  0.3713,  ...,  0.5518,  0.5049,  0.2834],
          [ 0.5312,  0.2642,  0.2175,  ...,  0.6318,  0.5166,  0.0854],
          [ 0.4021,  0.4270,  0.2810,  ...,  0.3320,  0.4341,  0.2150]]]],
       dtype=torch.float16, requires_grad=True)
v input:  tensor([[[[ 4.3359e-01,  3.9160e-01,  5.5127e-01,  ...,  1.9958e-01,
            4.4238e-01,  2.2632e-01],
          [ 4.2578e-01,  4.8145e-01,  1.9482e-01,  ...,  3.3691e-01,
            6.3770e-01,  2.5195e-01],
          [ 6.4648e-01,  6.1230e-01,  6.4062e-01,  ...,  7.1533e-02,
            4.5752e-01,  3.2764e-01],
          ...,
          [ 7.8247e-02,  1.9312e-01,  5.5908e-02,  ...,  3.8818e-01,
            6.1182e-01, -2.4414e-04],
          [ 4.9170e-01, -1.9556e-01,  2.3584e-01,  ...,  7.9297e-01,
            1.9238e-01,  3.8574e-01],
          [ 3.8794e-01,  1.4893e-01,  4.3970e-01,  ...,  3.0835e-01,
            7.5195e-01,  3.1079e-01]],

         [[ 3.2031e-01,  5.2686e-01,  3.8452e-01,  ...,  1.6443e-01,
            4.0332e-01, -5.9326e-02],
          [ 8.7158e-02,  4.9976e-01,  3.7012e-01,  ..., -1.0229e-01,
            2.0935e-01,  5.4834e-01],
          [-4.5654e-02,  4.8999e-01,  2.9272e-01,  ...,  6.2598e-01,
            4.6143e-01,  2.9395e-01],
          ...,
          [ 6.3477e-01,  1.7908e-01,  6.0840e-01,  ..., -7.2754e-02,
            3.0811e-01,  3.8037e-01],
          [ 2.2900e-01, -1.8921e-01,  8.8135e-02,  ...,  1.3818e-01,
            2.6465e-01,  4.1162e-01],
          [-5.6152e-03,  1.7017e-01,  5.4688e-01,  ...,  1.6296e-01,
            6.9824e-02,  5.1074e-01]],

         [[ 2.8247e-01,  5.5176e-01,  1.9165e-01,  ...,  7.7100e-01,
            2.8589e-01,  2.5049e-01],
          [ 1.1328e-01,  3.2227e-01,  9.3018e-02,  ...,  1.8103e-01,
            2.6123e-01,  4.0405e-01],
          [ 2.5806e-01,  4.4287e-01,  1.9653e-01,  ...,  1.0376e-01,
            2.9053e-01,  3.7109e-02],
          ...,
          [ 2.5464e-01,  5.7471e-01, -4.2725e-02,  ...,  3.1909e-01,
            3.1982e-02,  5.1758e-01],
          [ 3.9307e-01,  2.2583e-01,  1.1938e-01,  ...,  1.6565e-01,
            3.1128e-01,  5.0781e-01],
          [ 2.0239e-01,  1.2085e-01,  2.2827e-01,  ...,  4.8999e-01,
           -1.5381e-02,  5.8350e-01]],

         ...,

         [[ 1.0486e-01,  2.5879e-01,  1.6833e-01,  ...,  6.9043e-01,
            5.4810e-02,  2.1924e-01],
          [ 1.9653e-01,  3.3521e-01,  1.4404e-02,  ...,  3.1714e-01,
           -1.2964e-01,  1.9678e-01],
          [-5.2734e-02,  2.4158e-01,  2.4109e-01,  ...,  3.0249e-01,
            6.4404e-01, -4.5654e-02],
          ...,
          [ 2.9761e-01,  3.3643e-01,  6.3574e-01,  ...,  7.6904e-02,
            7.4121e-01,  5.3516e-01],
          [ 4.3994e-01,  3.2837e-01,  4.6069e-01,  ...,  3.5059e-01,
            6.4746e-01,  5.7373e-02],
          [ 2.1838e-01,  3.7354e-02,  2.9980e-01,  ...,  1.1951e-01,
            3.1299e-01,  5.1953e-01]],

         [[ 9.5459e-02,  2.3730e-01,  4.7241e-01,  ...,  4.8682e-01,
            5.1074e-01,  4.1602e-01],
          [ 2.6221e-01, -1.2402e-01,  5.8154e-01,  ...,  4.0723e-01,
            2.4072e-01,  2.9883e-01],
          [ 3.9990e-01,  2.8247e-01,  2.5244e-01,  ...,  3.2959e-01,
            3.0664e-01,  2.1375e-01],
          ...,
          [ 1.5930e-01,  9.2285e-02,  5.5908e-02,  ...,  1.9727e-01,
            4.3408e-01, -4.0527e-02],
          [ 5.1709e-01,  3.2593e-01,  4.4775e-01,  ...,  5.3711e-01,
            6.1401e-02,  3.6353e-01],
          [ 8.1909e-02,  2.8296e-01,  3.4521e-01,  ...,  1.9434e-01,
           -6.4941e-02,  1.5991e-01]],

         [[ 1.1047e-01,  1.4282e-01, -7.4219e-02,  ...,  3.3228e-01,
            5.9229e-01,  5.2148e-01],
          [ 6.1646e-02,  5.3174e-01,  2.3523e-01,  ...,  4.0283e-02,
            4.8535e-01,  5.3516e-01],
          [ 1.9434e-01,  3.6963e-01,  2.3462e-01,  ...,  3.9062e-01,
            4.4800e-01,  2.7295e-01],
          ...,
          [ 3.8916e-01,  2.6538e-01,  4.5581e-01,  ...,  6.0059e-02,
            1.5100e-01,  1.7566e-01],
          [ 5.5176e-01,  2.9248e-01,  3.7451e-01,  ...,  3.7036e-01,
            6.1523e-01,  9.4971e-02],
          [ 1.8298e-01,  4.7534e-01,  8.0566e-03,  ...,  1.5039e-01,
            2.8833e-01,  1.0229e-01]]],


        [[[ 1.4478e-01,  4.4458e-01,  2.7344e-02,  ...,  2.8369e-01,
            5.2588e-01,  4.5142e-01],
          [-1.8066e-02,  4.3555e-01,  3.8721e-01,  ...,  3.3569e-01,
            3.5254e-01,  3.0298e-01],
          [ 6.4331e-02,  5.8008e-01,  1.0181e-01,  ...,  3.3545e-01,
            2.7710e-01,  2.7759e-01],
          ...,
          [ 1.9617e-01,  3.0225e-01,  7.0264e-01,  ...,  3.3691e-01,
            3.4399e-01,  4.8926e-01],
          [-1.0986e-02,  3.9380e-01,  2.1167e-01,  ...,  3.5742e-01,
            2.1289e-01,  2.7393e-01],
          [ 2.6880e-01,  3.1787e-01,  1.8579e-01,  ...,  6.4941e-02,
            1.8750e-01,  4.4873e-01]],

         [[-1.0571e-01,  1.4148e-01,  5.2979e-02,  ..., -2.6855e-03,
            6.7578e-01,  3.9893e-01],
          [ 6.2256e-02,  2.8516e-01,  1.6858e-01,  ...,  5.0342e-01,
           -6.8115e-02,  3.4204e-01],
          [ 3.6743e-01,  4.7021e-01,  2.7466e-01,  ...,  3.7988e-01,
            9.8755e-02,  4.9097e-01],
          ...,
          [ 3.0176e-01,  5.6934e-01,  3.0151e-01,  ...,  4.7363e-02,
            4.4434e-01,  6.6602e-01],
          [ 9.6558e-02,  2.3767e-01,  1.8396e-01,  ...,  2.3303e-01,
            4.6826e-01,  2.0654e-01],
          [ 2.9346e-01,  4.1113e-01,  3.8428e-01,  ...,  4.6558e-01,
            5.0537e-01, -1.0840e-01]],

         [[ 2.5049e-01, -2.6855e-03,  4.2676e-01,  ..., -4.5410e-02,
            1.7627e-01,  6.0449e-01],
          [ 2.7026e-01,  6.3086e-01,  4.5410e-01,  ...,  2.7271e-01,
            5.5176e-01, -2.9053e-02],
          [ 1.4124e-01,  6.8750e-01, -1.0620e-01,  ...,  1.5515e-01,
            2.2192e-01,  3.4180e-01],
          ...,
          [ 1.2366e-01,  4.7119e-01,  1.7310e-01,  ...,  2.9736e-01,
            3.6523e-01,  3.2568e-01],
          [ 4.3115e-01,  5.5322e-01,  1.6296e-01,  ..., -2.6123e-02,
            4.5801e-01,  4.1943e-01],
          [ 7.0801e-03,  2.1082e-01, -5.1270e-02,  ...,  3.6694e-01,
            6.4453e-01,  2.7783e-01]],

         ...,

         [[ 3.9062e-01,  4.9487e-01,  3.2275e-01,  ...,  2.6562e-01,
            1.5942e-01,  2.6855e-01],
          [ 4.0381e-01,  5.1465e-01,  4.0869e-01,  ...,  6.6113e-01,
            2.4487e-01,  3.8672e-01],
          [ 2.3389e-01,  1.6931e-01,  2.5464e-01,  ...,  2.4780e-01,
            7.7637e-02,  9.3018e-02],
          ...,
          [ 3.2935e-01,  3.5571e-01,  6.1914e-01,  ...,  3.8574e-01,
            5.5029e-01,  6.0449e-01],
          [ 2.3633e-01,  5.1660e-01,  2.0581e-01,  ...,  2.7271e-01,
            3.0029e-02,  5.9424e-01],
          [ 4.9438e-01,  5.6250e-01, -8.3740e-02,  ...,  6.1328e-01,
            1.4966e-01,  3.1885e-01]],

         [[-1.5918e-01, -4.0747e-01,  1.4099e-01,  ...,  6.7969e-01,
            1.6467e-01,  2.4731e-01],
          [ 4.4434e-02,  3.8867e-01, -2.1851e-01,  ...,  1.8188e-01,
            4.1406e-01,  3.3887e-01],
          [ 2.3633e-01,  4.6460e-01,  5.9961e-01,  ...,  5.5322e-01,
            5.5469e-01,  1.2207e-02],
          ...,
          [ 5.6299e-01,  4.7607e-02,  5.5225e-01,  ...,  5.3271e-01,
            1.6467e-01,  1.0901e-01],
          [ 2.2729e-01,  1.0559e-01,  3.4375e-01,  ...,  2.9395e-01,
            3.1201e-01,  4.4678e-02],
          [ 2.5098e-01, -7.8857e-02,  1.6614e-01,  ...,  3.9282e-01,
            2.9004e-01,  4.2627e-01]],

         [[ 4.9146e-01, -4.6875e-02,  6.0059e-01,  ...,  3.7817e-01,
            4.9854e-01,  3.3350e-01],
          [ 5.2612e-02,  2.7173e-01, -3.1982e-02,  ...,  3.1201e-01,
            2.3901e-01,  3.1250e-01],
          [ 2.2925e-01,  3.8257e-01,  1.6370e-01,  ...,  3.6279e-01,
            6.8359e-01,  2.5391e-01],
          ...,
          [ 1.8359e-01,  5.5469e-01,  3.2153e-01,  ...,  4.2627e-01,
            5.3516e-01,  5.6396e-02],
          [-3.1421e-01,  3.8257e-01,  4.2578e-01,  ...,  1.0095e-01,
            4.1187e-01,  5.3369e-01],
          [ 2.9541e-01, -1.2573e-01,  3.5083e-01,  ...,  2.9346e-01,
            3.3936e-01,  3.8525e-01]]],


        [[[ 5.4004e-01,  4.0088e-01,  4.9072e-01,  ...,  7.3242e-01,
            1.4954e-01,  9.2651e-02],
          [ 1.8091e-01,  1.9421e-01,  3.1079e-01,  ...,  2.5439e-01,
            8.5693e-02,  1.9312e-01],
          [ 2.7808e-01,  4.7632e-01,  3.7671e-01,  ...,  2.4243e-01,
            5.1855e-01,  5.3174e-01],
          ...,
          [ 4.7119e-01,  4.7852e-01,  8.2227e-01,  ...,  2.5146e-01,
            5.1880e-02,  4.4971e-01],
          [ 2.7490e-01,  3.0908e-01,  2.0386e-01,  ...,  1.4038e-01,
           -1.7285e-01,  5.4297e-01],
          [ 4.4653e-01,  3.7646e-01,  4.3799e-01,  ...,  2.4902e-01,
            4.5361e-01,  4.2480e-01]],

         [[ 8.8989e-02,  3.0615e-01,  3.0029e-01,  ...,  3.4302e-01,
           -3.7842e-02,  2.8564e-02],
          [ 4.4482e-01,  2.9321e-01,  2.0508e-01,  ...,  2.6367e-01,
            3.3887e-01,  3.2788e-01],
          [ 4.0771e-01,  5.0781e-01,  2.2253e-01,  ...,  1.5723e-01,
            4.6924e-01,  7.2656e-01],
          ...,
          [ 6.2891e-01,  1.8994e-01,  4.9805e-01,  ...,  3.3691e-01,
            5.3516e-01,  4.5288e-01],
          [ 1.8018e-01,  2.9858e-01,  3.7769e-01,  ...,  7.0117e-01,
            1.4185e-01, -1.1304e-01],
          [ 2.3889e-01, -7.9834e-02,  2.2583e-01,  ...,  2.1729e-01,
            4.1382e-01,  5.4736e-01]],

         [[ 2.7295e-01,  5.0586e-01,  4.1919e-01,  ...,  3.8428e-01,
            1.0522e-01,  2.3730e-01],
          [ 3.7183e-01,  3.7451e-01,  1.3696e-01,  ...,  6.3477e-01,
            4.1016e-01,  7.7734e-01],
          [ 6.8457e-01,  1.3293e-01, -1.9116e-01,  ...,  2.8857e-01,
            6.0791e-02,  2.5073e-01],
          ...,
          [ 5.2734e-01,  1.0193e-01,  3.2080e-01,  ...,  2.4353e-01,
            2.3535e-01,  2.4683e-01],
          [ 2.3914e-01,  2.3047e-01,  1.2671e-01,  ...,  8.3130e-02,
            2.0508e-02,  4.9951e-01],
          [ 3.3936e-01,  2.6050e-01,  4.2407e-01,  ..., -3.1250e-02,
           -3.8818e-02,  2.7686e-01]],

         ...,

         [[ 3.1104e-01,  5.5957e-01, -3.5400e-02,  ..., -1.0767e-01,
           -3.6865e-02, -2.1509e-01],
          [ 3.5791e-01,  1.4832e-01,  1.1340e-01,  ...,  5.5762e-01,
            2.6807e-01, -6.8115e-02],
          [ 5.5713e-01,  2.7905e-01,  3.6963e-01,  ...,  2.5537e-01,
           -3.2471e-02,  4.4434e-01],
          ...,
          [ 3.5303e-01,  2.8027e-01,  5.0049e-01,  ...,  6.7920e-01,
            5.6152e-01,  4.3506e-01],
          [ 2.9126e-01,  6.8555e-01,  2.6782e-01,  ...,  3.5889e-01,
            4.4556e-01,  5.1123e-01],
          [ 1.2830e-01,  7.8809e-01,  1.6003e-01,  ...,  1.2231e-01,
            4.5801e-01,  4.4385e-01]],

         [[-6.7139e-02, -7.2998e-02,  2.0337e-01,  ...,  2.1265e-01,
            2.5928e-01, -1.6943e-01],
          [ 4.1309e-01,  4.8950e-01,  3.4082e-01,  ...,  3.8452e-01,
           -4.7119e-02,  2.9077e-01],
          [ 3.0029e-01,  3.6328e-01,  4.1235e-01,  ...,  4.3262e-01,
            4.1455e-01,  1.6602e-02],
          ...,
          [ 5.5957e-01,  3.3350e-01,  6.4648e-01,  ...,  8.0322e-02,
            4.6582e-01,  1.3232e-01],
          [ 2.9175e-01,  3.4595e-01,  3.3569e-01,  ...,  3.4424e-01,
            2.9785e-01,  5.2148e-01],
          [ 4.6265e-01,  1.9971e-01,  2.5806e-01,  ...,  2.9663e-01,
            6.1523e-01,  3.2251e-01]],

         [[ 3.3594e-01,  3.6084e-01,  5.5811e-01,  ...,  4.7607e-01,
            3.5376e-01,  3.9453e-01],
          [ 3.4644e-01,  7.3730e-02,  3.9551e-02,  ...,  1.5527e-01,
            3.4961e-01,  2.7051e-01],
          [ 6.4648e-01,  2.7661e-01,  4.8633e-01,  ...,  1.1206e-01,
            1.6321e-01,  3.1421e-01],
          ...,
          [ 3.0200e-01,  3.9087e-01,  7.0801e-03,  ...,  1.0657e-01,
            3.9136e-01,  3.0640e-01],
          [ 3.3984e-01,  6.7773e-01,  3.9990e-01,  ..., -5.6152e-02,
            1.4343e-01,  3.8330e-01],
          [ 2.8052e-01,  2.1948e-01,  4.0674e-01,  ...,  3.5352e-01,
            2.4670e-01,  2.9224e-01]]],


        [[[ 1.1353e-01,  3.5352e-01,  3.0811e-01,  ...,  3.0615e-01,
            5.7129e-01,  3.0884e-01],
          [ 2.0752e-01,  2.1826e-01,  2.3291e-01,  ..., -8.2764e-02,
            2.4353e-01,  9.4604e-02],
          [ 4.2236e-01, -5.3711e-03,  3.7451e-01,  ...,  1.3672e-02,
            3.0933e-01,  3.2690e-01],
          ...,
          [ 2.6807e-01,  5.8936e-01,  5.8008e-01,  ...,  6.3672e-01,
            2.5488e-01,  4.7583e-01],
          [-1.3428e-02,  3.1860e-01,  3.1738e-03,  ...,  2.4646e-01,
            6.5039e-01,  3.6084e-01],
          [ 3.0811e-01,  8.8745e-02,  2.4622e-01,  ...,  3.7720e-01,
            2.1069e-01,  6.7505e-02]],

         [[ 4.8755e-01,  3.7842e-01,  3.4082e-01,  ...,  3.9819e-01,
            2.2449e-01,  1.3843e-01],
          [ 4.7144e-01,  4.9316e-02,  4.9683e-01,  ...,  3.6792e-01,
            9.6924e-02,  2.7734e-01],
          [-1.4160e-01, -8.3496e-02,  4.1602e-01,  ...,  2.5806e-01,
            3.7256e-01,  3.9673e-01],
          ...,
          [ 1.7261e-01,  1.6431e-01,  2.3315e-01,  ...,  4.3311e-01,
            3.1030e-01,  5.4102e-01],
          [-7.8857e-02,  8.3252e-02,  7.2168e-01,  ..., -1.4990e-01,
            4.8779e-01,  7.1436e-01],
          [ 7.2510e-02,  1.0010e-01,  1.7847e-01,  ...,  3.9404e-01,
            3.6548e-01,  3.0737e-01]],

         [[ 5.0439e-01,  6.5039e-01,  4.4385e-01,  ...,  4.5459e-01,
            2.0337e-01,  5.8496e-01],
          [ 2.5098e-01,  1.2231e-01,  4.7998e-01,  ...,  5.7812e-01,
            9.5825e-02,  7.4561e-01],
          [ 3.9893e-01,  5.2979e-01,  4.2334e-01,  ...,  6.8506e-01,
            6.2988e-01,  2.6489e-01],
          ...,
          [ 1.5991e-01,  4.2725e-01,  3.4326e-01,  ...,  6.1133e-01,
            5.0537e-01,  3.3398e-01],
          [ 6.2842e-01,  4.7095e-01,  9.2651e-02,  ...,  3.7231e-01,
            2.4023e-01,  4.3213e-02],
          [-1.6699e-01,  2.7637e-01,  2.5537e-01,  ...,  3.1177e-01,
            3.4351e-01,  3.2251e-01]],

         ...,

         [[ 1.7090e-02,  2.6294e-01,  6.4502e-01,  ..., -2.0996e-02,
            4.4385e-01,  5.3223e-02],
          [ 3.7378e-01,  4.4873e-01,  5.6519e-02,  ...,  8.7036e-02,
            4.6387e-01,  3.1738e-01],
          [ 2.9028e-01,  4.7607e-01,  4.5728e-01,  ...,  3.6084e-01,
            2.6538e-01,  2.2656e-01],
          ...,
          [-2.3193e-02,  2.4084e-01,  5.0586e-01,  ...,  4.6533e-01,
            2.2021e-01,  7.2070e-01],
          [ 3.3789e-01,  4.4653e-01,  8.8574e-01,  ...,  2.6147e-01,
           -1.5332e-01,  4.0088e-01],
          [ 4.2236e-02,  3.6865e-01,  2.4084e-01,  ...,  2.1790e-01,
            1.9177e-01,  4.1821e-01]],

         [[-1.0181e-01,  2.3792e-01,  6.3086e-01,  ...,  3.0957e-01,
            1.1292e-01,  1.3306e-01],
          [ 2.7930e-01,  1.4807e-01, -5.8594e-03,  ...,  1.6235e-01,
            3.9648e-01,  2.9150e-01],
          [ 7.0801e-02,  2.0874e-01,  5.3125e-01,  ...,  4.5996e-01,
            2.1851e-01,  3.0859e-01],
          ...,
          [ 5.3711e-01,  3.8110e-01,  2.3792e-01,  ...,  5.6641e-01,
            5.3320e-01,  2.9883e-01],
          [ 4.5752e-01, -5.3711e-03,  3.8647e-01,  ...,  5.3320e-01,
            4.7119e-02,  5.0342e-01],
          [-1.8311e-02,  4.6826e-01,  3.3618e-01,  ...,  3.6865e-01,
            3.5010e-01,  3.8916e-01]],

         [[ 4.9390e-01,  6.3184e-01,  7.7271e-02,  ..., -5.2246e-02,
            7.6172e-01,  5.6104e-01],
          [ 2.2852e-01,  3.3496e-01,  2.7246e-01,  ...,  1.9849e-01,
            8.3862e-02,  3.7207e-01],
          [ 2.3193e-01,  4.5068e-01,  4.7754e-01,  ...,  2.6416e-01,
           -1.4404e-02,  1.1414e-01],
          ...,
          [ 2.5000e-01, -1.6870e-01,  2.7222e-01,  ...,  7.0068e-02,
            1.0022e-01,  2.4414e-02],
          [ 2.1484e-01,  4.7119e-02,  3.4009e-01,  ...,  7.1875e-01,
            5.9473e-01,  4.2139e-01],
          [ 6.4551e-01,  3.9429e-01,  2.3938e-01,  ...,  3.8672e-01,
            1.7419e-01,  2.9858e-01]]]], dtype=torch.float16,
       requires_grad=True)
dout input:  tensor([[[[ 2.8809e-02,  3.9209e-01,  3.6182e-01,  ...,  7.5439e-02,
            2.1228e-01,  3.3350e-01],
          [ 9.4055e-02,  5.5878e-02,  3.0249e-01,  ...,  3.2886e-01,
            2.4756e-01,  2.3901e-01],
          [ 1.1200e-01,  3.3838e-01,  4.9805e-01,  ..., -2.1545e-01,
            6.3965e-02, -2.0142e-02],
          ...,
          [ 2.1484e-02, -3.8940e-02,  8.4961e-02,  ...,  4.4141e-01,
            5.6213e-02, -9.3994e-02],
          [ 2.3853e-01,  3.0273e-01,  1.4136e-01,  ...,  1.7834e-01,
           -2.5146e-02,  1.0522e-01],
          [ 1.3184e-01,  4.2432e-01,  1.1670e-01,  ...,  1.6138e-01,
            2.7539e-01,  2.9590e-01]],

         [[ 3.9697e-01,  4.2114e-02,  1.0754e-01,  ..., -1.9531e-03,
            7.1106e-02,  2.1814e-01],
          [ 1.8921e-01,  2.4072e-01, -1.6272e-01,  ...,  3.8452e-03,
            6.5918e-02,  4.3750e-01],
          [-2.0227e-01,  3.9160e-01,  3.2471e-02,  ...,  2.5830e-01,
            1.7090e-01,  2.3926e-02],
          ...,
          [ 5.4901e-02,  5.8350e-02,  1.9202e-01,  ...,  3.1348e-01,
            3.3398e-01, -2.1008e-01],
          [-7.0801e-02,  2.1484e-01, -2.2278e-02,  ...,  2.7417e-01,
            1.9299e-01,  3.9734e-02],
          [ 4.4922e-01, -2.5391e-02,  1.9971e-01,  ..., -3.8940e-02,
            3.1055e-01,  1.1499e-01]],

         [[ 3.1494e-01, -1.0876e-01,  2.9004e-01,  ...,  1.2866e-01,
            1.5234e-01, -3.3057e-01],
          [ 4.7803e-01,  5.4443e-02,  2.8027e-01,  ...,  5.7922e-02,
            5.5542e-03,  1.1047e-01],
          [ 1.7566e-01,  5.6519e-02, -5.5786e-02,  ...,  1.0339e-01,
            3.4668e-02,  8.9722e-02],
          ...,
          [ 5.4626e-02,  2.7515e-01, -1.6638e-01,  ...,  5.8289e-02,
            1.1548e-01,  5.5518e-01],
          [ 1.4185e-01,  1.2805e-01, -3.8135e-01,  ..., -3.5986e-01,
            9.1675e-02,  3.1860e-02],
          [-1.2183e-01,  8.9355e-02, -1.1340e-01,  ...,  2.0215e-01,
           -1.2415e-01,  3.6987e-02]],

         ...,

         [[ 3.9160e-01,  5.3711e-01, -2.0862e-01,  ...,  3.2764e-01,
           -2.4695e-01, -2.5391e-02],
          [ 1.3879e-01,  2.4744e-01, -1.2305e-01,  ..., -3.9795e-02,
            3.4729e-02,  2.4841e-01],
          [ 2.1643e-01,  5.1221e-01,  3.1311e-02,  ...,  1.0883e-01,
            2.1680e-01,  1.6370e-01],
          ...,
          [-1.2769e-01,  1.2659e-01,  9.1187e-02,  ...,  1.4612e-01,
            2.8809e-01, -5.9814e-03],
          [ 4.5508e-01, -1.5393e-01,  1.1487e-01,  ...,  1.9189e-01,
            3.6279e-01, -9.1431e-02],
          [ 1.3220e-01,  4.9316e-02, -3.1982e-01,  ...,  2.3779e-01,
           -5.0659e-02,  3.1982e-01]],

         [[ 2.3108e-01, -5.6763e-02, -7.6782e-02,  ...,  1.1877e-01,
            1.9519e-01,  1.7847e-01],
          [ 1.6882e-01,  2.7734e-01, -2.8174e-01,  ..., -1.9958e-01,
           -1.6199e-01, -2.5635e-02],
          [ 8.5449e-04, -3.3936e-02, -2.6123e-01,  ...,  2.4963e-01,
            5.2979e-01,  3.1543e-01],
          ...,
          [ 1.8030e-01,  4.0186e-01, -3.2349e-03,  ...,  2.2559e-01,
           -2.2913e-01,  2.1619e-01],
          [-1.0168e-01, -1.0681e-01,  5.5713e-01,  ..., -7.1899e-02,
           -1.8188e-02, -1.6833e-01],
          [-2.1960e-01,  1.7163e-01,  9.6924e-02,  ...,  5.6885e-02,
            1.2793e-01,  1.9531e-02]],

         [[ 3.1641e-01,  9.4604e-02,  1.9421e-01,  ...,  2.5049e-01,
            4.3115e-01, -7.1899e-02],
          [ 8.4167e-02,  8.6426e-02,  2.0068e-01,  ..., -5.5542e-03,
            3.0566e-01,  6.4258e-01],
          [ 2.9248e-01, -4.5166e-02,  1.6675e-01,  ..., -3.2812e-01,
            2.8760e-01, -2.1362e-02],
          ...,
          [-3.0957e-01,  2.0959e-01,  6.8848e-02,  ..., -9.5459e-02,
           -1.6467e-01, -1.0901e-01],
          [-6.3843e-02,  1.7480e-01,  2.0923e-01,  ...,  3.4485e-02,
            3.2166e-02,  5.7068e-02],
          [ 5.2246e-02,  1.0382e-01,  1.3623e-01,  ...,  1.3306e-01,
            2.8052e-01, -1.0754e-01]]],


        [[[-3.1201e-01,  3.2080e-01,  2.6367e-01,  ...,  2.5464e-01,
           -1.6174e-01,  2.1973e-01],
          [-2.6001e-02,  4.7363e-01, -6.0913e-02,  ...,  1.4136e-01,
            3.8184e-01,  6.1646e-02],
          [ 2.6709e-01,  2.9053e-01,  3.7256e-01,  ..., -1.2573e-02,
            2.1289e-01,  7.6904e-02],
          ...,
          [-9.9121e-02,  2.6807e-01,  5.5725e-02,  ...,  3.7231e-03,
            1.3147e-01,  7.0679e-02],
          [ 1.2146e-02,  1.1926e-01,  1.1633e-01,  ..., -1.8005e-01,
           -3.0566e-01,  9.3445e-02],
          [-2.3010e-01, -3.6621e-04,  4.3506e-01,  ...,  1.7700e-01,
            3.2080e-01,  6.1798e-02]],

         [[ 1.6296e-02,  4.0625e-01, -1.5320e-01,  ...,  4.2334e-01,
            2.9297e-01,  2.1790e-01],
          [ 6.1157e-02, -4.1870e-02,  4.3799e-01,  ...,  3.4668e-01,
           -2.9639e-01,  2.6758e-01],
          [ 2.3486e-01,  6.9214e-02, -6.2134e-02,  ..., -2.4414e-03,
            2.4377e-01,  3.2715e-01],
          ...,
          [ 5.3528e-02,  8.3252e-02,  2.3132e-01,  ...,  1.4429e-01,
           -2.0630e-02,  2.0264e-01],
          [ 3.7207e-01,  4.1211e-01, -2.1545e-01,  ...,  4.1992e-02,
            4.5947e-01, -2.1033e-01],
          [ 3.0176e-01,  1.5625e-01, -1.5613e-01,  ...,  2.9980e-01,
           -1.5613e-01,  1.6235e-01]],

         [[ 6.0352e-01,  1.2976e-01,  5.3369e-01,  ...,  3.1152e-01,
            5.4840e-02, -6.3477e-03],
          [ 6.7505e-02,  1.9287e-02,  7.1472e-02,  ...,  5.1636e-02,
            2.6880e-01, -4.2969e-02],
          [ 3.3936e-02,  2.9883e-01,  3.5449e-01,  ..., -2.3328e-01,
            2.2351e-01,  1.9653e-02],
          ...,
          [ 1.5820e-01, -3.0225e-01, -1.8445e-01,  ..., -4.4922e-02,
           -2.6953e-01,  6.2866e-02],
          [ 8.3984e-02,  5.6824e-02, -2.7295e-01,  ...,  3.1067e-02,
            2.9614e-01, -6.1279e-02],
          [ 2.3645e-01,  2.5488e-01, -1.3782e-01,  ..., -2.4084e-01,
           -7.6294e-03, -1.3147e-01]],

         ...,

         [[ 3.4155e-01,  5.9717e-01,  1.1670e-01,  ..., -3.3203e-02,
            2.0752e-01,  1.1273e-01],
          [ 2.5452e-02,  3.8135e-01,  5.4077e-02,  ...,  3.2959e-01,
            3.1543e-01, -7.8247e-02],
          [-4.2603e-02,  4.9988e-02,  3.3398e-01,  ..., -8.6060e-02,
           -1.5735e-01, -2.4109e-02],
          ...,
          [ 3.7689e-02,  1.4929e-01,  5.9180e-01,  ..., -1.1487e-01,
            9.3994e-03,  2.1057e-01],
          [-1.3452e-01,  1.8005e-01,  1.1005e-01,  ...,  1.4087e-01,
            1.3647e-01,  3.7842e-02],
          [-3.4790e-02,  8.3130e-02,  3.7549e-01,  ..., -2.5586e-01,
           -1.2561e-01, -5.2368e-02]],

         [[ 3.1128e-02,  3.9062e-01,  6.3965e-02,  ...,  3.1250e-01,
           -1.4624e-01,  3.1055e-01],
          [-1.3416e-01,  1.9531e-02,  9.3872e-02,  ...,  2.4573e-01,
            3.7500e-01,  2.1326e-01],
          [ 1.8884e-01,  4.0186e-01,  1.5002e-01,  ...,  2.5098e-01,
            3.4180e-01, -2.8809e-02],
          ...,
          [-7.0923e-02,  2.6807e-01, -2.7686e-01,  ...,  3.2520e-01,
            4.2529e-01,  5.3162e-02],
          [ 1.7114e-01,  1.1078e-01,  3.5693e-01,  ...,  1.7432e-01,
            1.2109e-01,  3.5498e-01],
          [ 2.1313e-01,  1.8298e-01,  5.2979e-02,  ..., -5.7495e-02,
            4.0186e-01,  2.6074e-01]],

         [[ 1.4905e-01,  3.3569e-01,  1.9604e-01,  ...,  3.1396e-01,
            4.4531e-01,  3.9337e-02],
          [ 1.8066e-02,  3.5059e-01,  1.1835e-01,  ...,  4.3848e-01,
            3.7451e-01,  2.9907e-02],
          [ 3.7402e-01,  3.3081e-01,  1.6626e-01,  ..., -3.6621e-04,
            2.3438e-02, -1.6003e-01],
          ...,
          [ 5.8899e-02, -7.2388e-02, -4.3579e-02,  ..., -5.5542e-03,
            1.4087e-01,  2.4414e-01],
          [ 1.3550e-02,  2.0520e-01,  8.1970e-02,  ..., -1.3000e-02,
           -4.2358e-02, -9.8267e-02],
          [-4.9561e-02,  4.6875e-02,  2.7344e-01,  ...,  1.6150e-01,
           -8.0200e-02, -1.0852e-01]]],


        [[[ 2.1436e-01, -2.4768e-01, -4.8096e-02,  ...,  1.4868e-01,
            3.5400e-01,  3.8916e-01],
          [ 7.3853e-02,  1.2524e-01, -1.7126e-01,  ...,  9.5154e-02,
            2.4463e-01,  2.4146e-01],
          [ 1.4502e-01,  2.3767e-01, -2.3718e-01,  ..., -4.3701e-02,
            3.0542e-01, -1.7468e-01],
          ...,
          [-3.1885e-01,  8.8379e-02, -3.6987e-02,  ...,  5.8643e-01,
            3.3496e-01,  3.1885e-01],
          [ 2.9883e-01, -1.2085e-01,  1.7993e-01,  ..., -5.5298e-02,
            4.7363e-01,  3.4180e-03],
          [ 2.7637e-01, -6.5430e-02,  2.0703e-01,  ...,  1.8445e-01,
            2.9736e-01, -6.7383e-02]],

         [[ 2.3645e-01,  3.7598e-02, -4.4922e-02,  ...,  1.2756e-01,
            1.6553e-01,  7.2632e-02],
          [-1.8921e-02,  8.4595e-02, -3.0322e-01,  ...,  1.8799e-01,
            5.3369e-01, -2.7734e-01],
          [ 1.3721e-01, -5.0781e-01,  1.6675e-01,  ...,  3.4131e-01,
            4.8523e-02, -2.7100e-02],
          ...,
          [-6.5552e-02, -1.8298e-01, -9.7656e-03,  ...,  1.0437e-01,
            1.7651e-01,  2.8442e-01],
          [ 3.1738e-02,  7.0801e-02, -2.2034e-01,  ...,  1.8127e-02,
            4.9835e-02,  2.8564e-01],
          [-1.4587e-01,  2.9639e-01,  2.6953e-01,  ...,  5.2277e-02,
            7.7026e-02,  1.6357e-01]],

         [[-5.7983e-02,  1.4673e-01,  3.1128e-03,  ...,  2.1484e-01,
            1.7639e-01, -1.5930e-02],
          [ 1.9617e-01,  1.5857e-01,  2.5122e-01,  ...,  2.1790e-02,
            1.7871e-01, -2.3645e-01],
          [ 1.3098e-01, -1.0864e-02,  4.2334e-01,  ...,  3.0957e-01,
            2.6099e-01,  2.8613e-01],
          ...,
          [-2.3865e-01, -1.3147e-01,  4.3457e-01,  ...,  1.3562e-01,
            4.2578e-01,  3.8867e-01],
          [-1.8311e-04,  2.9346e-01, -3.9551e-01,  ...,  3.1323e-01,
           -2.2583e-03,  1.5198e-01],
          [-1.9409e-02, -6.5552e-02,  2.1802e-01,  ...,  1.2817e-03,
            1.6028e-01, -2.8320e-02]],

         ...,

         [[ 1.0852e-01,  2.1729e-01,  3.3301e-01,  ..., -3.2910e-01,
            7.1411e-02,  2.9761e-01],
          [ 1.8250e-01,  3.1836e-01,  1.3538e-01,  ..., -1.4038e-02,
            1.7004e-01, -3.2764e-01],
          [ 2.4170e-01,  1.3818e-01, -1.9299e-01,  ...,  4.5361e-01,
            4.8859e-02,  1.9897e-01],
          ...,
          [ 2.4561e-01, -1.8909e-01,  5.7031e-01,  ...,  1.9556e-01,
            1.1865e-01, -1.5015e-02],
          [-9.8877e-02,  9.3323e-02, -1.0193e-01,  ...,  4.5752e-01,
           -4.4189e-02,  1.2170e-01],
          [ 2.4695e-01,  2.2644e-02, -1.1584e-01,  ..., -6.3721e-02,
           -5.6763e-03, -1.0559e-02]],

         [[ 5.0659e-03, -3.7891e-01, -7.0190e-03,  ...,  2.6904e-01,
           -5.7617e-02, -2.3132e-01],
          [-1.3684e-01, -2.0569e-01,  7.2754e-02,  ...,  3.9642e-02,
           -6.1035e-02,  1.6357e-01],
          [-5.9204e-02, -1.1047e-02,  1.1414e-02,  ...,  4.2041e-01,
            2.1460e-01, -1.2708e-01],
          ...,
          [ 9.6436e-02,  1.0394e-01,  2.5952e-01,  ...,  2.5342e-01,
           -6.1157e-02,  1.4587e-01],
          [ 2.4036e-01, -5.9448e-02,  2.7930e-01,  ...,  2.2156e-01,
           -8.2153e-02,  5.3711e-03],
          [-2.1179e-02,  4.4189e-01,  2.1460e-01,  ...,  3.8379e-01,
           -8.5571e-02,  1.4355e-01]],

         [[-5.4565e-02, -2.6514e-01,  4.1504e-01,  ...,  4.6533e-01,
            3.8428e-01,  1.3403e-01],
          [-1.6882e-01,  2.0740e-01,  3.0859e-01,  ...,  3.7598e-01,
           -1.3416e-01,  1.2854e-01],
          [ 3.5010e-01, -1.4880e-01,  1.6357e-01,  ...,  1.7236e-01,
            1.1273e-01, -5.3223e-02],
          ...,
          [-2.5146e-01, -4.0161e-02, -9.7778e-02,  ...,  1.1475e-01,
            4.5264e-01,  2.5830e-01],
          [-1.1108e-02,  4.0430e-01,  1.3989e-01,  ..., -1.0559e-02,
            3.2300e-01, -1.2183e-01],
          [ 9.9243e-02,  3.3752e-02,  1.2854e-01,  ..., -2.6221e-01,
           -1.0925e-02, -1.9348e-02]]],


        [[[ 1.8469e-01,  5.2979e-01,  4.3213e-01,  ...,  2.8589e-01,
            2.0056e-01, -3.4912e-02],
          [-1.8396e-01, -6.2256e-02,  7.6965e-02,  ...,  3.2495e-01,
           -1.3513e-01, -4.8828e-03],
          [ 4.2041e-01,  1.2732e-01,  1.1865e-01,  ..., -2.4084e-01,
           -2.6709e-01,  1.9409e-02],
          ...,
          [-3.1128e-03,  1.2732e-01,  4.1943e-01,  ..., -2.0544e-01,
            9.5459e-02,  1.3062e-01],
          [ 2.3730e-01,  7.8735e-02, -1.5149e-01,  ..., -5.7129e-02,
            1.6968e-02, -8.3252e-02],
          [-9.2407e-02,  8.5327e-02,  2.4731e-01,  ..., -1.5222e-01,
            9.8877e-03,  1.6602e-01]],

         [[ 1.7456e-01, -1.2537e-01,  1.1353e-01,  ...,  3.4253e-01,
            5.1807e-01, -2.2473e-01],
          [ 2.2363e-01,  2.0874e-02,  6.0645e-01,  ..., -2.5928e-01,
            2.6294e-01,  1.3757e-01],
          [ 5.0018e-02,  3.1616e-01,  9.3262e-02,  ..., -3.8818e-02,
           -8.5327e-02,  1.5820e-01],
          ...,
          [ 1.8726e-01,  3.2910e-01, -2.8467e-01,  ...,  1.9824e-01,
           -2.7490e-01,  8.8501e-03],
          [ 2.3364e-01,  9.2896e-02,  1.3745e-01,  ..., -5.9814e-03,
            1.0718e-01,  1.7456e-01],
          [-3.2520e-01,  3.7628e-02, -8.9478e-02,  ...,  3.3252e-01,
           -1.0559e-02,  1.5552e-01]],

         [[ 3.0176e-01,  1.1816e-01,  6.1646e-03,  ...,  3.7256e-01,
            3.1311e-02, -3.7231e-03],
          [ 1.3806e-01, -1.9861e-01,  3.1055e-01,  ...,  1.4929e-01,
            1.9019e-01,  2.0068e-01],
          [ 2.3804e-01, -2.3071e-02,  1.5149e-01,  ...,  2.4023e-01,
            3.0420e-01,  1.2524e-01],
          ...,
          [-2.3071e-02,  1.1359e-01,  2.1997e-01,  ...,  2.1484e-01,
            3.4326e-01,  1.4795e-01],
          [-2.8076e-02,  5.4718e-02,  2.1362e-01,  ..., -4.6753e-02,
           -1.3000e-02, -3.5034e-02],
          [ 3.5986e-01,  2.6318e-01,  2.9541e-01,  ...,  2.2241e-01,
            1.1938e-01,  4.0625e-01]],

         ...,

         [[-1.3708e-01,  4.0479e-01,  6.9275e-02,  ...,  2.8076e-01,
            1.1847e-01,  3.2666e-01],
          [ 3.7256e-01, -2.6367e-02, -2.3376e-01,  ...,  5.0079e-02,
            1.8408e-01, -8.8989e-02],
          [-1.7566e-01,  1.6699e-01, -9.2896e-02,  ..., -2.9175e-02,
            4.8676e-02,  1.7334e-01],
          ...,
          [-7.1411e-02,  1.4868e-01,  2.5586e-01,  ...,  1.1560e-01,
            1.7444e-01, -2.8711e-01],
          [ 1.8530e-01,  2.8516e-01, -1.1353e-02,  ...,  2.3743e-01,
           -9.8511e-02,  2.7002e-01],
          [ 2.4841e-01, -2.8271e-01,  6.4819e-02,  ..., -5.8472e-02,
           -5.6763e-02,  1.2720e-01]],

         [[-2.5269e-02,  1.7139e-01,  3.0371e-01,  ...,  1.2109e-01,
           -2.0178e-01,  7.2144e-02],
          [ 5.4541e-01,  3.1787e-01,  3.3057e-01,  ...,  8.4229e-03,
            7.7698e-02,  1.3684e-01],
          [ 1.3306e-01,  1.4368e-01,  1.2256e-01,  ..., -3.2568e-01,
            4.9854e-01,  2.0203e-01],
          ...,
          [ 1.1578e-01,  9.1187e-02,  2.1729e-01,  ...,  4.5013e-02,
            1.6406e-01, -2.0374e-01],
          [ 3.1372e-02,  2.5928e-01,  3.2227e-01,  ...,  6.1890e-02,
            2.0044e-01, -1.7297e-01],
          [-1.5271e-01,  1.0864e-02,  1.6663e-02,  ...,  1.9067e-01,
            2.5488e-01,  1.9458e-01]],

         [[-1.1682e-01,  1.9153e-01,  1.0010e-02,  ...,  5.7465e-02,
           -5.0659e-02, -1.8494e-01],
          [-1.5125e-01,  2.9150e-01, -4.8950e-02,  ...,  1.4954e-01,
            2.0142e-02,  2.8870e-02],
          [-1.8469e-01, -5.5176e-02,  1.3489e-02,  ...,  3.8867e-01,
            4.9438e-03,  9.5947e-02],
          ...,
          [-1.6968e-02,  1.1328e-01, -1.7249e-01,  ..., -1.0681e-01,
            4.4824e-01,  1.3794e-02],
          [ 2.0386e-01, -1.8665e-01,  6.0059e-02,  ..., -1.2378e-01,
            2.2949e-01,  1.0876e-01],
          [ 1.9519e-01,  2.3560e-01,  8.1726e-02,  ...,  3.5303e-01,
           -1.2793e-01,  1.1536e-01]]]], dtype=torch.float16)
tri_out:  tensor([[[[ 0.4336,  0.3916,  0.5513,  ...,  0.1996,  0.4424,  0.2263],
          [ 0.4299,  0.4324,  0.3894,  ...,  0.2620,  0.5312,  0.2379],
          [ 0.5005,  0.4944,  0.4587,  ...,  0.2048,  0.5142,  0.2681],
          ...,
          [ 0.3101,  0.2949,  0.3005,  ...,  0.3015,  0.2981,  0.3066],
          [ 0.3098,  0.2947,  0.3008,  ...,  0.3018,  0.2979,  0.3062],
          [ 0.3103,  0.2947,  0.3003,  ...,  0.3018,  0.2979,  0.3066]],

         [[ 0.3203,  0.5269,  0.3845,  ...,  0.1644,  0.4033, -0.0593],
          [ 0.2057,  0.5137,  0.3774,  ...,  0.0333,  0.3081,  0.2396],
          [ 0.1201,  0.5054,  0.3489,  ...,  0.2317,  0.3586,  0.2605],
          ...,
          [ 0.3000,  0.3025,  0.3010,  ...,  0.3005,  0.3076,  0.3049],
          [ 0.2996,  0.3025,  0.3010,  ...,  0.3005,  0.3069,  0.3049],
          [ 0.2998,  0.3027,  0.3015,  ...,  0.3003,  0.3069,  0.3052]],

         [[ 0.2825,  0.5518,  0.1917,  ...,  0.7710,  0.2859,  0.2505],
          [ 0.1989,  0.4385,  0.1429,  ...,  0.4795,  0.2737,  0.3264],
          [ 0.2156,  0.4353,  0.1592,  ...,  0.3391,  0.2791,  0.2310],
          ...,
          [ 0.2922,  0.3003,  0.2971,  ...,  0.2996,  0.3018,  0.2913],
          [ 0.2927,  0.3000,  0.2969,  ...,  0.2996,  0.3020,  0.2908],
          [ 0.2927,  0.2996,  0.2966,  ...,  0.3000,  0.3018,  0.2915]],

         ...,

         [[ 0.1049,  0.2588,  0.1683,  ...,  0.6904,  0.0548,  0.2192],
          [ 0.1498,  0.2961,  0.0930,  ...,  0.5078, -0.0355,  0.2083],
          [ 0.0715,  0.2747,  0.1509,  ...,  0.4316,  0.2264,  0.1110],
          ...,
          [ 0.2939,  0.3020,  0.2986,  ...,  0.2959,  0.3103,  0.3010],
          [ 0.2947,  0.3027,  0.2983,  ...,  0.2957,  0.3105,  0.3010],
          [ 0.2944,  0.3022,  0.2981,  ...,  0.2952,  0.3108,  0.3013]],

         [[ 0.0955,  0.2373,  0.4724,  ...,  0.4868,  0.5107,  0.4160],
          [ 0.1726,  0.0701,  0.5229,  ...,  0.4500,  0.3857,  0.3618],
          [ 0.2522,  0.1305,  0.4365,  ...,  0.4080,  0.3523,  0.3096],
          ...,
          [ 0.2988,  0.3005,  0.2915,  ...,  0.2922,  0.3040,  0.3018],
          [ 0.2983,  0.3003,  0.2915,  ...,  0.2925,  0.3035,  0.3015],
          [ 0.2983,  0.3003,  0.2915,  ...,  0.2927,  0.3035,  0.3020]],

         [[ 0.1105,  0.1428, -0.0742,  ...,  0.3323,  0.5923,  0.5215],
          [ 0.0867,  0.3323,  0.0765,  ...,  0.1902,  0.5405,  0.5283],
          [ 0.1184,  0.3523,  0.1316,  ...,  0.2448,  0.5098,  0.4507],
          ...,
          [ 0.2971,  0.2986,  0.3093,  ...,  0.2959,  0.2993,  0.3022],
          [ 0.2969,  0.2988,  0.3096,  ...,  0.2957,  0.2991,  0.3025],
          [ 0.2969,  0.2991,  0.3093,  ...,  0.2957,  0.2988,  0.3020]]],


        [[[ 0.1448,  0.4446,  0.0273,  ...,  0.2837,  0.5259,  0.4514],
          [ 0.0692,  0.4404,  0.1945,  ...,  0.3079,  0.4453,  0.3826],
          [ 0.0668,  0.4841,  0.1671,  ...,  0.3167,  0.3916,  0.3489],
          ...,
          [ 0.2966,  0.3003,  0.3013,  ...,  0.3013,  0.3008,  0.3013],
          [ 0.2966,  0.3003,  0.3010,  ...,  0.3022,  0.3010,  0.3013],
          [ 0.2961,  0.3003,  0.3005,  ...,  0.3020,  0.3013,  0.3015]],

         [[-0.1057,  0.1415,  0.0530,  ..., -0.0027,  0.6758,  0.3989],
          [-0.0227,  0.2124,  0.1100,  ...,  0.2473,  0.3081,  0.3708],
          [ 0.1115,  0.3013,  0.1670,  ...,  0.2952,  0.2333,  0.4116],
          ...,
          [ 0.2937,  0.2993,  0.2983,  ...,  0.3040,  0.2986,  0.3037],
          [ 0.2947,  0.2988,  0.2979,  ...,  0.3035,  0.2988,  0.3040],
          [ 0.2942,  0.2996,  0.2979,  ...,  0.3035,  0.2991,  0.3042]],

         [[ 0.2505, -0.0027,  0.4268,  ..., -0.0454,  0.1763,  0.6045],
          [ 0.2607,  0.3235,  0.4409,  ...,  0.1183,  0.3696,  0.2783],
          [ 0.2223,  0.4404,  0.2651,  ...,  0.1302,  0.3223,  0.2986],
          ...,
          [ 0.3022,  0.2939,  0.2976,  ...,  0.3008,  0.3086,  0.2966],
          [ 0.3020,  0.2935,  0.2981,  ...,  0.3005,  0.3086,  0.2966],
          [ 0.3022,  0.2942,  0.2983,  ...,  0.3005,  0.3081,  0.2966]],

         ...,

         [[ 0.3906,  0.4949,  0.3228,  ...,  0.2656,  0.1594,  0.2686],
          [ 0.3975,  0.5054,  0.3682,  ...,  0.4746,  0.2046,  0.3311],
          [ 0.3435,  0.3945,  0.3293,  ...,  0.3936,  0.1615,  0.2507],
          ...,
          [ 0.2966,  0.3076,  0.3054,  ...,  0.3042,  0.3042,  0.3032],
          [ 0.2966,  0.3076,  0.3062,  ...,  0.3047,  0.3047,  0.3032],
          [ 0.2964,  0.3081,  0.3052,  ...,  0.3047,  0.3047,  0.3027]],

         [[-0.1592, -0.4075,  0.1410,  ...,  0.6797,  0.1647,  0.2473],
          [-0.0560, -0.0042, -0.0411,  ...,  0.4275,  0.2910,  0.2937],
          [ 0.0334,  0.1365,  0.1599,  ...,  0.4695,  0.3713,  0.2058],
          ...,
          [ 0.2974,  0.2930,  0.3062,  ...,  0.3042,  0.3105,  0.2979],
          [ 0.2976,  0.2937,  0.3064,  ...,  0.3049,  0.3098,  0.2976],
          [ 0.2976,  0.2927,  0.3069,  ...,  0.3040,  0.3098,  0.2976]],

         [[ 0.4915, -0.0469,  0.6006,  ...,  0.3782,  0.4985,  0.3335],
          [ 0.2462,  0.1312,  0.2471,  ...,  0.3413,  0.3535,  0.3218],
          [ 0.2539,  0.2046,  0.2386,  ...,  0.3503,  0.4705,  0.3000],
          ...,
          [ 0.3110,  0.3032,  0.3062,  ...,  0.2942,  0.3003,  0.3037],
          [ 0.3110,  0.3032,  0.3059,  ...,  0.2942,  0.2996,  0.3037],
          [ 0.3108,  0.3027,  0.3059,  ...,  0.2944,  0.3000,  0.3035]]],


        [[[ 0.5400,  0.4009,  0.4907,  ...,  0.7324,  0.1495,  0.0927],
          [ 0.3848,  0.3115,  0.4131,  ...,  0.5259,  0.1219,  0.1361],
          [ 0.3442,  0.3599,  0.3982,  ...,  0.4270,  0.2466,  0.2634],
          ...,
          [ 0.2998,  0.2961,  0.2983,  ...,  0.2969,  0.2971,  0.2986],
          [ 0.3000,  0.2964,  0.2986,  ...,  0.2966,  0.2971,  0.2976],
          [ 0.3000,  0.2964,  0.2991,  ...,  0.2964,  0.2969,  0.2979]],

         [[ 0.0890,  0.3062,  0.3003,  ...,  0.3430, -0.0378,  0.0286],
          [ 0.2632,  0.2998,  0.2537,  ...,  0.3042,  0.1465,  0.1750],
          [ 0.3206,  0.3699,  0.2410,  ...,  0.2527,  0.2646,  0.3689],
          ...,
          [ 0.2954,  0.3018,  0.2964,  ...,  0.2964,  0.3005,  0.3066],
          [ 0.2954,  0.3015,  0.2957,  ...,  0.2974,  0.2998,  0.3071],
          [ 0.2957,  0.3018,  0.2964,  ...,  0.2974,  0.3003,  0.3069]],

         [[ 0.2729,  0.5059,  0.4192,  ...,  0.3843,  0.1052,  0.2373],
          [ 0.3220,  0.4409,  0.2795,  ...,  0.5083,  0.2561,  0.5049],
          [ 0.4424,  0.3389,  0.1249,  ...,  0.4314,  0.1868,  0.4126],
          ...,
          [ 0.3013,  0.2881,  0.2896,  ...,  0.3035,  0.2937,  0.2976],
          [ 0.3013,  0.2883,  0.2896,  ...,  0.3030,  0.2942,  0.2976],
          [ 0.3005,  0.2878,  0.2891,  ...,  0.3035,  0.2935,  0.2976]],

         ...,

         [[ 0.3110,  0.5596, -0.0354,  ..., -0.1077, -0.0369, -0.2151],
          [ 0.3362,  0.3376,  0.0448,  ...,  0.2510,  0.1276, -0.1359],
          [ 0.4097,  0.3286,  0.1508,  ...,  0.2352,  0.0656,  0.0564],
          ...,
          [ 0.3030,  0.2998,  0.2974,  ...,  0.3074,  0.2959,  0.3013],
          [ 0.3035,  0.2998,  0.2979,  ...,  0.3074,  0.2961,  0.3015],
          [ 0.3032,  0.3010,  0.2979,  ...,  0.3071,  0.2966,  0.3013]],

         [[-0.0671, -0.0730,  0.2034,  ...,  0.2126,  0.2593, -0.1694],
          [ 0.1768,  0.2126,  0.2732,  ...,  0.3000,  0.1038,  0.0642],
          [ 0.2196,  0.2646,  0.3167,  ...,  0.3420,  0.1941,  0.0551],
          ...,
          [ 0.2979,  0.3037,  0.2954,  ...,  0.3008,  0.2942,  0.3020],
          [ 0.2981,  0.3035,  0.2954,  ...,  0.3008,  0.2949,  0.3015],
          [ 0.2976,  0.3035,  0.2949,  ...,  0.3010,  0.2949,  0.3025]],

         [[ 0.3359,  0.3608,  0.5581,  ...,  0.4761,  0.3538,  0.3945],
          [ 0.3411,  0.2177,  0.2996,  ...,  0.3162,  0.3518,  0.3328],
          [ 0.4365,  0.2346,  0.3552,  ...,  0.2510,  0.2930,  0.3264],
          ...,
          [ 0.3062,  0.3086,  0.2964,  ...,  0.3003,  0.3015,  0.2964],
          [ 0.3062,  0.3088,  0.2961,  ...,  0.3010,  0.3025,  0.2964],
          [ 0.3064,  0.3086,  0.2961,  ...,  0.3008,  0.3020,  0.2959]]],


        [[[ 0.1135,  0.3535,  0.3081,  ...,  0.3062,  0.5713,  0.3088],
          [ 0.1664,  0.2773,  0.2659,  ...,  0.0875,  0.3870,  0.1884],
          [ 0.2382,  0.1996,  0.3015,  ...,  0.0832,  0.3787,  0.2393],
          ...,
          [ 0.2986,  0.2974,  0.2974,  ...,  0.3003,  0.2974,  0.2922],
          [ 0.2988,  0.2976,  0.2979,  ...,  0.3010,  0.2976,  0.2922],
          [ 0.2986,  0.2969,  0.2974,  ...,  0.3005,  0.2979,  0.2920]],

         [[ 0.4875,  0.3784,  0.3408,  ...,  0.3982,  0.2245,  0.1384],
          [ 0.4797,  0.2213,  0.4153,  ...,  0.3838,  0.1636,  0.2047],
          [ 0.2625,  0.1051,  0.4202,  ...,  0.3389,  0.2327,  0.2759],
          ...,
          [ 0.3000,  0.2976,  0.3005,  ...,  0.2947,  0.2922,  0.3005],
          [ 0.3003,  0.2974,  0.3010,  ...,  0.2939,  0.2925,  0.3005],
          [ 0.2998,  0.2974,  0.3008,  ...,  0.2937,  0.2920,  0.3010]],

         [[ 0.5044,  0.6504,  0.4438,  ...,  0.4546,  0.2034,  0.5850],
          [ 0.3794,  0.3899,  0.4617,  ...,  0.5156,  0.1504,  0.6641],
          [ 0.3857,  0.4370,  0.4487,  ...,  0.5732,  0.3135,  0.5283],
          ...,
          [ 0.2996,  0.2966,  0.2986,  ...,  0.3013,  0.3005,  0.3030],
          [ 0.3003,  0.2969,  0.2981,  ...,  0.3018,  0.3008,  0.3030],
          [ 0.2996,  0.2971,  0.2981,  ...,  0.3018,  0.3013,  0.3022]],

         ...,

         [[ 0.0171,  0.2629,  0.6450,  ..., -0.0210,  0.4438,  0.0532],
          [ 0.1801,  0.3477,  0.3760,  ...,  0.0284,  0.4529,  0.1738],
          [ 0.2235,  0.3940,  0.3918,  ...,  0.1407,  0.3914,  0.1964],
          ...,
          [ 0.3015,  0.3005,  0.3054,  ...,  0.2991,  0.2971,  0.2952],
          [ 0.3013,  0.3003,  0.3047,  ...,  0.2993,  0.2969,  0.2952],
          [ 0.3018,  0.3010,  0.3047,  ...,  0.2988,  0.2966,  0.2949]],

         [[-0.1018,  0.2379,  0.6309,  ...,  0.3096,  0.1129,  0.1331],
          [ 0.0973,  0.1909,  0.2981,  ...,  0.2327,  0.2610,  0.2158],
          [ 0.0786,  0.1990,  0.3877,  ...,  0.3069,  0.2401,  0.2401],
          ...,
          [ 0.3003,  0.2998,  0.3010,  ...,  0.2915,  0.2991,  0.2976],
          [ 0.3005,  0.2996,  0.3013,  ...,  0.2915,  0.2988,  0.2976],
          [ 0.3003,  0.2998,  0.3010,  ...,  0.2915,  0.2988,  0.2971]],

         [[ 0.4939,  0.6318,  0.0773,  ..., -0.0522,  0.7617,  0.5610],
          [ 0.3591,  0.4810,  0.1763,  ...,  0.0750,  0.4177,  0.4651],
          [ 0.3223,  0.4763,  0.2715,  ...,  0.1324,  0.2883,  0.3535],
          ...,
          [ 0.2979,  0.2964,  0.3020,  ...,  0.2998,  0.2930,  0.3037],
          [ 0.2981,  0.2969,  0.3025,  ...,  0.2998,  0.2937,  0.3037],
          [ 0.2981,  0.2969,  0.3020,  ...,  0.3000,  0.2935,  0.3040]]]],
       device='cuda:0', dtype=torch.float16, grad_fn=<_attentionBackward>)
largest diff:  tensor(0.0005, device='cuda:0', dtype=torch.float16, grad_fn=<MaxBackward1>)
abs top (1, 26, 2029, 60). Ref: 0.0005068778991699219, Triton: 0.0010747909545898438
ref dq:  tensor([[[[ 0.0000e+00,  0.0000e+00,  0.0000e+00,  ...,  0.0000e+00,
            0.0000e+00,  0.0000e+00],
          [ 1.1408e-04, -1.5736e-03, -2.9030e-03,  ..., -2.0676e-03,
            1.9014e-05,  1.4162e-03],
          [ 1.2388e-03,  8.4734e-04,  4.1428e-03,  ...,  1.1425e-03,
           -1.5430e-03,  3.3307e-04],
          ...,
          [-4.4703e-04,  6.0737e-05, -3.9148e-04,  ...,  1.8287e-04,
           -2.4283e-04,  1.2624e-04],
          [ 2.1219e-04,  8.1718e-05, -2.1791e-04,  ...,  1.6403e-04,
            1.3030e-04,  2.9588e-04],
          [-8.6606e-05,  2.5630e-04,  8.1122e-05,  ..., -1.0371e-05,
            4.5443e-04,  4.6611e-04]],

         [[ 0.0000e+00,  0.0000e+00,  0.0000e+00,  ...,  0.0000e+00,
            0.0000e+00,  0.0000e+00],
          [ 3.9625e-04,  3.1948e-03, -1.4334e-03,  ...,  5.5456e-04,
           -2.5425e-03,  1.8644e-03],
          [-4.8518e-04, -2.4776e-03, -9.2077e-04,  ..., -2.9278e-03,
            1.5076e-02,  1.1625e-03],
          ...,
          [-1.0806e-04, -1.8930e-04, -3.3236e-04,  ...,  2.8372e-04,
           -1.4782e-05, -5.5933e-04],
          [ 2.6035e-04,  1.3232e-04, -3.5048e-04,  ...,  2.1732e-04,
            3.8791e-04,  2.1577e-05],
          [-1.7548e-04, -1.9431e-04,  7.6056e-05,  ...,  6.6161e-06,
           -9.2506e-05, -2.2161e-04]],

         [[ 0.0000e+00,  0.0000e+00,  0.0000e+00,  ...,  0.0000e+00,
            0.0000e+00,  0.0000e+00],
          [-1.7433e-03,  5.0163e-03,  3.8223e-03,  ...,  9.0332e-03,
            5.5847e-03, -1.1459e-02],
          [-4.4022e-03, -1.1110e-03, -2.6989e-04,  ..., -4.1084e-03,
            6.2523e-03, -3.9635e-03],
          ...,
          [ 1.2493e-04, -1.4114e-04, -3.5954e-04,  ..., -2.8610e-04,
            2.9254e-04, -3.1590e-06],
          [ 4.6825e-04,  2.5749e-04, -2.0981e-04,  ..., -1.8489e-04,
           -1.0931e-04,  1.4305e-04],
          [ 2.3341e-04,  5.6171e-04, -2.3782e-05,  ..., -1.7834e-04,
           -1.9717e-04, -3.3212e-04]],

         ...,

         [[ 0.0000e+00,  0.0000e+00,  0.0000e+00,  ...,  0.0000e+00,
            0.0000e+00,  0.0000e+00],
          [-1.3475e-03,  8.5144e-03, -2.1271e-02,  ...,  1.2589e-02,
           -5.5885e-04,  4.2801e-03],
          [-2.3994e-03,  8.5678e-03, -1.6632e-02,  ...,  8.8730e-03,
            8.9569e-03,  6.7978e-03],
          ...,
          [ 2.8110e-04, -5.6446e-05,  9.0599e-06,  ...,  2.8777e-04,
            3.5238e-04, -8.2850e-06],
          [ 3.2902e-04,  4.4823e-05, -1.4699e-04,  ..., -2.1458e-06,
            1.9705e-04,  7.7665e-05],
          [ 1.7643e-05,  4.9949e-05,  5.0592e-04,  ...,  2.9087e-04,
           -5.6267e-04, -5.7936e-05]],

         [[ 0.0000e+00,  0.0000e+00,  0.0000e+00,  ...,  0.0000e+00,
            0.0000e+00,  0.0000e+00],
          [ 3.3684e-03, -6.7444e-03, -1.5039e-03,  ...,  2.6011e-04,
            2.1858e-03, -8.1158e-04],
          [-1.1047e-02,  2.1301e-02, -2.7580e-03,  ..., -6.4850e-03,
            5.6171e-04, -2.2352e-05],
          ...,
          [ 3.4034e-05,  1.8442e-04, -4.0770e-04,  ..., -3.3140e-05,
            3.9697e-04, -2.9635e-04],
          [ 1.9503e-04, -3.0708e-04, -3.2425e-04,  ...,  2.2078e-04,
            3.4809e-04,  6.4278e-04],
          [-7.3314e-05, -3.9768e-04, -4.1199e-04,  ...,  2.6274e-04,
            5.3501e-04,  5.2977e-04]],

         [[ 0.0000e+00,  0.0000e+00,  0.0000e+00,  ...,  0.0000e+00,
            0.0000e+00,  0.0000e+00],
          [-7.1144e-04, -2.1327e-04,  1.2696e-04,  ..., -1.1320e-03,
            1.2338e-05,  7.2527e-04],
          [-1.1444e-03, -4.1485e-04,  9.9373e-04,  ..., -4.7722e-03,
            8.8835e-04,  3.4275e-03],
          ...,
          [ 4.5276e-04, -5.5265e-04, -2.4438e-04,  ..., -4.2939e-04,
           -2.4748e-04, -3.1173e-05],
          [ 4.2486e-04, -1.4281e-04, -4.4847e-04,  ..., -3.0112e-04,
            3.1757e-04,  4.4179e-04],
          [ 8.9526e-05, -3.1662e-04,  2.5606e-04,  ..., -2.2602e-04,
            9.8348e-05, -5.0497e-04]]],


        [[[ 0.0000e+00,  0.0000e+00,  0.0000e+00,  ...,  0.0000e+00,
            0.0000e+00,  0.0000e+00],
          [-3.8147e-06, -1.0138e-03, -6.3562e-04,  ..., -2.2659e-03,
           -2.2621e-03,  2.5253e-03],
          [ 1.2417e-03,  8.1539e-04, -1.9379e-03,  ...,  2.4395e-03,
           -2.3365e-03,  2.5558e-03],
          ...,
          [-2.9540e-04, -2.3663e-04,  3.1900e-04,  ...,  2.3866e-04,
            5.8794e-04,  1.0037e-04],
          [ 3.3975e-06,  7.4267e-05,  2.5344e-04,  ...,  6.2037e-04,
           -5.5015e-05,  2.8443e-04],
          [ 1.4460e-04, -2.2876e-04,  3.9434e-04,  ..., -3.6073e-04,
           -4.9305e-04,  6.4731e-05]],

         [[ 0.0000e+00,  0.0000e+00,  0.0000e+00,  ...,  0.0000e+00,
            0.0000e+00,  0.0000e+00],
          [ 2.3849e-02,  6.5613e-03, -1.6998e-02,  ...,  7.5455e-03,
           -7.8201e-04, -3.1372e-02],
          [ 6.6900e-04, -1.9913e-03, -3.0975e-03,  ...,  5.0926e-03,
            3.0937e-03, -2.0409e-03],
          ...,
          [-1.9348e-04, -2.8229e-04, -1.0043e-04,  ..., -2.7919e-04,
            2.6107e-05,  7.6711e-05],
          [ 2.8706e-04, -5.8532e-05, -7.0155e-05,  ...,  4.4656e-04,
            4.4405e-05, -1.7273e-04],
          [ 1.1349e-04,  7.1526e-05, -5.6088e-05,  ..., -9.8109e-05,
            1.8132e-04,  7.4267e-05]],

         [[ 0.0000e+00,  0.0000e+00,  0.0000e+00,  ...,  0.0000e+00,
            0.0000e+00,  0.0000e+00],
          [ 1.4467e-03, -3.4256e-03, -9.1028e-04,  ..., -1.8919e-04,
            4.4403e-03,  1.1641e-04],
          [ 3.1900e-04,  1.4095e-03, -6.2132e-04,  ..., -1.3037e-03,
           -1.8148e-03, -3.2187e-06],
          ...,
          [ 1.4985e-04,  8.7500e-05, -4.2963e-04,  ...,  2.8968e-04,
            7.5042e-05, -2.4939e-04],
          [-3.5691e-04, -2.8396e-04, -3.3617e-04,  ..., -2.0230e-04,
            5.1641e-04, -3.1161e-04],
          [-1.7405e-04, -2.8539e-04, -3.9864e-04,  ..., -2.6298e-04,
           -1.3542e-04, -8.2731e-05]],

         ...,

         [[ 0.0000e+00,  0.0000e+00,  0.0000e+00,  ...,  0.0000e+00,
            0.0000e+00,  0.0000e+00],
          [ 1.7614e-03,  1.2083e-03, -3.6716e-04,  ..., -1.2789e-03,
           -2.0447e-03,  6.5470e-04],
          [-4.1809e-03, -9.5825e-03, -2.2945e-03,  ..., -8.3923e-03,
            4.4975e-03,  2.5368e-03],
          ...,
          [-4.2200e-04,  3.4034e-05,  2.3484e-04,  ...,  5.1975e-04,
            1.3411e-05,  3.8528e-04],
          [-3.0422e-04,  3.9506e-04,  4.2987e-04,  ...,  6.2084e-04,
            2.6965e-04, -3.1412e-05],
          [-2.8038e-04,  3.3975e-04, -5.2452e-04,  ...,  2.4283e-04,
            7.7772e-04,  1.3506e-04]],

         [[ 0.0000e+00,  0.0000e+00,  0.0000e+00,  ...,  0.0000e+00,
            0.0000e+00,  0.0000e+00],
          [-5.5647e-04,  3.0541e-04,  6.9261e-05,  ...,  1.0324e-04,
           -4.3511e-05, -1.7393e-04],
          [ 2.3804e-02, -8.3847e-03, -1.7176e-03,  ..., -2.2793e-03,
            2.6226e-03, -6.5231e-04],
          ...,
          [-1.9884e-04, -4.4966e-04,  5.6148e-05,  ..., -1.3924e-04,
           -2.4343e-04,  2.6059e-04],
          [ 1.1802e-05,  2.5821e-04, -4.3809e-05,  ..., -8.2159e-04,
           -1.6189e-04, -3.5453e-04],
          [ 2.7847e-04, -2.1052e-04,  1.9455e-04,  ..., -4.1366e-05,
            2.8849e-04, -8.6844e-05]],

         [[ 0.0000e+00,  0.0000e+00,  0.0000e+00,  ...,  0.0000e+00,
            0.0000e+00,  0.0000e+00],
          [-5.3825e-03,  1.3037e-03, -9.3536e-03,  ..., -1.6203e-03,
           -4.4289e-03, -3.1624e-03],
          [ 6.1810e-05, -4.4322e-04, -6.9475e-04,  ..., -1.1272e-03,
            2.1629e-03, -8.1873e-04],
          ...,
          [-7.7307e-05, -3.4285e-04,  2.6047e-05,  ..., -2.9469e-04,
            5.3823e-05,  2.4509e-04],
          [ 3.8409e-04, -2.7657e-05,  1.1533e-04,  ..., -1.3947e-04,
           -2.4140e-05, -1.5819e-04],
          [ 2.5344e-04, -2.6989e-04,  2.2721e-04,  ...,  2.4033e-04,
           -3.1471e-05,  1.6010e-04]]],


        [[[ 0.0000e+00,  0.0000e+00,  0.0000e+00,  ...,  0.0000e+00,
            0.0000e+00,  0.0000e+00],
          [ 6.0730e-03,  2.7733e-03,  1.5640e-03,  ..., -2.6379e-03,
            4.6959e-03,  2.9659e-03],
          [ 5.8403e-03,  4.3869e-03,  9.8133e-04,  ..., -1.0040e-02,
            6.6986e-03,  9.1782e-03],
          ...,
          [ 3.2723e-05,  3.4142e-04,  8.4782e-04,  ..., -1.2982e-04,
           -1.8704e-04,  1.4532e-04],
          [ 3.9840e-04,  2.2709e-04, -1.1909e-04,  ..., -1.0663e-04,
            8.1921e-04,  3.6311e-04],
          [ 1.0145e-04,  2.8324e-04,  4.0483e-04,  ..., -1.4424e-05,
            6.5804e-04, -1.2565e-04]],

         [[ 0.0000e+00,  0.0000e+00,  0.0000e+00,  ...,  0.0000e+00,
            0.0000e+00,  0.0000e+00],
          [-1.2579e-03,  7.4673e-04, -5.6171e-04,  ...,  1.1110e-03,
           -1.9932e-03,  7.9775e-04],
          [-6.3477e-03,  3.7060e-03, -3.4752e-03,  ...,  5.8708e-03,
           -9.9792e-03,  4.7722e-03],
          ...,
          [-1.4496e-04, -5.1308e-04,  5.0068e-04,  ...,  4.4990e-04,
            1.2946e-04, -4.7731e-04],
          [ 6.3777e-06, -6.2895e-04,  3.7575e-04,  ...,  8.1241e-05,
            2.7299e-04,  4.5395e-04],
          [ 3.9124e-04, -7.6723e-04,  5.1451e-04,  ...,  7.5579e-05,
           -6.4135e-05,  6.6459e-05]],

         [[ 0.0000e+00,  0.0000e+00,  0.0000e+00,  ...,  0.0000e+00,
            0.0000e+00,  0.0000e+00],
          [ 1.4961e-05, -1.8597e-05, -8.3447e-06,  ..., -3.2783e-05,
            1.0014e-05,  7.9751e-05],
          [-1.5213e-02, -8.8577e-03,  5.1003e-03,  ...,  2.4261e-03,
            1.2024e-02, -1.3336e-02],
          ...,
          [-2.4652e-04,  5.4598e-05, -5.9843e-04,  ...,  7.0930e-06,
           -4.1890e-04,  1.4472e-04],
          [-9.7513e-05,  3.0231e-04,  2.2650e-05,  ..., -4.4274e-04,
           -1.2279e-04, -3.6359e-04],
          [-3.8671e-04, -8.7857e-05, -2.0707e-04,  ...,  8.2612e-05,
            1.8764e-04, -7.8082e-05]],

         ...,

         [[ 0.0000e+00,  0.0000e+00,  0.0000e+00,  ...,  0.0000e+00,
            0.0000e+00,  0.0000e+00],
          [-1.1032e-02,  3.9864e-03,  9.0103e-03,  ..., -8.8072e-04,
            6.1417e-03, -3.6564e-03],
          [ 1.2383e-02,  3.1185e-03, -6.1302e-03,  ...,  1.0735e-02,
           -7.7248e-03,  8.5115e-04],
          ...,
          [-1.6391e-04, -2.9874e-04, -3.9935e-04,  ..., -1.4532e-04,
           -5.1069e-04, -2.3377e-04],
          [-1.8406e-04, -4.9353e-05,  3.2115e-04,  ..., -1.8871e-04,
           -9.0897e-05, -4.4155e-04],
          [-2.8419e-04, -2.3377e-04,  2.1935e-04,  ..., -1.9217e-04,
           -1.3947e-04, -1.4484e-04]],

         [[ 0.0000e+00,  0.0000e+00,  0.0000e+00,  ...,  0.0000e+00,
            0.0000e+00,  0.0000e+00],
          [-2.7885e-03,  1.0559e-02,  9.9030e-03,  ..., -7.9060e-04,
            3.1395e-03, -2.1839e-03],
          [ 1.3832e-02, -2.2232e-02,  3.5187e-02,  ...,  1.9852e-02,
            2.3132e-02, -4.1924e-03],
          ...,
          [ 7.4446e-05,  1.3459e-04,  2.3472e-04,  ..., -2.2924e-04,
            1.9312e-04, -2.9492e-04],
          [-1.1730e-04,  4.8399e-04,  1.1492e-04,  ..., -4.7660e-04,
           -1.6057e-04, -3.2163e-04],
          [ 1.3435e-04,  2.1529e-04,  3.7730e-05,  ..., -2.9230e-04,
           -4.3559e-04,  7.4446e-05]],

         [[ 0.0000e+00,  0.0000e+00,  0.0000e+00,  ...,  0.0000e+00,
            0.0000e+00,  0.0000e+00],
          [-8.4734e-04,  2.3880e-03, -6.9084e-03,  ..., -3.1967e-03,
           -3.3817e-03,  3.4904e-03],
          [-3.0823e-03,  2.4776e-03,  2.9135e-04,  ..., -7.1573e-04,
           -6.7806e-04,  2.3708e-03],
          ...,
          [ 3.2640e-04, -4.1628e-04,  1.2660e-04,  ...,  1.6141e-04,
           -2.2018e-04,  4.4107e-05],
          [-5.0449e-04,  2.3961e-05, -2.5928e-05,  ...,  1.0252e-04,
           -2.8729e-05,  4.4823e-05],
          [-1.5259e-04, -3.4261e-04,  8.9645e-05,  ...,  4.3321e-04,
           -4.8447e-04,  4.3321e-04]]],


        [[[ 0.0000e+00,  0.0000e+00,  0.0000e+00,  ...,  0.0000e+00,
            0.0000e+00,  0.0000e+00],
          [-5.5981e-04, -1.0854e-04, -4.7255e-04,  ...,  1.9622e-04,
            2.4796e-04, -3.9101e-04],
          [-7.1406e-05,  1.2410e-04,  1.6527e-03,  ...,  6.9475e-04,
           -1.3943e-03,  1.4877e-03],
          ...,
          [-1.7440e-04,  6.2823e-05,  4.8304e-04,  ..., -2.1994e-04,
            3.0613e-04, -9.9540e-06],
          [ 1.1206e-05,  1.0717e-04,  1.2767e-04,  ...,  3.8838e-04,
            1.1551e-04, -2.0719e-04],
          [ 2.4235e-04,  5.8460e-04, -1.2934e-04,  ..., -2.1172e-04,
           -1.7333e-04, -9.9123e-05]],

         [[ 0.0000e+00,  0.0000e+00,  0.0000e+00,  ...,  0.0000e+00,
            0.0000e+00,  0.0000e+00],
          [-1.1360e-02, -8.8654e-03, -5.4054e-03,  ...,  3.9792e-04,
            1.9321e-03,  1.5091e-02],
          [-9.1248e-03, -6.7215e-03, -4.2877e-03,  ...,  4.0269e-04,
            1.3962e-03,  1.1879e-02],
          ...,
          [ 4.8399e-04,  2.9325e-04,  4.2534e-04,  ..., -1.4424e-04,
           -1.1772e-04, -2.6846e-04],
          [ 1.9836e-04,  2.9063e-04,  2.8014e-04,  ...,  4.6444e-04,
           -1.0091e-04,  3.8981e-04],
          [ 3.1853e-04,  2.5296e-04,  3.2723e-05,  ..., -3.3188e-04,
           -1.4591e-04,  8.8990e-05]],

         [[ 0.0000e+00,  0.0000e+00,  0.0000e+00,  ...,  0.0000e+00,
            0.0000e+00,  0.0000e+00],
          [-2.3254e-02, -9.9869e-03, -2.6073e-03,  ..., -1.6928e-03,
           -3.4275e-03,  2.0157e-02],
          [-1.3702e-02, -5.1079e-03,  1.5163e-03,  ..., -1.6870e-03,
           -1.2493e-03,  1.3855e-02],
          ...,
          [-2.3353e-04, -1.2302e-04,  2.5129e-04,  ..., -4.8697e-05,
            3.9697e-04,  1.5104e-04],
          [ 4.0245e-04, -5.1451e-04,  1.1128e-04,  ...,  2.7275e-04,
           -8.1587e-04,  1.5712e-04],
          [-1.8525e-04, -1.1760e-04,  4.3344e-04,  ...,  2.0623e-04,
            3.7253e-05, -3.4165e-04]],

         ...,

         [[ 0.0000e+00,  0.0000e+00,  0.0000e+00,  ...,  0.0000e+00,
            0.0000e+00,  0.0000e+00],
          [-9.9182e-03,  2.1577e-04,  1.7338e-03,  ...,  3.3607e-03,
            4.4441e-03,  7.6981e-03],
          [ 1.2848e-02,  6.2525e-05, -2.5539e-03,  ..., -3.0022e-03,
           -6.4812e-03, -8.6136e-03],
          ...,
          [-2.2709e-04,  2.3234e-04, -2.7299e-05,  ..., -5.0843e-05,
            2.3830e-04,  8.7380e-05],
          [-4.9686e-04, -1.5795e-04, -6.8545e-05,  ...,  4.3011e-04,
           -2.3675e-04, -6.2132e-04],
          [-9.3400e-05, -6.1810e-05, -1.8835e-04,  ..., -2.4402e-04,
            4.1080e-04, -2.8181e-04]],

         [[ 0.0000e+00,  0.0000e+00,  0.0000e+00,  ...,  0.0000e+00,
            0.0000e+00,  0.0000e+00],
          [ 6.9847e-03,  3.2959e-03,  2.8725e-03,  ...,  2.8343e-03,
           -7.5579e-04,  2.5368e-03],
          [ 8.9417e-03,  3.3321e-03, -1.2058e-04,  ...,  3.5191e-03,
           -2.6226e-03,  8.2397e-04],
          ...,
          [-4.1127e-04, -9.7454e-05,  3.7718e-04,  ..., -1.5116e-04,
            2.1112e-04, -4.4608e-04],
          [-1.6439e-04,  2.9898e-04,  1.0306e-04,  ..., -2.4700e-04,
            1.5736e-04, -4.2057e-04],
          [ 3.3498e-05,  6.1989e-04, -4.4680e-04,  ...,  1.7786e-04,
           -1.9252e-04, -5.5885e-04]],

         [[ 0.0000e+00,  0.0000e+00,  0.0000e+00,  ...,  0.0000e+00,
            0.0000e+00,  0.0000e+00],
          [ 8.8730e-03, -1.1429e-02, -9.5444e-03,  ..., -9.6970e-03,
            9.7961e-03,  9.7885e-03],
          [ 8.4925e-04,  1.1147e-02,  1.0090e-03,  ...,  2.4910e-03,
           -1.7109e-03,  7.8249e-04],
          ...,
          [ 1.8108e-04, -4.6635e-04, -3.1638e-04,  ...,  9.4354e-05,
            2.2471e-04, -2.8610e-04],
          [ 6.2704e-05, -4.1080e-04,  2.0909e-04,  ...,  2.3091e-04,
           -1.6797e-04, -1.2058e-04],
          [ 1.7118e-04,  1.8775e-04, -6.5708e-04,  ..., -1.9085e-04,
            2.7013e-04,  8.0109e-05]]]], dtype=torch.float16)
triton dq:  tensor([[[[ 0.0000e+00,  0.0000e+00,  0.0000e+00,  ...,  0.0000e+00,
            0.0000e+00,  0.0000e+00],
          [ 1.2708e-04, -1.5583e-03, -2.8763e-03,  ..., -2.0485e-03,
            2.5451e-05,  1.4133e-03],
          [ 1.1854e-03,  8.2493e-04,  4.1237e-03,  ...,  1.1110e-03,
           -1.5879e-03,  3.1567e-04],
          ...,
          [ 1.5688e-03,  1.6861e-03,  1.3361e-03,  ...,  1.4896e-03,
            1.3666e-03,  1.9722e-03],
          [-2.1553e-03, -1.9093e-03, -2.1820e-03,  ..., -1.9283e-03,
           -2.2678e-03, -2.2812e-03],
          [ 2.4402e-04,  5.5504e-04,  5.0735e-04,  ...,  3.8290e-04,
            4.9353e-04,  5.8746e-04]],

         [[ 0.0000e+00,  0.0000e+00,  0.0000e+00,  ...,  0.0000e+00,
            0.0000e+00,  0.0000e+00],
          [ 3.5930e-04,  3.1414e-03, -1.4486e-03,  ...,  5.2071e-04,
           -2.6150e-03,  1.8072e-03],
          [-4.8971e-04, -2.4757e-03, -9.2840e-04,  ..., -2.9316e-03,
            1.5053e-02,  1.1597e-03],
          ...,
          [-3.0880e-03, -3.0556e-03, -3.0460e-03,  ..., -2.7885e-03,
           -2.9068e-03, -3.3283e-03],
          [ 1.1139e-03,  1.2941e-03,  6.6853e-04,  ...,  1.0815e-03,
            1.1988e-03,  1.3952e-03],
          [-3.6964e-03, -3.7632e-03, -3.9177e-03,  ..., -3.6316e-03,
           -3.5152e-03, -3.8662e-03]],

         [[ 0.0000e+00,  0.0000e+00,  0.0000e+00,  ...,  0.0000e+00,
            0.0000e+00,  0.0000e+00],
          [-1.7710e-03,  4.9858e-03,  3.7975e-03,  ...,  9.0027e-03,
            5.5771e-03, -1.1497e-02],
          [-4.4556e-03, -1.1892e-03, -3.3355e-04,  ..., -4.1733e-03,
            6.1989e-03, -4.0474e-03],
          ...,
          [-6.6376e-03, -6.9160e-03, -7.2784e-03,  ..., -6.6643e-03,
           -6.6032e-03, -7.2403e-03],
          [-1.2617e-03, -1.1263e-03, -1.7395e-03,  ..., -1.2608e-03,
           -1.1053e-03, -1.2455e-03],
          [-1.6127e-03, -1.1015e-03, -1.4181e-03,  ..., -1.5478e-03,
           -1.5078e-03, -1.6146e-03]],

         ...,

         [[ 0.0000e+00,  0.0000e+00,  0.0000e+00,  ...,  0.0000e+00,
            0.0000e+00,  0.0000e+00],
          [-1.3752e-03,  8.4839e-03, -2.1286e-02,  ...,  1.2573e-02,
           -6.0606e-04,  4.2496e-03],
          [-2.3594e-03,  8.5831e-03, -1.6571e-02,  ...,  8.8806e-03,
            9.0027e-03,  6.8283e-03],
          ...,
          [-4.7073e-03, -5.0621e-03, -4.8218e-03,  ..., -4.3907e-03,
           -4.9896e-03, -5.0316e-03],
          [-3.2825e-03, -3.4237e-03, -3.3760e-03,  ..., -3.2101e-03,
           -3.5725e-03, -3.4981e-03],
          [-6.5267e-05,  1.7166e-04,  3.0589e-04,  ...,  9.5785e-05,
            7.0572e-05,  2.3818e-04]],

         [[ 0.0000e+00,  0.0000e+00,  0.0000e+00,  ...,  0.0000e+00,
            0.0000e+00,  0.0000e+00],
          [ 3.3703e-03, -6.7024e-03, -1.4811e-03,  ...,  2.6774e-04,
            2.2011e-03, -7.9536e-04],
          [-1.1024e-02,  2.1332e-02, -2.7275e-03,  ..., -6.4697e-03,
            5.8842e-04, -2.1458e-06],
          ...,
          [-7.4081e-03, -7.6752e-03, -7.4844e-03,  ..., -7.4387e-03,
           -7.6637e-03, -7.5607e-03],
          [ 1.9159e-03,  1.7986e-03,  1.3981e-03,  ...,  2.1229e-03,
            2.0332e-03,  1.7166e-03],
          [-1.3638e-04,  1.3316e-04,  6.2585e-05,  ...,  6.7234e-04,
            7.2432e-04,  4.2486e-04]],

         [[ 0.0000e+00,  0.0000e+00,  0.0000e+00,  ...,  0.0000e+00,
            0.0000e+00,  0.0000e+00],
          [-7.5150e-04, -2.6298e-04,  8.5175e-05,  ..., -1.1730e-03,
           -3.2365e-05,  6.8903e-04],
          [-1.1463e-03, -4.0841e-04,  9.9850e-04,  ..., -4.7646e-03,
            8.9216e-04,  3.4313e-03],
          ...,
          [-8.6546e-05, -4.3607e-04, -2.9635e-04,  ..., -5.3549e-04,
           -3.6430e-04, -4.4942e-04],
          [-2.3556e-03, -2.5883e-03, -2.6360e-03,  ..., -2.5024e-03,
           -2.1381e-03, -2.2659e-03],
          [-1.7757e-03, -2.1439e-03, -1.9207e-03,  ..., -1.8225e-03,
           -1.9388e-03, -2.0237e-03]]],


        [[[ 0.0000e+00,  0.0000e+00,  0.0000e+00,  ...,  0.0000e+00,
            0.0000e+00,  0.0000e+00],
          [-1.3113e-05, -1.0233e-03, -6.4659e-04,  ..., -2.2678e-03,
           -2.2640e-03,  2.5063e-03],
          [ 1.2493e-03,  8.2731e-04, -1.9417e-03,  ...,  2.4662e-03,
           -2.3327e-03,  2.5539e-03],
          ...,
          [-6.3362e-03, -6.2141e-03, -6.1989e-03,  ..., -6.0043e-03,
           -5.7716e-03, -6.5422e-03],
          [-4.3297e-03, -4.0665e-03, -3.7842e-03,  ..., -3.6659e-03,
           -3.7785e-03, -3.7079e-03],
          [-3.5000e-03, -3.6392e-03, -3.3474e-03,  ..., -3.5152e-03,
           -3.6449e-03, -3.5973e-03]],

         [[ 0.0000e+00,  0.0000e+00,  0.0000e+00,  ...,  0.0000e+00,
            0.0000e+00,  0.0000e+00],
          [ 2.3865e-02,  6.5727e-03, -1.6968e-02,  ...,  7.5874e-03,
           -7.3051e-04, -3.1311e-02],
          [ 6.5470e-04, -1.9970e-03, -3.1052e-03,  ...,  5.0735e-03,
            3.0708e-03, -2.0618e-03],
          ...,
          [ 3.1338e-03,  3.2940e-03,  3.2177e-03,  ...,  3.2234e-03,
            3.6545e-03,  3.1643e-03],
          [-1.6365e-03, -1.8616e-03, -2.1706e-03,  ..., -1.8768e-03,
           -2.0618e-03, -2.3518e-03],
          [-2.4529e-03, -2.6283e-03, -3.5534e-03,  ..., -2.8095e-03,
           -2.5806e-03, -2.3651e-03]],

         [[ 0.0000e+00,  0.0000e+00,  0.0000e+00,  ...,  0.0000e+00,
            0.0000e+00,  0.0000e+00],
          [ 1.4343e-03, -3.4466e-03, -9.1934e-04,  ..., -1.9741e-04,
            4.4479e-03,  1.0759e-04],
          [ 3.1781e-04,  1.4076e-03, -6.1274e-04,  ..., -1.2903e-03,
           -1.8072e-03, -1.0133e-06],
          ...,
          [ 1.6034e-05, -8.5890e-05, -4.4250e-04,  ...,  9.5963e-05,
           -4.3130e-04, -2.3162e-04],
          [ 1.9741e-03,  1.9217e-03,  1.6842e-03,  ...,  1.8053e-03,
            1.9894e-03,  1.5411e-03],
          [ 4.4441e-04,  3.2163e-04,  9.0420e-05,  ...,  4.7922e-05,
            1.6856e-04,  2.7394e-04]],

         ...,

         [[ 0.0000e+00,  0.0000e+00,  0.0000e+00,  ...,  0.0000e+00,
            0.0000e+00,  0.0000e+00],
          [ 1.7891e-03,  1.2493e-03, -3.2759e-04,  ..., -1.2255e-03,
           -1.9932e-03,  6.6757e-04],
          [-4.2000e-03, -9.5978e-03, -2.3155e-03,  ..., -8.4152e-03,
            4.4708e-03,  2.5253e-03],
          ...,
          [-4.0703e-03, -3.9368e-03, -4.2229e-03,  ..., -4.0092e-03,
           -3.8605e-03, -3.5248e-03],
          [-2.5291e-03, -2.2430e-03, -2.4509e-03,  ..., -2.3594e-03,
           -2.5120e-03, -2.6531e-03],
          [-1.5831e-03, -1.5831e-03, -1.6699e-03,  ..., -1.3027e-03,
           -1.0529e-03, -1.1749e-03]],

         [[ 0.0000e+00,  0.0000e+00,  0.0000e+00,  ...,  0.0000e+00,
            0.0000e+00,  0.0000e+00],
          [-5.2118e-04,  3.2091e-04,  9.4831e-05,  ...,  1.1963e-04,
           -1.4484e-05, -1.2922e-04],
          [ 2.3819e-02, -8.4076e-03, -1.7290e-03,  ..., -2.2926e-03,
            2.6169e-03, -6.4230e-04],
          ...,
          [-1.7309e-03, -1.6451e-03, -1.7042e-03,  ..., -2.0657e-03,
           -1.8129e-03, -1.5087e-03],
          [-2.7370e-04,  2.1493e-04, -3.5691e-04,  ..., -4.3130e-04,
           -2.5249e-04, -2.1696e-04],
          [-1.9445e-03, -1.9588e-03, -1.8625e-03,  ..., -1.9855e-03,
           -1.8320e-03, -1.8072e-03]],

         [[ 0.0000e+00,  0.0000e+00,  0.0000e+00,  ...,  0.0000e+00,
            0.0000e+00,  0.0000e+00],
          [-5.4092e-03,  1.2321e-03, -9.3994e-03,  ..., -1.6441e-03,
           -4.4975e-03, -3.2272e-03],
          [ 4.6253e-05, -4.8256e-04, -7.2289e-04,  ..., -1.1425e-03,
            2.1286e-03, -8.5592e-04],
          ...,
          [ 2.5272e-05, -7.5519e-05, -9.3937e-05,  ..., -3.2759e-04,
            1.1814e-04,  1.6117e-04],
          [-2.3975e-03, -2.5387e-03, -2.3251e-03,  ..., -2.8629e-03,
           -2.9354e-03, -2.6455e-03],
          [ 8.7261e-05,  2.6405e-05,  3.0351e-04,  ...,  2.9087e-04,
            2.1482e-04,  2.5988e-04]]],


        [[[ 0.0000e+00,  0.0000e+00,  0.0000e+00,  ...,  0.0000e+00,
            0.0000e+00,  0.0000e+00],
          [ 6.0730e-03,  2.7695e-03,  1.5574e-03,  ..., -2.6474e-03,
            4.6959e-03,  2.9659e-03],
          [ 5.8556e-03,  4.4098e-03,  1.0071e-03,  ..., -1.0025e-02,
            6.7215e-03,  9.1934e-03],
          ...,
          [-2.5215e-03, -2.3785e-03, -2.0027e-03,  ..., -2.7390e-03,
           -2.5768e-03, -2.3613e-03],
          [ 7.6962e-04,  1.9181e-04,  4.1890e-04,  ...,  3.6383e-04,
            4.7374e-04,  2.6798e-04],
          [ 2.7704e-04,  4.4394e-04,  3.6192e-04,  ...,  1.5056e-04,
            5.6314e-04,  2.4939e-04]],

         [[ 0.0000e+00,  0.0000e+00,  0.0000e+00,  ...,  0.0000e+00,
            0.0000e+00,  0.0000e+00],
          [-1.2598e-03,  7.4434e-04, -5.6505e-04,  ...,  1.1044e-03,
           -2.0008e-03,  7.9346e-04],
          [-6.3744e-03,  3.6888e-03, -3.5229e-03,  ...,  5.8289e-03,
           -1.0056e-02,  4.7607e-03],
          ...,
          [ 2.8086e-04,  3.0208e-04,  8.2731e-04,  ...,  4.9353e-04,
            4.2915e-04,  8.8573e-05],
          [-4.3221e-03, -4.7722e-03, -4.4708e-03,  ..., -4.0855e-03,
           -4.1084e-03, -4.1084e-03],
          [ 1.4770e-04, -4.4703e-06,  3.8695e-04,  ...,  3.5644e-04,
           -5.2214e-05,  2.9826e-04]],

         [[ 0.0000e+00,  0.0000e+00,  0.0000e+00,  ...,  0.0000e+00,
            0.0000e+00,  0.0000e+00],
          [ 1.1504e-05, -2.8968e-05, -2.6107e-05,  ..., -4.4048e-05,
           -1.3113e-06,  7.5817e-05],
          [-1.5205e-02, -8.8425e-03,  5.1231e-03,  ...,  2.4395e-03,
            1.2039e-02, -1.3321e-02],
          ...,
          [ 9.9540e-06,  3.5763e-04,  3.2306e-05,  ...,  3.1996e-04,
            5.5134e-05,  6.2132e-04],
          [-3.3164e-04, -2.3675e-04, -9.1910e-05,  ..., -5.4312e-04,
           -2.6441e-04, -3.8099e-04],
          [ 1.6012e-03,  1.7443e-03,  1.6546e-03,  ...,  1.6575e-03,
            1.5345e-03,  1.8721e-03]],

         ...,

         [[ 0.0000e+00,  0.0000e+00,  0.0000e+00,  ...,  0.0000e+00,
            0.0000e+00,  0.0000e+00],
          [-1.0963e-02,  4.0321e-03,  9.0637e-03,  ..., -8.2445e-04,
            6.1798e-03, -3.5820e-03],
          [ 1.2436e-02,  3.1528e-03, -6.0921e-03,  ...,  1.0773e-02,
           -7.6904e-03,  9.1124e-04],
          ...,
          [-2.5578e-03, -2.7771e-03, -2.7618e-03,  ..., -2.3689e-03,
           -2.7294e-03, -2.7714e-03],
          [-2.0599e-03, -1.8244e-03, -1.7405e-03,  ..., -1.7271e-03,
           -2.0180e-03, -1.8158e-03],
          [-4.8714e-03, -4.7264e-03, -4.8447e-03,  ..., -5.2261e-03,
           -4.5128e-03, -5.2109e-03]],

         [[ 0.0000e+00,  0.0000e+00,  0.0000e+00,  ...,  0.0000e+00,
            0.0000e+00,  0.0000e+00],
          [-2.7981e-03,  1.0521e-02,  9.8724e-03,  ..., -8.1921e-04,
            3.1090e-03, -2.2087e-03],
          [ 1.3863e-02, -2.2186e-02,  3.5217e-02,  ...,  1.9913e-02,
            2.3178e-02, -4.1351e-03],
          ...,
          [-3.2692e-03, -3.2501e-03, -3.4695e-03,  ..., -3.9406e-03,
           -3.5992e-03, -3.6602e-03],
          [-3.1300e-03, -2.9182e-03, -3.2291e-03,  ..., -3.1834e-03,
           -3.3436e-03, -3.2558e-03],
          [ 7.7343e-04,  6.4659e-04,  4.9639e-04,  ...,  4.7398e-04,
            5.6458e-04,  6.6328e-04]],

         [[ 0.0000e+00,  0.0000e+00,  0.0000e+00,  ...,  0.0000e+00,
            0.0000e+00,  0.0000e+00],
          [-8.7833e-04,  2.3766e-03, -6.9237e-03,  ..., -3.2310e-03,
           -3.4084e-03,  3.4828e-03],
          [-3.1147e-03,  2.4490e-03,  2.6274e-04,  ..., -7.6675e-04,
           -7.1907e-04,  2.3518e-03],
          ...,
          [ 7.2594e-03,  6.4392e-03,  6.9122e-03,  ...,  6.4049e-03,
            6.3210e-03,  6.7177e-03],
          [-7.3242e-04, -5.2595e-04, -4.6802e-04,  ..., -5.8985e-04,
           -3.4142e-04, -4.7755e-04],
          [ 2.7370e-03,  2.3079e-03,  3.0708e-03,  ...,  2.8820e-03,
            2.7943e-03,  3.0289e-03]]],


        [[[ 0.0000e+00,  0.0000e+00,  0.0000e+00,  ...,  0.0000e+00,
            0.0000e+00,  0.0000e+00],
          [-5.3453e-04, -8.1718e-05, -4.4298e-04,  ...,  2.0754e-04,
            2.6560e-04, -3.7026e-04],
          [-7.7128e-05,  1.1992e-04,  1.6479e-03,  ...,  6.9427e-04,
           -1.3971e-03,  1.4849e-03],
          ...,
          [-2.5501e-03, -2.7504e-03, -2.2106e-03,  ..., -2.8362e-03,
           -2.5043e-03, -2.3060e-03],
          [-9.9182e-04, -7.4244e-04, -1.0204e-03,  ..., -7.7248e-04,
           -6.7997e-04, -9.4604e-04],
          [ 9.8896e-04,  1.0500e-03,  8.1825e-04,  ...,  9.9087e-04,
            6.9761e-04,  7.3099e-04]],

         [[ 0.0000e+00,  0.0000e+00,  0.0000e+00,  ...,  0.0000e+00,
            0.0000e+00,  0.0000e+00],
          [-1.1345e-02, -8.8501e-03, -5.3978e-03,  ...,  3.9721e-04,
            1.9293e-03,  1.5068e-02],
          [-9.1476e-03, -6.7406e-03, -4.2992e-03,  ...,  3.9840e-04,
            1.3952e-03,  1.1894e-02],
          ...,
          [ 2.0194e-04,  2.0266e-04,  2.5511e-05,  ..., -1.7488e-04,
            1.0967e-04, -2.2972e-04],
          [-4.1656e-03, -4.3983e-03, -4.4060e-03,  ..., -4.1466e-03,
           -4.4518e-03, -4.1199e-03],
          [-1.4849e-03, -1.9093e-03, -1.7786e-03,  ..., -1.7490e-03,
           -1.7891e-03, -1.5936e-03]],

         [[ 0.0000e+00,  0.0000e+00,  0.0000e+00,  ...,  0.0000e+00,
            0.0000e+00,  0.0000e+00],
          [-2.3270e-02, -9.9945e-03, -2.6093e-03,  ..., -1.6937e-03,
           -3.4294e-03,  2.0172e-02],
          [-1.3718e-02, -5.1079e-03,  1.5249e-03,  ..., -1.6689e-03,
           -1.2321e-03,  1.3878e-02],
          ...,
          [ 4.6272e-03,  4.6425e-03,  5.0125e-03,  ...,  5.0468e-03,
            4.6272e-03,  4.7188e-03],
          [ 1.4715e-03,  1.2360e-03,  1.1854e-03,  ...,  1.0900e-03,
            9.0456e-04,  1.2989e-03],
          [ 3.0041e-05,  3.2592e-04,  2.3830e-04,  ...,  1.9753e-04,
            1.1659e-04,  9.7096e-05]],

         ...,

         [[ 0.0000e+00,  0.0000e+00,  0.0000e+00,  ...,  0.0000e+00,
            0.0000e+00,  0.0000e+00],
          [-9.8724e-03,  2.5773e-04,  1.7948e-03,  ...,  3.4351e-03,
            4.4823e-03,  7.7515e-03],
          [ 1.2840e-02,  4.7982e-05, -2.5768e-03,  ..., -3.0289e-03,
           -6.4964e-03, -8.6365e-03],
          ...,
          [ 2.1439e-03,  2.3232e-03,  2.1038e-03,  ...,  2.1725e-03,
            2.2221e-03,  2.2221e-03],
          [-4.5013e-04, -5.7364e-04, -1.8597e-04,  ..., -1.3578e-04,
           -1.6999e-04, -5.8126e-04],
          [-9.8133e-04, -9.9659e-04, -8.1158e-04,  ..., -1.0471e-03,
           -8.4496e-04, -8.1873e-04]],

         [[ 0.0000e+00,  0.0000e+00,  0.0000e+00,  ...,  0.0000e+00,
            0.0000e+00,  0.0000e+00],
          [ 7.0152e-03,  3.3264e-03,  2.9049e-03,  ...,  2.8572e-03,
           -7.2145e-04,  2.5616e-03],
          [ 8.9188e-03,  3.3073e-03, -1.4651e-04,  ...,  3.5000e-03,
           -2.6550e-03,  8.0442e-04],
          ...,
          [-5.3482e-03, -5.6381e-03, -5.3635e-03,  ..., -5.6152e-03,
           -5.5122e-03, -5.5618e-03],
          [-4.5013e-03, -4.1618e-03, -4.3678e-03,  ..., -4.6082e-03,
           -4.1962e-03, -4.8981e-03],
          [-3.2692e-03, -2.5082e-03, -3.4027e-03,  ..., -3.3779e-03,
           -3.3283e-03, -3.5133e-03]],

         [[ 0.0000e+00,  0.0000e+00,  0.0000e+00,  ...,  0.0000e+00,
            0.0000e+00,  0.0000e+00],
          [ 8.9340e-03, -1.1353e-02, -9.4376e-03,  ..., -9.6664e-03,
            9.8801e-03,  9.8343e-03],
          [ 8.9884e-04,  1.1192e-02,  1.0700e-03,  ...,  2.5043e-03,
           -1.6451e-03,  8.2350e-04],
          ...,
          [-7.0763e-04, -8.8072e-04, -8.9121e-04,  ..., -6.6185e-04,
           -8.4114e-04, -1.0138e-03],
          [-2.0885e-03, -2.1324e-03, -1.9236e-03,  ..., -1.9951e-03,
           -2.1133e-03, -2.1496e-03],
          [-5.1498e-03, -5.0201e-03, -5.3558e-03,  ..., -5.1270e-03,
           -4.6997e-03, -5.0812e-03]]]], dtype=torch.float16)
F

=================================== FAILURES ===================================
____________________________ test_op[4-48-2048-64] _____________________________

Z = 4, H = 48, N_CTX = 2048, D_HEAD = 64, dtype = torch.float16

    @pytest.mark.parametrize('Z, H, N_CTX, D_HEAD', [
        (4, 48, 128, 64),
        (4, 48, 256, 64),
        (4, 48, 512, 64),
        (4, 48, 1024, 64),
        (4, 48, 2048, 64),
        (4, 48, 4096, 64),
        #  (4, 48, 8192, 64), out of memory
    ])
    @pytest.mark.skipif(torch.cuda.get_device_capability()[0] < 9, reason="requires arch 9+")
    def test_op(Z, H, N_CTX, D_HEAD, dtype=torch.float16):
        g = torch.Generator(device="cpu")
        g.manual_seed(20)
        device = "cuda"
        q = torch.empty((Z, H, N_CTX, D_HEAD), dtype=dtype, device="cpu").normal_(mean=0.1, std=0.2,
                                                                                  generator=g).requires_grad_()
        k = torch.empty((Z, H, N_CTX, D_HEAD), dtype=dtype, device="cpu").normal_(mean=0.4, std=0.2,
                                                                                  generator=g).requires_grad_()
        v = torch.empty((Z, H, N_CTX, D_HEAD), dtype=dtype, device="cpu").normal_(mean=0.3, std=0.2,
                                                                                  generator=g).requires_grad_()
        sm_scale = 0.2
        dout = torch.empty((Z, H, N_CTX, D_HEAD), dtype=dtype, device="cpu").normal_(mean=0.1, std=0.2, generator=g)
        print("q input: ", q)
        print("k input: ", k)
        print("v input: ", v)
        print("dout input: ", dout)
        # reference implementation
        M = torch.tril(torch.ones((N_CTX, N_CTX), device="cpu"))
        p = torch.matmul(q, k.transpose(2, 3)) * sm_scale
        for z in range(Z):
            for h in range(H):
                p[:, :, M == 0] = float("-inf")
        p = torch.softmax(p.float(), dim=-1).half()
        # p = torch.exp(p)
        ref_out = torch.matmul(p, v)
        ref_out.backward(dout)
        ref_dv, v.grad = v.grad.clone(), None
        ref_dk, k.grad = k.grad.clone(), None
        ref_dq, q.grad = q.grad.clone(), None
        # triton implementation
        tri_out = attention(q.to(device), k.to(device), v.to(device), sm_scale)
        # print(ref_out)
        # print(tri_out)
        tri_out.backward(dout.to(device))
        tri_dv, v.grad = v.grad.clone(), None
        tri_dk, k.grad = k.grad.clone(), None
        tri_dq, q.grad = q.grad.clone(), None
        # compare
        torch.testing.assert_close(ref_out.to(device), tri_out, atol=1e-2, rtol=0)
        print("tri_out: ", tri_out)
        print("largest diff: ", torch.max(torch.abs(ref_out.to(device) - tri_out)))
        print(f"abs top (1, 26, 2029, 60). Ref: {ref_dq[1, 26, 2029, 60]}, Triton: {tri_dq[1, 26, 2029, 60]}")
        print("ref dq: ", ref_dq)
        print("triton dq: ", tri_dq)
>       torch.testing.assert_close(ref_dq, tri_dq.to("cpu"), atol=1e-2, rtol=0)
E       AssertionError: Tensor-likes are not close!
E
E       Mismatched elements: 11884 / 25165824 (0.0%)
E       Greatest absolute difference: 0.015716552734375 at index (3, 47, 1962, 45) (up to 0.01 allowed)
E       Greatest relative difference: 1.16015625 at index (0, 3, 1379, 58) (up to 0 allowed)

python/test/unit/hopper/test_flashattention.py:415: AssertionError
=========================== short test summary info ============================
FAILED python/test/unit/hopper/test_flashattention.py::test_op[4-48-2048-64] - AssertionError: Tensor-likes are not close!

Mismatched elements: 11884 / 25165824 (0.0%)
Greatest absolute difference: 0.015716552734375 at index (3, 47, 1962, 45) (up to 0.01 allowed)
Greatest relative difference: 1.16015625 at index (0, 3, 1379, 58) (up to 0 allowed)
======================== 1 failed in 793.20s (0:13:13) =========================
