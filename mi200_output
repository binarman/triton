============================= test session starts ==============================
platform linux -- Python 3.9.19, pytest-7.3.2, pluggy-1.4.0
rootdir: /triton/python
plugins: shard-0.1.2, flakefinder-1.1.0, cpp-2.3.0, xdist-3.3.1, hypothesis-5.35.1, xdoctest-1.1.0, rerunfailures-14.0
collected 1 item
Running 1 items in this shard

python/test/unit/hopper/test_flashattention.py q input:  tensor([[[[ 3.5400e-01,  2.0935e-01,  1.2292e-01,  ...,  1.2494e-01,
            6.1768e-02,  2.9053e-01],
          [ 2.7100e-01,  2.5488e-01,  1.6040e-01,  ...,  4.6387e-01,
            4.9072e-01,  1.8787e-01],
          [-1.4197e-01, -3.2568e-01,  2.5049e-01,  ..., -2.1790e-01,
           -2.5879e-02,  6.3110e-02],
          ...,
          [ 2.7588e-01,  2.8516e-01, -9.9121e-02,  ...,  1.7212e-01,
            1.5015e-02,  2.3816e-01],
          [ 1.2610e-01,  1.3757e-01,  1.9763e-01,  ...,  2.7881e-01,
            2.1240e-01,  1.1639e-01],
          [ 6.9885e-02,  9.4666e-02, -3.2129e-01,  ...,  1.9995e-01,
            1.1743e-01, -1.3574e-01]],

         [[ 3.2776e-02, -9.9243e-02,  1.2067e-01,  ...,  1.1395e-01,
           -1.1902e-02,  1.6980e-01],
          [-2.3401e-01,  1.2170e-01, -1.5320e-01,  ..., -3.8965e-01,
            3.5400e-02, -3.0396e-02],
          [ 1.1963e-02,  1.0724e-01,  3.4424e-01,  ..., -3.0713e-01,
           -4.3091e-02,  2.7588e-02],
          ...,
          [ 1.8054e-01,  4.4287e-01, -1.7932e-01,  ..., -5.6519e-02,
            1.9434e-01,  5.2490e-03],
          [ 9.7839e-02, -2.5293e-01,  1.2500e-01,  ...,  2.9102e-01,
            1.4905e-01,  3.4570e-01],
          [ 2.9370e-01, -2.1667e-01,  5.6641e-02,  ...,  1.2976e-01,
            4.1357e-01,  1.5369e-01]],

         [[ 2.4048e-02,  1.6602e-01, -2.7148e-01,  ...,  3.2178e-01,
            1.7493e-01,  1.8054e-01],
          [ 2.1460e-01,  1.1627e-01,  7.4341e-02,  ...,  2.4353e-02,
            1.1194e-01,  2.5146e-01],
          [ 1.7798e-01, -8.2520e-02,  1.1169e-02,  ..., -2.6318e-01,
            1.1829e-01,  5.5634e-02],
          ...,
          [ 8.8745e-02, -8.4106e-02,  4.9652e-02,  ..., -2.0056e-01,
            1.0052e-01,  9.3506e-02],
          [ 3.1128e-02,  3.1799e-02,  1.9263e-01,  ...,  3.3301e-01,
            1.8701e-01,  1.6284e-01],
          [-1.2793e-01,  5.7251e-02,  2.1936e-01,  ..., -1.5625e-02,
            1.6309e-01, -3.1616e-02]],

         ...,

         [[-1.9104e-01,  2.3682e-01,  7.8186e-02,  ..., -2.0447e-01,
            1.9385e-01, -1.2476e-01],
          [ 2.9297e-02,  4.5776e-02,  1.0260e-01,  ..., -1.5027e-01,
            1.3489e-01,  2.9688e-01],
          [ 4.8370e-02, -1.3611e-01,  1.3428e-01,  ...,  1.2524e-01,
            1.1292e-01, -2.0593e-01],
          ...,
          [ 1.3293e-01,  1.7114e-01, -8.3374e-02,  ..., -3.1982e-02,
            3.5303e-01,  8.4106e-02],
          [ 8.6121e-02,  1.4368e-01,  1.8787e-01,  ..., -7.2144e-02,
           -9.3140e-02,  2.1143e-01],
          [-2.5513e-02, -6.6895e-02,  1.0864e-01,  ...,  1.8933e-01,
           -3.3447e-02,  8.3008e-02]],

         [[ 1.7810e-01, -5.5664e-02,  2.5977e-01,  ...,  6.7139e-02,
            8.6121e-02,  4.4678e-01],
          [ 1.3489e-01,  2.8662e-01,  4.5044e-02,  ...,  9.5886e-02,
            1.2439e-01,  3.4729e-02],
          [-3.0615e-01,  2.4146e-01,  7.2388e-02,  ...,  6.5308e-02,
            1.2805e-01,  3.9185e-02],
          ...,
          [-2.9150e-01, -6.3477e-02,  7.1472e-02,  ...,  3.1445e-01,
            6.3477e-01,  3.5596e-01],
          [ 4.2969e-01,  1.3586e-01,  1.2537e-01,  ...,  2.5049e-01,
           -3.9917e-02, -5.9375e-01],
          [ 9.7412e-02,  5.9229e-01,  1.8164e-01,  ..., -3.7793e-01,
            1.6553e-01, -4.9194e-02]],

         [[-1.2402e-01,  2.3633e-01, -8.5205e-02,  ..., -3.1738e-01,
           -9.9365e-02,  2.7881e-01],
          [ 1.3965e-01,  5.0537e-02, -7.0190e-02,  ...,  1.6797e-01,
            3.2715e-01,  2.9102e-01],
          [-3.1689e-01,  1.6724e-01,  1.3794e-01,  ...,  1.9775e-01,
           -1.6711e-01,  7.8125e-02],
          ...,
          [-4.1748e-02,  3.3740e-01,  4.4727e-01,  ..., -8.3618e-02,
            2.0544e-01,  3.1799e-02],
          [-2.5391e-01,  1.5161e-01,  3.5400e-03,  ...,  1.0974e-01,
            1.9141e-01, -1.8787e-01],
          [ 3.4961e-01, -2.8125e-01,  1.6931e-01,  ...,  1.7297e-01,
            4.2529e-01,  2.8540e-01]]],


        [[[-1.2878e-02,  1.4294e-01,  1.2866e-01,  ...,  4.1357e-01,
            4.2725e-01, -9.1553e-03],
          [-4.9561e-01, -2.5146e-02,  1.5552e-01,  ...,  1.7859e-01,
           -4.6143e-02,  6.6956e-02],
          [-1.2207e-01,  4.6753e-02,  3.6914e-01,  ..., -8.7402e-02,
            2.3633e-01,  1.0986e-03],
          ...,
          [ 4.7394e-02,  4.8828e-04, -2.3425e-01,  ..., -1.0803e-01,
            1.8762e-01,  3.4717e-01],
          [ 3.4424e-01,  3.8477e-01,  2.0190e-01,  ..., -7.5195e-02,
            4.9072e-01, -2.2961e-01],
          [-2.0569e-01,  5.4932e-01,  1.9775e-02,  ..., -3.5522e-02,
            2.4805e-01,  1.1646e-01]],

         [[ 3.5449e-01, -1.3794e-02,  6.0028e-02,  ...,  4.6661e-02,
            2.7100e-01, -1.8567e-01],
          [ 2.5146e-01, -1.4453e-01,  9.1553e-03,  ...,  4.2511e-02,
            1.9849e-01,  6.2500e-01],
          [ 3.2080e-01,  3.9258e-01, -1.1597e-02,  ..., -4.4312e-02,
           -3.0762e-02, -1.7908e-01],
          ...,
          [ 3.2666e-01,  1.7578e-01,  1.1609e-01,  ..., -9.2529e-02,
           -1.3000e-01, -1.3489e-01],
          [ 2.2754e-01, -4.0649e-02, -1.7212e-02,  ...,  2.8296e-01,
            1.2781e-01, -7.3730e-02],
          [ 9.9976e-02, -2.4768e-01, -1.6235e-02,  ...,  3.8330e-01,
            1.7627e-01, -1.4270e-01]],

         [[ 4.1357e-01, -6.0913e-02,  7.9895e-02,  ..., -1.8835e-01,
           -5.7617e-02,  2.3450e-01],
          [-1.0327e-01,  5.2295e-01,  2.6709e-01,  ..., -1.4099e-01,
           -1.0864e-02,  2.6074e-01],
          [ 2.5317e-01, -1.7542e-01, -3.1836e-01,  ...,  1.6260e-01,
           -4.3335e-02, -2.3376e-01],
          ...,
          [ 2.3682e-02,  1.6174e-01,  5.6152e-01,  ...,  2.3743e-01,
           -5.6641e-02,  9.6191e-02],
          [ 3.9795e-01, -3.6328e-01,  2.9443e-01,  ...,  3.8232e-01,
            4.0137e-01, -1.0315e-01],
          [-1.0620e-01, -2.9663e-02, -2.9297e-03,  ...,  3.1616e-01,
           -4.6875e-01,  3.6475e-01]],

         ...,

         [[-4.4312e-02,  8.0811e-02, -6.2744e-02,  ...,  4.0479e-01,
            3.5059e-01,  3.2031e-01],
          [ 2.7051e-01, -2.6465e-01, -5.1636e-02,  ..., -9.8389e-02,
            1.2286e-01,  2.3157e-01],
          [ 3.9398e-02,  2.8857e-01,  6.4941e-01,  ...,  2.8027e-01,
           -1.1340e-01, -1.0840e-01],
          ...,
          [ 2.9639e-01,  4.9365e-01,  6.0669e-02,  ...,  2.2070e-01,
            1.0583e-01,  3.1250e-01],
          [-3.1885e-01,  2.9980e-01,  1.9409e-02,  ..., -4.4678e-02,
            3.6426e-01,  8.7097e-02],
          [ 4.0332e-01,  2.4878e-01, -7.0190e-03,  ...,  1.4368e-01,
           -1.4429e-01,  5.0488e-01]],

         [[ 3.0737e-01, -2.2888e-01,  2.9053e-02,  ...,  3.8965e-01,
            5.3772e-02,  4.7363e-02],
          [ 8.7402e-02, -1.0254e-01,  3.6768e-01,  ...,  1.6504e-01,
            3.4521e-01, -1.2854e-01],
          [ 2.4463e-01,  1.9946e-01, -7.0068e-02,  ...,  7.6172e-02,
           -3.8696e-02,  3.5095e-02],
          ...,
          [ 3.5706e-02,  4.8193e-01,  1.5552e-01,  ..., -2.3376e-01,
           -1.3611e-01,  6.3599e-02],
          [-6.3965e-02, -3.6499e-02,  2.6709e-01,  ...,  1.5784e-01,
           -4.3018e-01, -6.1646e-02],
          [ 3.8330e-01, -6.0425e-02,  1.2830e-01,  ...,  1.7358e-01,
            4.4873e-01, -6.2134e-02]],

         [[-6.1646e-03,  1.1597e-02, -2.0142e-02,  ...,  3.2178e-01,
            2.9834e-01,  4.5850e-01],
          [ 9.7656e-04,  3.8910e-02,  1.6516e-01,  ...,  7.5684e-03,
            2.5366e-01,  3.1104e-01],
          [ 5.8075e-02,  3.8037e-01,  1.1688e-01,  ...,  8.7891e-02,
            1.2915e-01,  9.6985e-02],
          ...,
          [ 1.4856e-01, -2.7979e-01, -3.6255e-02,  ...,  2.3914e-01,
            4.4824e-01,  6.7749e-03],
          [-1.6479e-03,  1.9250e-01,  1.7993e-01,  ...,  2.3108e-01,
            8.1787e-03, -1.1438e-01],
          [-2.2131e-01,  4.7021e-01, -1.8555e-02,  ...,  3.8574e-01,
            1.4624e-01,  1.6528e-01]]],


        [[[-2.3889e-01,  3.0078e-01, -1.4526e-01,  ..., -1.6174e-01,
            8.4839e-02,  2.6709e-01],
          [-2.9199e-01, -1.2183e-01,  1.6504e-01,  ...,  9.1064e-02,
            4.8340e-01,  1.3977e-01],
          [ 5.8301e-01,  2.1399e-01, -2.6367e-01,  ..., -1.0645e-01,
            3.8623e-01, -2.4719e-01],
          ...,
          [ 1.5454e-01, -3.4033e-01,  1.9531e-03,  ..., -1.2598e-01,
            2.3254e-01,  6.0394e-02],
          [ 3.2520e-01,  5.6445e-01, -1.4941e-01,  ...,  2.5732e-01,
            1.5137e-01,  1.3403e-01],
          [ 2.9858e-01,  1.2402e-01, -3.9062e-03,  ...,  3.2520e-01,
           -9.7046e-02,  3.4546e-01]],

         [[-9.1797e-02,  9.0637e-02,  1.3953e-01,  ...,  9.5764e-02,
            1.5991e-01,  2.5049e-01],
          [-1.0461e-01,  2.7466e-03,  1.7163e-01,  ..., -1.4978e-01,
            1.8872e-01,  1.2646e-01],
          [-4.0430e-01,  2.8955e-01,  4.7217e-01,  ..., -2.6123e-02,
            6.3965e-02,  1.3953e-01],
          ...,
          [ 1.7065e-01, -1.3928e-01,  1.7029e-02,  ...,  1.0767e-01,
           -4.1650e-01, -3.0518e-01],
          [-2.4231e-01,  7.6355e-02,  1.8420e-01,  ..., -1.6028e-01,
           -7.6660e-02,  3.8672e-01],
          [ 1.9202e-01,  5.6836e-01, -1.0864e-02,  ...,  2.5391e-01,
           -1.8469e-01,  4.7455e-02]],

         [[ 2.1143e-01,  4.8828e-01,  2.0801e-01,  ..., -9.9121e-02,
            5.1147e-02,  1.4038e-03],
          [ 1.6333e-01,  2.3315e-02, -2.2302e-01,  ...,  4.7852e-02,
           -2.0374e-01,  2.2461e-01],
          [-1.9324e-01,  1.6919e-01, -3.9795e-01,  ..., -3.6621e-02,
            4.7754e-01,  1.2769e-01],
          ...,
          [-1.5808e-01,  1.5369e-01, -2.0752e-03,  ..., -2.0911e-01,
            1.9897e-01,  3.1421e-01],
          [-1.1438e-01,  3.4131e-01, -1.1230e-02,  ...,  1.2048e-01,
            2.9321e-01,  2.9688e-01],
          [ 3.8037e-01,  2.2266e-01,  4.2432e-01,  ...,  2.6440e-01,
            1.7065e-01, -2.0508e-02]],

         ...,

         [[ 2.6611e-02, -3.8696e-02, -7.9346e-03,  ..., -4.3457e-02,
            1.8750e-01,  1.5234e-01],
          [ 1.6382e-01,  1.9104e-01,  5.1575e-02,  ...,  4.4531e-01,
            4.4708e-02,  2.7344e-01],
          [ 2.6123e-02,  3.9111e-01,  2.0935e-01,  ..., -1.4136e-01,
            4.6722e-02,  8.6487e-02],
          ...,
          [ 3.0420e-01, -2.4695e-01, -1.2988e-01,  ...,  1.3794e-02,
            1.5820e-01,  3.2275e-01],
          [ 5.0720e-02,  8.5083e-02,  1.9556e-01,  ..., -2.6318e-01,
            4.6387e-03, -2.9053e-02],
          [-2.0374e-01,  1.3416e-01,  4.7119e-02,  ..., -4.4800e-02,
           -2.8418e-01,  2.4902e-01]],

         [[ 1.6003e-01,  7.2754e-02, -1.4136e-01,  ...,  9.0332e-03,
            1.7517e-01,  2.2424e-01],
          [ 2.0874e-02, -2.1716e-01, -1.6199e-01,  ...,  1.9409e-02,
            6.9824e-02,  1.4673e-01],
          [ 8.1238e-02,  3.3765e-01,  3.6865e-01,  ..., -2.0129e-01,
            3.0762e-01, -1.5125e-01],
          ...,
          [ 1.9800e-01,  2.5488e-01, -5.2979e-02,  ..., -8.4595e-02,
           -1.4368e-01,  2.2473e-01],
          [-2.7954e-02,  2.8931e-02, -9.5459e-02,  ...,  6.0394e-02,
           -1.9421e-01, -9.9731e-02],
          [-6.6772e-02, -1.8347e-01,  7.5378e-02,  ...,  5.7666e-01,
            3.8818e-02,  1.1609e-01]],

         [[ 3.2690e-01, -7.9834e-02, -1.9910e-01,  ...,  4.0527e-01,
            8.4839e-03,  1.6394e-01],
          [ 2.1765e-01,  1.9299e-01,  2.6367e-01,  ..., -7.9224e-02,
            4.2139e-01, -1.5222e-01],
          [ 5.2783e-01,  7.5073e-02, -1.7212e-02,  ...,  3.4790e-03,
            2.5818e-02, -4.7119e-02],
          ...,
          [ 8.5693e-02, -1.6394e-01,  3.5693e-01,  ..., -8.9111e-03,
           -1.4880e-01, -1.2927e-01],
          [ 1.9031e-01,  4.2334e-01, -5.4321e-02,  ...,  7.1289e-02,
            4.1357e-01, -1.1389e-01],
          [ 2.2522e-01, -6.7749e-02,  5.1422e-02,  ..., -5.6763e-03,
            4.5850e-01, -3.9062e-02]]],


        [[[ 2.1680e-01,  2.1594e-01,  2.4036e-01,  ...,  2.4719e-01,
            3.5303e-01,  8.4839e-03],
          [ 5.6885e-02,  1.0883e-01, -3.1494e-02,  ...,  8.6792e-02,
            2.0312e-01,  7.7393e-02],
          [ 3.0249e-01,  1.0516e-01, -7.7393e-02,  ...,  4.2334e-01,
           -3.4863e-01,  1.0480e-01],
          ...,
          [-2.0325e-01,  1.9983e-01,  1.8115e-01,  ...,  2.9053e-02,
            4.9072e-01,  3.4961e-01],
          [ 1.5930e-01,  3.0762e-01, -4.1260e-02,  ...,  7.0679e-02,
           -8.1177e-02,  8.3862e-02],
          [-7.8857e-02,  5.3345e-02, -3.0078e-01,  ...,  1.9336e-01,
            1.5503e-01, -1.2500e-01]],

         [[ 3.4082e-01,  4.4775e-01, -6.8604e-02,  ..., -1.7517e-01,
            1.4771e-02, -1.4429e-01],
          [-2.1362e-03, -3.2568e-01,  1.3306e-01,  ...,  1.9971e-01,
            2.2424e-01,  5.8789e-01],
          [ 3.0762e-01,  6.0028e-02,  8.2153e-02,  ...,  5.7080e-01,
            2.8491e-01,  4.0894e-02],
          ...,
          [ 1.9409e-02,  3.2983e-01,  1.8970e-01,  ..., -8.4229e-03,
           -1.1914e-01, -1.7322e-01],
          [-8.2397e-02, -9.3140e-02,  1.0205e-01,  ...,  2.6184e-02,
           -4.9194e-02,  4.1602e-01],
          [ 4.3555e-01,  1.3025e-01,  2.0264e-01,  ..., -4.0649e-02,
           -9.1675e-02, -1.5320e-02]],

         [[ 3.0640e-01,  3.2764e-01,  7.8674e-02,  ...,  1.1493e-01,
           -2.6489e-02,  3.1055e-01],
          [ 3.2861e-01,  3.4619e-01,  1.1023e-01,  ...,  1.6736e-01,
            3.2812e-01,  2.7490e-01],
          [-5.3955e-02,  2.2144e-01, -9.5825e-03,  ..., -1.5051e-01,
            9.1553e-02,  1.6772e-01],
          ...,
          [ 6.8115e-02, -1.0938e-01,  1.3818e-01,  ...,  2.1094e-01,
            1.7676e-01, -1.6443e-01],
          [ 2.3499e-02,  9.3567e-02,  3.1799e-02,  ..., -2.5146e-02,
           -1.3574e-01, -1.2012e-01],
          [-1.0559e-02,  4.0802e-02, -9.1064e-02,  ...,  1.3147e-01,
            1.4783e-01,  2.5269e-02]],

         ...,

         [[ 2.0044e-01,  2.3401e-01, -3.2837e-02,  ..., -2.1545e-01,
            2.2534e-01,  3.2007e-01],
          [ 7.7759e-02,  2.0581e-01,  3.5254e-01,  ...,  3.6279e-01,
            3.5205e-01, -5.6763e-03],
          [ 3.3997e-02,  1.3684e-01,  1.0205e-01,  ...,  4.5557e-01,
           -1.1096e-01, -3.4790e-02],
          ...,
          [ 7.2449e-02,  6.0608e-02,  7.2632e-02,  ...,  3.5706e-02,
            3.3447e-01,  2.4646e-01],
          [-2.6123e-01,  4.1504e-01, -1.8152e-01,  ...,  4.2920e-01,
            3.1055e-01, -4.6875e-02],
          [-1.1731e-01,  4.6143e-01, -2.3499e-01,  ...,  2.8345e-01,
            2.1204e-01,  9.5398e-02]],

         [[ 4.3604e-01,  8.1543e-02,  3.9062e-02,  ...,  1.1658e-02,
            1.8127e-02,  1.5051e-01],
          [ 3.4937e-01,  2.2852e-01,  8.5388e-02,  ..., -1.7297e-01,
            3.1555e-02, -1.0254e-01],
          [ 9.2957e-02,  3.3374e-01,  6.2622e-02,  ..., -5.5664e-02,
            6.9275e-02, -2.0142e-02],
          ...,
          [ 3.4619e-01,  2.4084e-01,  2.9102e-01,  ...,  6.6772e-02,
            1.3306e-01, -1.1597e-02],
          [ 2.1790e-01,  5.5713e-01, -4.4678e-02,  ...,  4.7699e-02,
            1.7236e-01,  2.4878e-01],
          [-1.3806e-01, -1.7273e-01,  7.4219e-02,  ..., -2.3694e-01,
            1.7676e-01,  1.9409e-01]],

         [[ 2.7441e-01,  4.4189e-01, -3.4302e-02,  ...,  1.1694e-01,
            1.7432e-01, -3.8330e-02],
          [-5.0903e-02,  2.9688e-01, -1.3391e-01,  ..., -1.2329e-02,
            1.1530e-01,  9.8877e-03],
          [ 4.1846e-01,  6.6528e-03, -3.6279e-01,  ...,  1.7261e-01,
            2.4805e-01, -5.1025e-02],
          ...,
          [ 1.5820e-01,  4.1687e-02,  5.2783e-01,  ...,  3.7305e-01,
            1.5369e-01,  2.9102e-01],
          [-1.5051e-01,  2.1155e-01, -2.8320e-01,  ...,  3.0835e-01,
            5.0977e-01,  1.0626e-01],
          [ 3.8330e-01,  1.3733e-01,  3.2288e-02,  ...,  2.3633e-01,
           -2.1130e-01,  1.1407e-01]]]], device='cuda:0', dtype=torch.float16,
       requires_grad=True)
k input:  tensor([[[[ 0.5918,  0.3555,  0.6709,  ...,  0.4880,  0.2852,  0.1199],
          [ 0.6094,  0.1130,  0.2235,  ...,  0.1693,  0.2881,  0.3381],
          [ 0.4475,  0.1980,  0.0713,  ...,  0.2776,  0.4707,  0.1304],
          ...,
          [-0.0586,  0.3979,  0.4495,  ...,  0.4561,  0.8262,  0.2988],
          [ 0.4504,  0.5454,  0.3833,  ...,  0.0811,  0.2072,  0.3401],
          [ 0.4285,  0.4458,  0.4392,  ...,  0.1067,  0.3755,  0.3127]],

         [[ 0.2524,  0.2441,  0.1724,  ...,  0.2205,  0.6431,  0.3362],
          [ 0.2861,  0.5156,  0.0505,  ...,  0.2676,  0.4270,  0.4946],
          [ 0.2896,  0.4902,  0.1365,  ...,  0.3547, -0.0325,  0.3843],
          ...,
          [ 0.4031,  0.6348,  0.3955,  ...,  0.4885,  0.3145,  0.3262],
          [ 0.3718,  0.5859,  0.3442,  ...,  0.0493, -0.0298,  0.4819],
          [ 0.4929,  0.4873,  0.4810,  ...,  0.5640,  0.7031,  0.1779]],

         [[ 0.4639,  0.4800,  0.3723,  ...,  0.4702,  0.0962,  0.7046],
          [ 0.3965,  0.6738,  0.5200,  ...,  0.8193,  0.3120,  0.2617],
          [ 0.0952,  0.2969,  0.2849,  ..., -0.0503,  0.5688,  0.5366],
          ...,
          [ 0.2145,  0.3086,  0.4033,  ...,  0.3406,  0.3845,  0.5020],
          [ 0.2705,  0.3132,  0.3906,  ...,  0.5625,  0.3765,  0.3679],
          [ 0.1133,  0.5278,  0.3225,  ...,  0.2820,  0.4937,  0.0498]],

         ...,

         [[ 0.4712,  0.3740,  0.6963,  ...,  0.0913,  0.7788,  0.4626],
          [ 0.4312,  0.6270,  0.0645,  ...,  0.4653,  0.7622,  0.5898],
          [ 0.5049,  0.4021,  0.4512,  ...,  0.2720,  0.4275,  0.3853],
          ...,
          [ 0.0986,  0.3877,  0.3762,  ...,  0.3052,  0.5166,  0.4233],
          [ 0.2078,  0.2759,  0.6362,  ...,  0.4380,  0.5693,  0.5366],
          [ 0.4585,  0.6357,  0.5039,  ...,  0.6162,  0.2251,  0.4521]],

         [[ 0.5444,  0.2460,  0.3850,  ...,  0.2383,  0.6982,  0.3096],
          [ 0.1523,  1.0312,  0.5601,  ...,  0.2080,  0.4438,  0.4041],
          [ 0.5801,  0.2227,  0.8140,  ...,  0.5669,  0.2742,  0.4563],
          ...,
          [ 0.2896,  0.2268,  0.4380,  ..., -0.0591,  0.1976,  0.3560],
          [ 0.3728,  0.2046,  0.6392,  ...,  0.3440,  0.1147,  0.3572],
          [ 0.0425,  0.2156,  0.4280,  ...,  0.2974,  0.6338,  0.6294]],

         [[ 0.3108,  0.5312,  0.5146,  ...,  0.2319,  0.5234,  0.5859],
          [ 0.5078,  0.5903,  0.4795,  ...,  0.5454,  0.5200,  0.3850],
          [-0.0378,  0.4414,  0.4014,  ...,  0.3286,  0.3367,  0.4409],
          ...,
          [ 0.0139,  0.5693,  0.6152,  ...,  0.0249,  0.4893,  0.3259],
          [ 0.2961,  0.4509,  0.2671,  ..., -0.1045,  0.2805,  0.3765],
          [ 0.4470,  0.3306,  0.4126,  ...,  0.2520,  0.3430,  0.5176]]],


        [[[ 0.3047,  0.3325,  0.3765,  ...,  0.1534,  0.1416,  0.5723],
          [ 0.3052,  0.4614,  0.4573,  ...,  0.4414,  0.4292,  0.2512],
          [ 0.4604,  0.6289,  0.2566,  ...,  0.8926,  0.2842,  0.4067],
          ...,
          [ 0.3674,  0.4292,  0.7041,  ...,  0.3999,  0.2878,  0.6011],
          [ 0.7588,  0.1338,  0.3423,  ...,  0.3047,  0.3154,  0.3079],
          [ 0.0239,  0.3647,  0.3657,  ...,  0.6670,  0.5088,  0.1448]],

         [[ 0.1001,  0.0830,  0.3384,  ...,  0.4163,  0.5679,  0.8179],
          [ 0.5469,  0.2059,  0.0200,  ...,  0.5576,  0.5532,  0.2303],
          [ 0.3721,  0.2695,  0.2791,  ...,  0.2515,  0.3987,  0.5195],
          ...,
          [ 0.5610,  0.4355,  0.3723,  ...,  0.1252,  0.5254,  0.4595],
          [ 0.7163,  0.4167,  0.6768,  ...,  0.5142,  0.1184,  0.3938],
          [ 0.4011,  0.4529,  0.1064,  ...,  0.1697,  0.3850,  0.5273]],

         [[ 0.4971,  0.4614,  0.2407,  ...,  0.2588,  0.0374,  0.2954],
          [ 0.5820,  0.2603,  0.1873,  ...,  0.2477,  0.2981,  0.3022],
          [ 0.4133,  0.1957,  0.3838,  ...,  0.5405,  0.3794,  0.2949],
          ...,
          [ 0.2632,  0.2842,  0.4839,  ...,  0.6284,  0.2522,  0.5840],
          [ 0.5610,  0.1519,  0.3645,  ...,  0.5347,  0.2025,  0.5000],
          [ 0.5874,  0.3159,  0.0090,  ...,  0.0591,  0.5293,  0.5186]],

         ...,

         [[ 0.1888,  0.3694,  0.4561,  ...,  0.6670,  0.6992,  0.0962],
          [ 0.4980,  0.5815,  0.3916,  ...,  0.4424,  0.3403,  0.2112],
          [ 0.4302,  0.2137,  0.2542,  ..., -0.0554,  0.4021,  0.3818],
          ...,
          [ 0.2120,  0.2534,  0.3804,  ...,  0.6099,  0.4214,  0.1888],
          [ 0.7983,  0.4758,  0.4790,  ...,  0.4399,  0.2236,  0.3057],
          [ 0.3257,  0.2534,  0.3479,  ...,  0.0059,  0.3108,  0.2524]],

         [[-0.0601,  0.5879,  0.4836,  ...,  0.3757,  0.4121,  0.5171],
          [ 0.8896,  0.0669,  0.3655,  ...,  0.1996,  0.4863,  0.8140],
          [ 0.5742,  0.6748,  0.5200,  ...,  0.4565,  0.5322, -0.0398],
          ...,
          [ 0.2986,  0.8633,  0.1544,  ...,  0.3594,  0.3823,  0.5415],
          [ 0.2419,  0.3501,  0.2656,  ...,  0.7686,  0.4460,  0.3308],
          [ 0.3296,  0.3330,  0.2710,  ...,  0.4509,  0.4414, -0.0066]],

         [[ 0.2317,  0.4578,  0.3972,  ...,  0.1722,  0.5166,  0.4597],
          [ 0.0967,  0.4905,  0.1625,  ...,  0.1316,  0.4055,  0.3804],
          [ 0.2847,  0.5439,  0.6748,  ...,  0.4531,  0.0718,  0.6885],
          ...,
          [ 0.5293,  0.1743,  0.3262,  ...,  0.6582,  0.5117,  0.5806],
          [ 0.0505,  0.5513,  0.6299,  ...,  0.1353,  0.3655,  0.3188],
          [ 0.2549,  0.2822,  0.7256,  ...,  0.5996,  0.2041,  0.3599]]],


        [[[ 0.6270,  0.5576,  0.6445,  ...,  0.3982,  0.6089,  0.3730],
          [ 0.2554,  0.3879,  0.5488,  ...,  0.5596,  0.3215,  0.1915],
          [ 0.1674,  0.4492,  0.4954,  ...,  0.1553,  0.3823,  0.5215],
          ...,
          [-0.0176,  0.0212,  0.5908,  ...,  0.2961,  0.2915,  0.3188],
          [ 0.4395,  0.3152,  0.4500,  ...,  0.4512,  0.5303,  0.3210],
          [ 0.7056, -0.0278,  0.2241,  ...,  0.5361,  0.4800,  0.6865]],

         [[ 0.4785,  0.0474,  0.4194,  ...,  0.2932,  1.0898,  0.1779],
          [ 0.2505,  0.1827,  0.3176,  ...,  0.4946,  0.7285,  0.3225],
          [ 0.1729,  0.2642,  0.6631,  ...,  0.4031,  0.5581, -0.0737],
          ...,
          [ 0.4351,  0.3789,  0.3694,  ...,  0.6270,  0.2996,  0.6313],
          [ 0.6958,  0.7417,  0.4722,  ...,  0.4172,  0.5938,  0.3782],
          [ 0.4692,  0.2192,  0.6006,  ...,  0.6826,  0.4653,  0.3235]],

         [[ 0.1826,  0.3196,  0.6348,  ...,  0.3022,  0.4597,  0.4385],
          [ 0.1389,  0.3740,  0.6592,  ...,  0.3982,  0.4304,  0.2052],
          [ 0.5181,  0.5879,  0.5312,  ...,  0.3301,  0.1362,  0.5542],
          ...,
          [ 0.3167,  0.2883,  0.7871,  ...,  0.4348,  0.4326,  0.6289],
          [ 0.3245,  0.4399,  0.2656,  ...,  0.3621,  0.4062, -0.1611],
          [ 0.2202,  0.5840,  0.2075,  ...,  0.3879,  0.4158,  0.4119]],

         ...,

         [[ 0.4302,  0.5342,  0.6182,  ...,  0.5103,  0.4888,  0.6260],
          [ 0.7910,  0.4038,  0.3232,  ...,  0.5391,  0.2878,  0.7456],
          [ 0.2961,  0.3445,  0.6025,  ...,  0.1938,  0.5894,  0.6836],
          ...,
          [ 0.6045,  0.6533,  0.6670,  ...,  0.2432,  0.3955,  0.3044],
          [ 0.3135,  0.4280,  0.2971,  ...,  0.2115,  0.1523,  0.5562],
          [ 0.1841,  0.3882,  0.4319,  ...,  0.4932,  0.1145,  0.2666]],

         [[ 0.3091,  0.1377, -0.0171,  ...,  0.5098,  0.3198,  0.5205],
          [ 0.1937,  0.5747,  0.3926,  ...,  0.4771,  0.4497,  0.4302],
          [ 0.5298, -0.0891,  0.9023,  ...,  0.8940,  0.8530,  0.3896],
          ...,
          [ 0.4243,  0.2300,  0.0972,  ...,  0.0986,  0.5942, -0.0571],
          [ 0.2368,  0.5488,  0.4490,  ...,  0.4045,  0.1301,  0.2612],
          [-0.2432,  0.4209,  0.7588,  ...,  0.5049,  0.5820,  0.4995]],

         [[ 0.4810,  0.1111,  0.4097,  ...,  0.5972,  0.5068,  0.0095],
          [ 0.4241,  0.2715, -0.0542,  ...,  0.3826,  0.2798,  0.2439],
          [ 0.0884,  0.4199,  0.4749,  ...,  0.5181,  0.4333,  0.3003],
          ...,
          [-0.0149,  0.3572,  0.3008,  ...,  0.1135,  0.2964,  0.4910],
          [ 0.5146,  0.4907,  0.4224,  ...,  0.7568,  0.4475,  0.1008],
          [ 0.6641,  0.4749,  0.0791,  ...,  0.3308,  0.4338,  0.2135]]],


        [[[ 0.5981,  0.5332,  0.6602,  ...,  0.1769,  0.2869,  0.4761],
          [ 0.2744,  0.4705,  0.3870,  ...,  0.2903,  0.4302,  0.2500],
          [ 0.1196,  0.4539,  0.4246,  ...,  0.4102,  0.3584,  0.2930],
          ...,
          [ 0.3086,  0.6064,  0.5933,  ...,  0.3391,  0.2720,  0.5552],
          [ 0.3857,  0.3577,  0.0425,  ...,  0.1722,  0.6206,  0.3701],
          [ 0.3245,  0.3115,  0.2144,  ...,  0.1116,  0.6162,  0.2062]],

         [[ 0.4163,  0.1943,  0.3660,  ...,  0.3486,  0.6475,  0.5659],
          [ 0.8066,  0.4990,  0.5518,  ...,  0.3350,  0.5811,  0.0474],
          [ 0.0681,  0.7002,  0.3130,  ...,  0.5220,  0.4053,  0.5513],
          ...,
          [ 0.6138,  0.3936,  0.3674,  ...,  0.2527,  0.4622,  0.2986],
          [ 0.1801,  0.2327,  0.4309,  ...,  0.3188,  0.1924,  0.2981],
          [ 0.3950,  0.5615,  0.3721,  ...,  0.4780,  0.3108,  0.4695]],

         [[-0.1104,  0.0640,  0.3328,  ...,  0.4802,  0.4937,  0.5771],
          [ 0.4297,  0.2959,  0.3933,  ...,  0.5195,  0.5732,  0.1091],
          [ 0.2356,  0.2383,  0.4724,  ...,  0.4829,  0.5703,  0.3428],
          ...,
          [ 0.2109,  0.4751,  0.5181,  ...,  0.3569,  0.0588,  0.5840],
          [ 0.1863,  0.4277,  0.6113,  ...,  0.5571,  0.2040,  0.5557],
          [ 0.7749, -0.1938,  0.1968,  ...,  0.5322,  0.0413,  0.3381]],

         ...,

         [[ 0.1514,  0.3977,  0.6123,  ...,  0.7637,  0.4543,  0.6650],
          [ 0.7910,  0.3838,  0.5005,  ...,  0.5469,  0.1677,  0.1685],
          [ 0.4182,  0.3130,  0.6377,  ...,  0.3608,  0.5029,  0.1436],
          ...,
          [ 0.6113,  0.2457,  0.4004,  ...,  0.1431,  0.3979,  0.3396],
          [ 0.3032,  0.0796,  0.1798,  ...,  0.6416,  0.4487,  0.5044],
          [ 0.6167,  0.2101,  0.4521,  ...,  0.3989,  0.5454,  0.1250]],

         [[ 0.2001,  0.3398,  0.3816,  ...,  0.2179,  0.5283,  0.2717],
          [ 0.6875,  0.5698,  0.5820,  ...,  0.4158,  0.4756,  0.4487],
          [ 0.3359,  0.2888, -0.0574,  ...,  0.2588,  0.2983,  0.0054],
          ...,
          [ 0.3789,  0.2422,  0.5454,  ...,  0.5239,  0.3169,  0.5771],
          [ 0.4229,  0.6572,  0.3884,  ...,  0.3535,  0.2800,  0.4446],
          [ 0.4607,  0.6611,  0.3018,  ...,  0.5977,  0.2903,  0.3154]],

         [[ 0.5449,  0.2964,  0.5361,  ...,  0.0378,  0.7246,  0.4670],
          [ 0.3125,  0.5957,  0.7861,  ...,  0.2917,  0.4680,  0.2107],
          [ 0.5591,  0.9150,  0.6211,  ...,  0.2003,  0.6025,  0.4746],
          ...,
          [ 0.1925,  0.5015,  0.3713,  ...,  0.5518,  0.5049,  0.2834],
          [ 0.5312,  0.2642,  0.2175,  ...,  0.6318,  0.5166,  0.0854],
          [ 0.4021,  0.4270,  0.2810,  ...,  0.3320,  0.4341,  0.2150]]]],
       device='cuda:0', dtype=torch.float16, requires_grad=True)
v input:  tensor([[[[ 4.3359e-01,  3.9160e-01,  5.5127e-01,  ...,  1.9958e-01,
            4.4238e-01,  2.2632e-01],
          [ 4.2578e-01,  4.8145e-01,  1.9482e-01,  ...,  3.3691e-01,
            6.3770e-01,  2.5195e-01],
          [ 6.4648e-01,  6.1230e-01,  6.4062e-01,  ...,  7.1533e-02,
            4.5752e-01,  3.2764e-01],
          ...,
          [ 7.8247e-02,  1.9312e-01,  5.5908e-02,  ...,  3.8818e-01,
            6.1182e-01, -2.4414e-04],
          [ 4.9170e-01, -1.9556e-01,  2.3584e-01,  ...,  7.9297e-01,
            1.9238e-01,  3.8574e-01],
          [ 3.8794e-01,  1.4893e-01,  4.3970e-01,  ...,  3.0835e-01,
            7.5195e-01,  3.1079e-01]],

         [[ 3.2031e-01,  5.2686e-01,  3.8452e-01,  ...,  1.6443e-01,
            4.0332e-01, -5.9326e-02],
          [ 8.7158e-02,  4.9976e-01,  3.7012e-01,  ..., -1.0229e-01,
            2.0935e-01,  5.4834e-01],
          [-4.5654e-02,  4.8999e-01,  2.9272e-01,  ...,  6.2598e-01,
            4.6143e-01,  2.9395e-01],
          ...,
          [ 6.3477e-01,  1.7908e-01,  6.0840e-01,  ..., -7.2754e-02,
            3.0811e-01,  3.8037e-01],
          [ 2.2900e-01, -1.8921e-01,  8.8135e-02,  ...,  1.3818e-01,
            2.6465e-01,  4.1162e-01],
          [-5.6152e-03,  1.7017e-01,  5.4688e-01,  ...,  1.6296e-01,
            6.9824e-02,  5.1074e-01]],

         [[ 2.8247e-01,  5.5176e-01,  1.9165e-01,  ...,  7.7100e-01,
            2.8589e-01,  2.5049e-01],
          [ 1.1328e-01,  3.2227e-01,  9.3018e-02,  ...,  1.8103e-01,
            2.6123e-01,  4.0405e-01],
          [ 2.5806e-01,  4.4287e-01,  1.9653e-01,  ...,  1.0376e-01,
            2.9053e-01,  3.7109e-02],
          ...,
          [ 2.5464e-01,  5.7471e-01, -4.2725e-02,  ...,  3.1909e-01,
            3.1982e-02,  5.1758e-01],
          [ 3.9307e-01,  2.2583e-01,  1.1938e-01,  ...,  1.6565e-01,
            3.1128e-01,  5.0781e-01],
          [ 2.0239e-01,  1.2085e-01,  2.2827e-01,  ...,  4.8999e-01,
           -1.5381e-02,  5.8350e-01]],

         ...,

         [[ 1.0486e-01,  2.5879e-01,  1.6833e-01,  ...,  6.9043e-01,
            5.4810e-02,  2.1924e-01],
          [ 1.9653e-01,  3.3521e-01,  1.4404e-02,  ...,  3.1714e-01,
           -1.2964e-01,  1.9678e-01],
          [-5.2734e-02,  2.4158e-01,  2.4109e-01,  ...,  3.0249e-01,
            6.4404e-01, -4.5654e-02],
          ...,
          [ 2.9761e-01,  3.3643e-01,  6.3574e-01,  ...,  7.6904e-02,
            7.4121e-01,  5.3516e-01],
          [ 4.3994e-01,  3.2837e-01,  4.6069e-01,  ...,  3.5059e-01,
            6.4746e-01,  5.7373e-02],
          [ 2.1838e-01,  3.7354e-02,  2.9980e-01,  ...,  1.1951e-01,
            3.1299e-01,  5.1953e-01]],

         [[ 9.5459e-02,  2.3730e-01,  4.7241e-01,  ...,  4.8682e-01,
            5.1074e-01,  4.1602e-01],
          [ 2.6221e-01, -1.2402e-01,  5.8154e-01,  ...,  4.0723e-01,
            2.4072e-01,  2.9883e-01],
          [ 3.9990e-01,  2.8247e-01,  2.5244e-01,  ...,  3.2959e-01,
            3.0664e-01,  2.1375e-01],
          ...,
          [ 1.5930e-01,  9.2285e-02,  5.5908e-02,  ...,  1.9727e-01,
            4.3408e-01, -4.0527e-02],
          [ 5.1709e-01,  3.2593e-01,  4.4775e-01,  ...,  5.3711e-01,
            6.1401e-02,  3.6353e-01],
          [ 8.1909e-02,  2.8296e-01,  3.4521e-01,  ...,  1.9434e-01,
           -6.4941e-02,  1.5991e-01]],

         [[ 1.1047e-01,  1.4282e-01, -7.4219e-02,  ...,  3.3228e-01,
            5.9229e-01,  5.2148e-01],
          [ 6.1646e-02,  5.3174e-01,  2.3523e-01,  ...,  4.0283e-02,
            4.8535e-01,  5.3516e-01],
          [ 1.9434e-01,  3.6963e-01,  2.3462e-01,  ...,  3.9062e-01,
            4.4800e-01,  2.7295e-01],
          ...,
          [ 3.8916e-01,  2.6538e-01,  4.5581e-01,  ...,  6.0059e-02,
            1.5100e-01,  1.7566e-01],
          [ 5.5176e-01,  2.9248e-01,  3.7451e-01,  ...,  3.7036e-01,
            6.1523e-01,  9.4971e-02],
          [ 1.8298e-01,  4.7534e-01,  8.0566e-03,  ...,  1.5039e-01,
            2.8833e-01,  1.0229e-01]]],


        [[[ 1.4478e-01,  4.4458e-01,  2.7344e-02,  ...,  2.8369e-01,
            5.2588e-01,  4.5142e-01],
          [-1.8066e-02,  4.3555e-01,  3.8721e-01,  ...,  3.3569e-01,
            3.5254e-01,  3.0298e-01],
          [ 6.4331e-02,  5.8008e-01,  1.0181e-01,  ...,  3.3545e-01,
            2.7710e-01,  2.7759e-01],
          ...,
          [ 1.9617e-01,  3.0225e-01,  7.0264e-01,  ...,  3.3691e-01,
            3.4399e-01,  4.8926e-01],
          [-1.0986e-02,  3.9380e-01,  2.1167e-01,  ...,  3.5742e-01,
            2.1289e-01,  2.7393e-01],
          [ 2.6880e-01,  3.1787e-01,  1.8579e-01,  ...,  6.4941e-02,
            1.8750e-01,  4.4873e-01]],

         [[-1.0571e-01,  1.4148e-01,  5.2979e-02,  ..., -2.6855e-03,
            6.7578e-01,  3.9893e-01],
          [ 6.2256e-02,  2.8516e-01,  1.6858e-01,  ...,  5.0342e-01,
           -6.8115e-02,  3.4204e-01],
          [ 3.6743e-01,  4.7021e-01,  2.7466e-01,  ...,  3.7988e-01,
            9.8755e-02,  4.9097e-01],
          ...,
          [ 3.0176e-01,  5.6934e-01,  3.0151e-01,  ...,  4.7363e-02,
            4.4434e-01,  6.6602e-01],
          [ 9.6558e-02,  2.3767e-01,  1.8396e-01,  ...,  2.3303e-01,
            4.6826e-01,  2.0654e-01],
          [ 2.9346e-01,  4.1113e-01,  3.8428e-01,  ...,  4.6558e-01,
            5.0537e-01, -1.0840e-01]],

         [[ 2.5049e-01, -2.6855e-03,  4.2676e-01,  ..., -4.5410e-02,
            1.7627e-01,  6.0449e-01],
          [ 2.7026e-01,  6.3086e-01,  4.5410e-01,  ...,  2.7271e-01,
            5.5176e-01, -2.9053e-02],
          [ 1.4124e-01,  6.8750e-01, -1.0620e-01,  ...,  1.5515e-01,
            2.2192e-01,  3.4180e-01],
          ...,
          [ 1.2366e-01,  4.7119e-01,  1.7310e-01,  ...,  2.9736e-01,
            3.6523e-01,  3.2568e-01],
          [ 4.3115e-01,  5.5322e-01,  1.6296e-01,  ..., -2.6123e-02,
            4.5801e-01,  4.1943e-01],
          [ 7.0801e-03,  2.1082e-01, -5.1270e-02,  ...,  3.6694e-01,
            6.4453e-01,  2.7783e-01]],

         ...,

         [[ 3.9062e-01,  4.9487e-01,  3.2275e-01,  ...,  2.6562e-01,
            1.5942e-01,  2.6855e-01],
          [ 4.0381e-01,  5.1465e-01,  4.0869e-01,  ...,  6.6113e-01,
            2.4487e-01,  3.8672e-01],
          [ 2.3389e-01,  1.6931e-01,  2.5464e-01,  ...,  2.4780e-01,
            7.7637e-02,  9.3018e-02],
          ...,
          [ 3.2935e-01,  3.5571e-01,  6.1914e-01,  ...,  3.8574e-01,
            5.5029e-01,  6.0449e-01],
          [ 2.3633e-01,  5.1660e-01,  2.0581e-01,  ...,  2.7271e-01,
            3.0029e-02,  5.9424e-01],
          [ 4.9438e-01,  5.6250e-01, -8.3740e-02,  ...,  6.1328e-01,
            1.4966e-01,  3.1885e-01]],

         [[-1.5918e-01, -4.0747e-01,  1.4099e-01,  ...,  6.7969e-01,
            1.6467e-01,  2.4731e-01],
          [ 4.4434e-02,  3.8867e-01, -2.1851e-01,  ...,  1.8188e-01,
            4.1406e-01,  3.3887e-01],
          [ 2.3633e-01,  4.6460e-01,  5.9961e-01,  ...,  5.5322e-01,
            5.5469e-01,  1.2207e-02],
          ...,
          [ 5.6299e-01,  4.7607e-02,  5.5225e-01,  ...,  5.3271e-01,
            1.6467e-01,  1.0901e-01],
          [ 2.2729e-01,  1.0559e-01,  3.4375e-01,  ...,  2.9395e-01,
            3.1201e-01,  4.4678e-02],
          [ 2.5098e-01, -7.8857e-02,  1.6614e-01,  ...,  3.9282e-01,
            2.9004e-01,  4.2627e-01]],

         [[ 4.9146e-01, -4.6875e-02,  6.0059e-01,  ...,  3.7817e-01,
            4.9854e-01,  3.3350e-01],
          [ 5.2612e-02,  2.7173e-01, -3.1982e-02,  ...,  3.1201e-01,
            2.3901e-01,  3.1250e-01],
          [ 2.2925e-01,  3.8257e-01,  1.6370e-01,  ...,  3.6279e-01,
            6.8359e-01,  2.5391e-01],
          ...,
          [ 1.8359e-01,  5.5469e-01,  3.2153e-01,  ...,  4.2627e-01,
            5.3516e-01,  5.6396e-02],
          [-3.1421e-01,  3.8257e-01,  4.2578e-01,  ...,  1.0095e-01,
            4.1187e-01,  5.3369e-01],
          [ 2.9541e-01, -1.2573e-01,  3.5083e-01,  ...,  2.9346e-01,
            3.3936e-01,  3.8525e-01]]],


        [[[ 5.4004e-01,  4.0088e-01,  4.9072e-01,  ...,  7.3242e-01,
            1.4954e-01,  9.2651e-02],
          [ 1.8091e-01,  1.9421e-01,  3.1079e-01,  ...,  2.5439e-01,
            8.5693e-02,  1.9312e-01],
          [ 2.7808e-01,  4.7632e-01,  3.7671e-01,  ...,  2.4243e-01,
            5.1855e-01,  5.3174e-01],
          ...,
          [ 4.7119e-01,  4.7852e-01,  8.2227e-01,  ...,  2.5146e-01,
            5.1880e-02,  4.4971e-01],
          [ 2.7490e-01,  3.0908e-01,  2.0386e-01,  ...,  1.4038e-01,
           -1.7285e-01,  5.4297e-01],
          [ 4.4653e-01,  3.7646e-01,  4.3799e-01,  ...,  2.4902e-01,
            4.5361e-01,  4.2480e-01]],

         [[ 8.8989e-02,  3.0615e-01,  3.0029e-01,  ...,  3.4302e-01,
           -3.7842e-02,  2.8564e-02],
          [ 4.4482e-01,  2.9321e-01,  2.0508e-01,  ...,  2.6367e-01,
            3.3887e-01,  3.2788e-01],
          [ 4.0771e-01,  5.0781e-01,  2.2253e-01,  ...,  1.5723e-01,
            4.6924e-01,  7.2656e-01],
          ...,
          [ 6.2891e-01,  1.8994e-01,  4.9805e-01,  ...,  3.3691e-01,
            5.3516e-01,  4.5288e-01],
          [ 1.8018e-01,  2.9858e-01,  3.7769e-01,  ...,  7.0117e-01,
            1.4185e-01, -1.1304e-01],
          [ 2.3889e-01, -7.9834e-02,  2.2583e-01,  ...,  2.1729e-01,
            4.1382e-01,  5.4736e-01]],

         [[ 2.7295e-01,  5.0586e-01,  4.1919e-01,  ...,  3.8428e-01,
            1.0522e-01,  2.3730e-01],
          [ 3.7183e-01,  3.7451e-01,  1.3696e-01,  ...,  6.3477e-01,
            4.1016e-01,  7.7734e-01],
          [ 6.8457e-01,  1.3293e-01, -1.9116e-01,  ...,  2.8857e-01,
            6.0791e-02,  2.5073e-01],
          ...,
          [ 5.2734e-01,  1.0193e-01,  3.2080e-01,  ...,  2.4353e-01,
            2.3535e-01,  2.4683e-01],
          [ 2.3914e-01,  2.3047e-01,  1.2671e-01,  ...,  8.3130e-02,
            2.0508e-02,  4.9951e-01],
          [ 3.3936e-01,  2.6050e-01,  4.2407e-01,  ..., -3.1250e-02,
           -3.8818e-02,  2.7686e-01]],

         ...,

         [[ 3.1104e-01,  5.5957e-01, -3.5400e-02,  ..., -1.0767e-01,
           -3.6865e-02, -2.1509e-01],
          [ 3.5791e-01,  1.4832e-01,  1.1340e-01,  ...,  5.5762e-01,
            2.6807e-01, -6.8115e-02],
          [ 5.5713e-01,  2.7905e-01,  3.6963e-01,  ...,  2.5537e-01,
           -3.2471e-02,  4.4434e-01],
          ...,
          [ 3.5303e-01,  2.8027e-01,  5.0049e-01,  ...,  6.7920e-01,
            5.6152e-01,  4.3506e-01],
          [ 2.9126e-01,  6.8555e-01,  2.6782e-01,  ...,  3.5889e-01,
            4.4556e-01,  5.1123e-01],
          [ 1.2830e-01,  7.8809e-01,  1.6003e-01,  ...,  1.2231e-01,
            4.5801e-01,  4.4385e-01]],

         [[-6.7139e-02, -7.2998e-02,  2.0337e-01,  ...,  2.1265e-01,
            2.5928e-01, -1.6943e-01],
          [ 4.1309e-01,  4.8950e-01,  3.4082e-01,  ...,  3.8452e-01,
           -4.7119e-02,  2.9077e-01],
          [ 3.0029e-01,  3.6328e-01,  4.1235e-01,  ...,  4.3262e-01,
            4.1455e-01,  1.6602e-02],
          ...,
          [ 5.5957e-01,  3.3350e-01,  6.4648e-01,  ...,  8.0322e-02,
            4.6582e-01,  1.3232e-01],
          [ 2.9175e-01,  3.4595e-01,  3.3569e-01,  ...,  3.4424e-01,
            2.9785e-01,  5.2148e-01],
          [ 4.6265e-01,  1.9971e-01,  2.5806e-01,  ...,  2.9663e-01,
            6.1523e-01,  3.2251e-01]],

         [[ 3.3594e-01,  3.6084e-01,  5.5811e-01,  ...,  4.7607e-01,
            3.5376e-01,  3.9453e-01],
          [ 3.4644e-01,  7.3730e-02,  3.9551e-02,  ...,  1.5527e-01,
            3.4961e-01,  2.7051e-01],
          [ 6.4648e-01,  2.7661e-01,  4.8633e-01,  ...,  1.1206e-01,
            1.6321e-01,  3.1421e-01],
          ...,
          [ 3.0200e-01,  3.9087e-01,  7.0801e-03,  ...,  1.0657e-01,
            3.9136e-01,  3.0640e-01],
          [ 3.3984e-01,  6.7773e-01,  3.9990e-01,  ..., -5.6152e-02,
            1.4343e-01,  3.8330e-01],
          [ 2.8052e-01,  2.1948e-01,  4.0674e-01,  ...,  3.5352e-01,
            2.4670e-01,  2.9224e-01]]],


        [[[ 1.1353e-01,  3.5352e-01,  3.0811e-01,  ...,  3.0615e-01,
            5.7129e-01,  3.0884e-01],
          [ 2.0752e-01,  2.1826e-01,  2.3291e-01,  ..., -8.2764e-02,
            2.4353e-01,  9.4604e-02],
          [ 4.2236e-01, -5.3711e-03,  3.7451e-01,  ...,  1.3672e-02,
            3.0933e-01,  3.2690e-01],
          ...,
          [ 2.6807e-01,  5.8936e-01,  5.8008e-01,  ...,  6.3672e-01,
            2.5488e-01,  4.7583e-01],
          [-1.3428e-02,  3.1860e-01,  3.1738e-03,  ...,  2.4646e-01,
            6.5039e-01,  3.6084e-01],
          [ 3.0811e-01,  8.8745e-02,  2.4622e-01,  ...,  3.7720e-01,
            2.1069e-01,  6.7505e-02]],

         [[ 4.8755e-01,  3.7842e-01,  3.4082e-01,  ...,  3.9819e-01,
            2.2449e-01,  1.3843e-01],
          [ 4.7144e-01,  4.9316e-02,  4.9683e-01,  ...,  3.6792e-01,
            9.6924e-02,  2.7734e-01],
          [-1.4160e-01, -8.3496e-02,  4.1602e-01,  ...,  2.5806e-01,
            3.7256e-01,  3.9673e-01],
          ...,
          [ 1.7261e-01,  1.6431e-01,  2.3315e-01,  ...,  4.3311e-01,
            3.1030e-01,  5.4102e-01],
          [-7.8857e-02,  8.3252e-02,  7.2168e-01,  ..., -1.4990e-01,
            4.8779e-01,  7.1436e-01],
          [ 7.2510e-02,  1.0010e-01,  1.7847e-01,  ...,  3.9404e-01,
            3.6548e-01,  3.0737e-01]],

         [[ 5.0439e-01,  6.5039e-01,  4.4385e-01,  ...,  4.5459e-01,
            2.0337e-01,  5.8496e-01],
          [ 2.5098e-01,  1.2231e-01,  4.7998e-01,  ...,  5.7812e-01,
            9.5825e-02,  7.4561e-01],
          [ 3.9893e-01,  5.2979e-01,  4.2334e-01,  ...,  6.8506e-01,
            6.2988e-01,  2.6489e-01],
          ...,
          [ 1.5991e-01,  4.2725e-01,  3.4326e-01,  ...,  6.1133e-01,
            5.0537e-01,  3.3398e-01],
          [ 6.2842e-01,  4.7095e-01,  9.2651e-02,  ...,  3.7231e-01,
            2.4023e-01,  4.3213e-02],
          [-1.6699e-01,  2.7637e-01,  2.5537e-01,  ...,  3.1177e-01,
            3.4351e-01,  3.2251e-01]],

         ...,

         [[ 1.7090e-02,  2.6294e-01,  6.4502e-01,  ..., -2.0996e-02,
            4.4385e-01,  5.3223e-02],
          [ 3.7378e-01,  4.4873e-01,  5.6519e-02,  ...,  8.7036e-02,
            4.6387e-01,  3.1738e-01],
          [ 2.9028e-01,  4.7607e-01,  4.5728e-01,  ...,  3.6084e-01,
            2.6538e-01,  2.2656e-01],
          ...,
          [-2.3193e-02,  2.4084e-01,  5.0586e-01,  ...,  4.6533e-01,
            2.2021e-01,  7.2070e-01],
          [ 3.3789e-01,  4.4653e-01,  8.8574e-01,  ...,  2.6147e-01,
           -1.5332e-01,  4.0088e-01],
          [ 4.2236e-02,  3.6865e-01,  2.4084e-01,  ...,  2.1790e-01,
            1.9177e-01,  4.1821e-01]],

         [[-1.0181e-01,  2.3792e-01,  6.3086e-01,  ...,  3.0957e-01,
            1.1292e-01,  1.3306e-01],
          [ 2.7930e-01,  1.4807e-01, -5.8594e-03,  ...,  1.6235e-01,
            3.9648e-01,  2.9150e-01],
          [ 7.0801e-02,  2.0874e-01,  5.3125e-01,  ...,  4.5996e-01,
            2.1851e-01,  3.0859e-01],
          ...,
          [ 5.3711e-01,  3.8110e-01,  2.3792e-01,  ...,  5.6641e-01,
            5.3320e-01,  2.9883e-01],
          [ 4.5752e-01, -5.3711e-03,  3.8647e-01,  ...,  5.3320e-01,
            4.7119e-02,  5.0342e-01],
          [-1.8311e-02,  4.6826e-01,  3.3618e-01,  ...,  3.6865e-01,
            3.5010e-01,  3.8916e-01]],

         [[ 4.9390e-01,  6.3184e-01,  7.7271e-02,  ..., -5.2246e-02,
            7.6172e-01,  5.6104e-01],
          [ 2.2852e-01,  3.3496e-01,  2.7246e-01,  ...,  1.9849e-01,
            8.3862e-02,  3.7207e-01],
          [ 2.3193e-01,  4.5068e-01,  4.7754e-01,  ...,  2.6416e-01,
           -1.4404e-02,  1.1414e-01],
          ...,
          [ 2.5000e-01, -1.6870e-01,  2.7222e-01,  ...,  7.0068e-02,
            1.0022e-01,  2.4414e-02],
          [ 2.1484e-01,  4.7119e-02,  3.4009e-01,  ...,  7.1875e-01,
            5.9473e-01,  4.2139e-01],
          [ 6.4551e-01,  3.9429e-01,  2.3938e-01,  ...,  3.8672e-01,
            1.7419e-01,  2.9858e-01]]]], device='cuda:0', dtype=torch.float16,
       requires_grad=True)
abs top (1, 26, 2029, 60). Ref: -0.0009188652038574219, Triton: -0.0010862350463867188
ref:  tensor([[[[ 0.0000e+00,  0.0000e+00,  0.0000e+00,  ...,  0.0000e+00,
            0.0000e+00,  0.0000e+00],
          [ 1.9073e-03, -2.6306e-02, -4.8553e-02,  ..., -3.4576e-02,
            3.1805e-04,  2.3682e-02],
          [-1.1810e-02,  5.6572e-03, -1.2161e-02,  ...,  7.1831e-03,
            1.3351e-02, -1.4702e-02],
          ...,
          [-5.6648e-04,  5.0592e-04, -5.3072e-04,  ..., -2.1529e-04,
           -2.5558e-04,  7.5102e-04],
          [-1.3390e-03,  1.8609e-04, -5.4979e-04,  ...,  8.9788e-04,
            7.3433e-04, -4.2462e-04],
          [-1.2236e-03, -1.7090e-03,  6.6423e-04,  ..., -7.6771e-04,
            1.6136e-03, -4.1723e-04]],

         [[ 0.0000e+00,  0.0000e+00,  0.0000e+00,  ...,  0.0000e+00,
            0.0000e+00,  0.0000e+00],
          [ 2.8954e-03,  2.3331e-02, -1.0468e-02,  ...,  4.0512e-03,
           -1.8570e-02,  1.3618e-02],
          [ 7.9966e-04,  8.8835e-04,  7.5111e-03,  ...,  9.8801e-03,
           -5.1697e-02, -9.6436e-03],
          ...,
          [-2.7618e-03,  9.3818e-05,  2.1591e-03,  ..., -2.6932e-03,
           -1.9073e-03, -1.0662e-03],
          [-1.5554e-03,  1.3905e-03,  1.7462e-03,  ...,  2.7790e-03,
           -2.8496e-03, -8.9264e-04],
          [ 1.1272e-03,  1.5516e-03, -1.2293e-03,  ...,  1.8978e-03,
           -7.9203e-04, -4.0841e-04]],

         [[ 0.0000e+00,  0.0000e+00,  0.0000e+00,  ...,  0.0000e+00,
            0.0000e+00,  0.0000e+00],
          [-4.6959e-03,  1.3512e-02,  1.0292e-02,  ...,  2.4338e-02,
            1.5045e-02, -3.0869e-02],
          [-1.4137e-02, -2.7023e-02, -1.7761e-02,  ..., -5.9021e-02,
            6.7177e-03,  2.9800e-02],
          ...,
          [ 2.6226e-03,  8.0347e-04,  4.6945e-04,  ..., -8.1062e-04,
           -8.8739e-04, -2.4891e-03],
          [-9.6369e-04,  1.9569e-03,  3.7551e-04,  ...,  1.8177e-03,
           -3.8505e-05,  2.5768e-03],
          [ 1.3790e-03, -2.8477e-03,  1.3247e-03,  ...,  7.3528e-04,
           -1.2083e-03,  1.0662e-03]],

         ...,

         [[ 0.0000e+00,  0.0000e+00,  0.0000e+00,  ...,  0.0000e+00,
            0.0000e+00,  0.0000e+00],
          [ 3.9253e-03, -2.4796e-02,  6.1920e-02,  ..., -3.6652e-02,
            1.6270e-03, -1.2466e-02],
          [-4.6463e-03,  1.1702e-03,  1.7670e-02,  ..., -1.4618e-02,
            4.0955e-02,  1.1337e-02],
          ...,
          [ 7.3910e-06,  5.9938e-04, -1.3590e-03,  ..., -9.3555e-04,
            1.0996e-03, -5.2309e-04],
          [-2.5234e-03, -4.4370e-04,  1.3220e-04,  ..., -1.3924e-03,
            1.2636e-04, -4.7231e-04],
          [-2.2488e-03,  7.4244e-04, -1.6422e-03,  ...,  5.5170e-04,
           -1.0414e-03,  1.9236e-03]],

         [[ 0.0000e+00,  0.0000e+00,  0.0000e+00,  ...,  0.0000e+00,
            0.0000e+00,  0.0000e+00],
          [ 9.0576e-02, -1.8152e-01, -4.0436e-02,  ...,  6.9962e-03,
            5.8777e-02, -2.1835e-02],
          [-2.7504e-03,  5.8479e-03,  4.3411e-03,  ...,  2.0676e-03,
           -4.9133e-03,  1.7500e-03],
          ...,
          [-1.2007e-03, -5.8222e-04,  2.7966e-04,  ...,  1.5078e-03,
           -7.3969e-05, -1.1702e-03],
          [-9.9373e-04, -1.5345e-03, -7.8297e-04,  ..., -6.9284e-04,
            1.0252e-03, -4.9210e-04],
          [ 2.1400e-03, -5.1689e-04,  2.5806e-03,  ...,  1.3723e-03,
           -1.5230e-03,  9.8419e-04]],

         [[ 0.0000e+00,  0.0000e+00,  0.0000e+00,  ...,  0.0000e+00,
            0.0000e+00,  0.0000e+00],
          [-9.7122e-03, -2.9125e-03,  1.7328e-03,  ..., -1.5450e-02,
            1.6844e-04,  9.9030e-03],
          [-9.6359e-03, -2.5787e-03, -1.9913e-03,  ..., -1.5545e-03,
           -3.9101e-03, -7.6008e-04],
          ...,
          [ 3.4904e-03,  1.7548e-03, -9.4175e-06,  ..., -5.9080e-04,
            2.2354e-03,  3.2616e-04],
          [ 6.0892e-04,  3.8505e-05,  5.6267e-04,  ..., -6.3753e-04,
            1.4853e-04,  1.0328e-03],
          [-4.4048e-05,  2.4052e-03,  3.4451e-05,  ...,  1.7948e-03,
            5.8746e-04,  1.5879e-03]]],


        [[[ 0.0000e+00,  0.0000e+00,  0.0000e+00,  ...,  0.0000e+00,
            0.0000e+00,  0.0000e+00],
          [-6.1870e-05, -1.6327e-02, -1.0239e-02,  ..., -3.6499e-02,
           -3.6438e-02,  4.0680e-02],
          [-1.8173e-02, -4.1107e-02,  9.8419e-03,  ..., -1.0083e-01,
           -3.1311e-02,  3.5675e-02],
          ...,
          [ 1.8320e-03,  9.8228e-04,  5.4169e-04,  ...,  1.7462e-03,
           -5.3692e-04, -8.4209e-04],
          [-8.1599e-05,  1.3742e-03, -9.1016e-05,  ..., -2.2640e-03,
            1.7834e-04,  2.1534e-03],
          [-9.1410e-04,  1.5869e-03, -3.9959e-04,  ..., -1.6708e-03,
            1.0595e-03, -3.3188e-04]],

         [[ 0.0000e+00,  0.0000e+00,  0.0000e+00,  ...,  0.0000e+00,
            0.0000e+00,  0.0000e+00],
          [ 8.3679e-02,  2.3026e-02, -5.9601e-02,  ...,  2.6474e-02,
           -2.7428e-03, -1.1005e-01],
          [-2.6459e-02, -1.3580e-02,  1.1253e-02,  ...,  5.7640e-03,
            9.8877e-03,  3.1403e-02],
          ...,
          [ 1.4389e-04, -2.8729e-04, -2.0027e-03,  ..., -1.8797e-03,
           -3.6001e-04, -9.4366e-04],
          [ 3.4714e-04, -6.7616e-04,  4.7135e-04,  ...,  6.7139e-04,
           -1.6060e-03, -3.7956e-04],
          [ 6.7902e-04, -4.1771e-04, -2.1572e-03,  ...,  1.1034e-03,
            5.2547e-04,  1.2541e-03]],

         [[ 0.0000e+00,  0.0000e+00,  0.0000e+00,  ...,  0.0000e+00,
            0.0000e+00,  0.0000e+00],
          [-1.1292e-03,  2.6741e-03,  7.1049e-04,  ...,  1.4758e-04,
           -3.4657e-03, -9.0837e-05],
          [-4.0207e-03,  1.0460e-02,  2.3708e-03,  ...,  1.3709e-05,
           -1.3535e-02, -3.2806e-04],
          ...,
          [-1.4133e-03, -1.2312e-03, -2.0707e-04,  ..., -2.6245e-03,
           -2.6131e-04, -1.7583e-04],
          [ 2.3880e-03, -2.9812e-03, -1.9989e-03,  ...,  2.5711e-03,
            8.8453e-05, -1.6661e-03],
          [-2.7108e-04, -2.0714e-03,  3.7823e-03,  ...,  1.4038e-03,
           -1.2274e-03, -1.1599e-04]],

         ...,

         [[ 0.0000e+00,  0.0000e+00,  0.0000e+00,  ...,  0.0000e+00,
            0.0000e+00,  0.0000e+00],
          [-4.2572e-03, -2.9221e-03,  8.8739e-04,  ...,  3.0937e-03,
            4.9438e-03, -1.5831e-03],
          [-8.5526e-03, -2.9999e-02, -9.5978e-03,  ..., -3.4882e-02,
            8.6594e-03,  1.1536e-02],
          ...,
          [-3.7789e-05, -8.0442e-04, -1.3952e-03,  ..., -3.7403e-03,
           -8.0442e-04, -1.3323e-03],
          [-2.7633e-04, -4.3464e-04, -2.3687e-04,  ..., -2.8610e-04,
           -1.9913e-03,  2.0943e-03],
          [ 2.8038e-04, -2.2564e-03,  1.4029e-03,  ...,  5.6982e-04,
            1.7345e-04,  1.7557e-03]],

         [[ 0.0000e+00,  0.0000e+00,  0.0000e+00,  ...,  0.0000e+00,
            0.0000e+00,  0.0000e+00],
          [-1.7542e-01,  9.6252e-02,  2.1820e-02,  ...,  3.2532e-02,
           -1.3710e-02, -5.4840e-02],
          [ 1.2764e-02,  3.4088e-02,  9.3155e-03,  ...,  1.6388e-02,
            7.6714e-03, -6.7322e-02],
          ...,
          [ 9.3889e-04,  1.9169e-03, -3.9434e-04,  ...,  2.5082e-03,
            7.7486e-04,  4.1747e-04],
          [-2.2471e-04, -1.1940e-03, -6.5660e-04,  ..., -1.0118e-03,
           -2.2926e-03,  9.9087e-04],
          [-2.7990e-04,  2.1553e-04,  1.2684e-03,  ..., -3.8185e-03,
            4.3392e-04, -2.5415e-04]],

         [[ 0.0000e+00,  0.0000e+00,  0.0000e+00,  ...,  0.0000e+00,
            0.0000e+00,  0.0000e+00],
          [ 7.9346e-03, -1.9217e-03,  1.3794e-02,  ...,  2.3880e-03,
            6.5269e-03,  4.6616e-03],
          [-1.8219e-02, -1.3268e-02, -6.4819e-02,  ..., -5.2795e-02,
            7.2266e-02, -4.5990e-02],
          ...,
          [ 1.1463e-03,  2.2030e-04, -1.4677e-03,  ..., -1.7083e-04,
            1.2321e-03, -4.7636e-04],
          [ 1.0920e-03, -1.1921e-07,  2.0542e-03,  ...,  2.1255e-04,
            9.1887e-04, -1.3189e-03],
          [-5.0879e-04, -2.1420e-03,  4.3392e-04,  ..., -1.4009e-03,
           -7.8154e-04, -4.5466e-04]]],


        [[[ 0.0000e+00,  0.0000e+00,  0.0000e+00,  ...,  0.0000e+00,
            0.0000e+00,  0.0000e+00],
          [-9.6178e-04, -4.3917e-04, -2.4772e-04,  ...,  4.1771e-04,
           -7.4387e-04, -4.6992e-04],
          [ 4.8157e-02,  2.1622e-02,  1.2497e-02,  ..., -1.9363e-02,
            3.6774e-02,  2.2186e-02],
          ...,
          [ 1.4610e-03,  3.5453e-04, -7.2861e-04,  ...,  1.3962e-03,
            6.9761e-04, -5.8079e-04],
          [-6.8188e-04,  1.2398e-03, -9.1791e-04,  ...,  1.0138e-03,
            2.0790e-03,  2.8515e-04],
          [ 3.5248e-03, -1.7662e-03, -2.3346e-03,  ...,  8.7082e-05,
            4.1533e-04,  2.7504e-03]],

         [[ 0.0000e+00,  0.0000e+00,  0.0000e+00,  ...,  0.0000e+00,
            0.0000e+00,  0.0000e+00],
          [ 3.5614e-02, -2.1133e-02,  1.5900e-02,  ..., -3.1433e-02,
            5.6427e-02, -2.2583e-02],
          [-1.7242e-02,  1.3496e-02,  2.7466e-02,  ...,  3.9554e-04,
           -3.1738e-02, -3.0289e-02],
          ...,
          [ 1.8559e-03, -4.3449e-03,  4.5609e-04,  ...,  1.2102e-03,
           -1.2579e-03,  7.3385e-04],
          [-4.9400e-04, -1.0395e-03, -4.4608e-04,  ...,  1.3781e-03,
            1.9665e-03,  1.0335e-04],
          [ 4.5371e-04, -1.6108e-03,  1.8158e-03,  ...,  1.0866e-04,
            1.7099e-03,  3.8671e-04]],

         [[ 0.0000e+00,  0.0000e+00,  0.0000e+00,  ...,  0.0000e+00,
            0.0000e+00,  0.0000e+00],
          [ 1.4381e-03, -1.7910e-03, -8.0299e-04,  ..., -3.1567e-03,
            9.6369e-04,  7.6752e-03],
          [ 3.8239e-02,  2.8305e-02, -1.2108e-02,  ...,  6.2704e-04,
           -3.5095e-02,  1.8723e-02],
          ...,
          [ 4.8280e-04,  1.6012e-03,  1.3304e-03,  ..., -1.7548e-04,
           -1.0843e-03,  2.4109e-03],
          [-3.3627e-03, -1.6189e-04,  1.7481e-03,  ..., -2.8324e-03,
           -1.2894e-03,  5.7697e-05],
          [ 5.0020e-04, -1.8082e-03,  4.0102e-04,  ..., -2.0099e-04,
            1.2550e-03, -3.1710e-04]],

         ...,

         [[ 0.0000e+00,  0.0000e+00,  0.0000e+00,  ...,  0.0000e+00,
            0.0000e+00,  0.0000e+00],
          [ 2.0828e-02, -7.5226e-03, -1.7014e-02,  ...,  1.6623e-03,
           -1.1597e-02,  6.9046e-03],
          [-4.4922e-02, -1.9470e-02,  1.7944e-02,  ..., -4.9408e-02,
            2.8900e-02,  4.0817e-04],
          ...,
          [-2.0962e-03,  1.1606e-03, -1.9321e-03,  ..., -1.2197e-03,
           -2.1706e-03, -1.9073e-03],
          [-2.0599e-04, -6.1655e-04,  2.1400e-03,  ...,  1.1940e-03,
            2.1095e-03, -1.9741e-03],
          [ 2.5539e-03, -8.0681e-04,  4.4537e-04,  ..., -4.1223e-04,
            3.3607e-03, -1.7433e-03]],

         [[ 0.0000e+00,  0.0000e+00,  0.0000e+00,  ...,  0.0000e+00,
            0.0000e+00,  0.0000e+00],
          [ 8.8272e-03, -3.3447e-02, -3.1342e-02,  ...,  2.5043e-03,
           -9.9411e-03,  6.9122e-03],
          [-1.9699e-02,  6.7749e-02,  5.0568e-02,  ..., -9.2392e-03,
            1.3283e-02, -1.1940e-02],
          ...,
          [-5.4026e-04,  3.3302e-03,  1.7595e-03,  ...,  1.1597e-03,
            1.4725e-03,  2.2125e-03],
          [-1.0073e-04,  1.5640e-03,  9.7561e-04,  ..., -8.1015e-04,
            3.8767e-04,  7.3290e-04],
          [ 1.2131e-03, -1.2798e-03,  8.9025e-04,  ...,  2.7251e-04,
           -1.6975e-04, -1.4591e-03]],

         [[ 0.0000e+00,  0.0000e+00,  0.0000e+00,  ...,  0.0000e+00,
            0.0000e+00,  0.0000e+00],
          [ 6.7101e-03, -1.8921e-02,  5.4718e-02,  ...,  2.5314e-02,
            2.6794e-02, -2.7649e-02],
          [ 1.4801e-02,  1.5717e-03, -5.6458e-02,  ..., -2.0187e-02,
           -2.1912e-02,  1.0994e-02],
          ...,
          [ 1.0271e-03, -1.6224e-04, -2.2221e-03,  ..., -1.2589e-03,
            1.8520e-03,  1.3466e-03],
          [ 1.2321e-03, -8.8549e-04,  1.1797e-03,  ...,  1.4436e-04,
            3.5667e-03, -3.2949e-04],
          [-8.2016e-05,  1.2045e-03, -1.5078e-03,  ..., -2.3651e-03,
            2.3956e-03,  2.7084e-04]]],


        [[[ 0.0000e+00,  0.0000e+00,  0.0000e+00,  ...,  0.0000e+00,
            0.0000e+00,  0.0000e+00],
          [-6.6833e-02, -1.2955e-02, -5.6396e-02,  ...,  2.3407e-02,
            2.9587e-02, -4.6661e-02],
          [-4.6120e-03, -7.6103e-04, -2.2030e-03,  ...,  2.2717e-03,
            6.2990e-04, -1.7033e-03],
          ...,
          [-9.4175e-04,  1.8826e-03,  8.1301e-04,  ..., -1.1277e-04,
            7.7295e-04, -1.4524e-03],
          [ 1.4019e-03, -1.3256e-03, -3.1738e-03,  ...,  2.3594e-03,
            7.9536e-04,  2.5978e-03],
          [ 2.4140e-04,  1.3666e-03, -1.3628e-03,  ...,  2.2709e-04,
            1.1425e-03, -2.0905e-03]],

         [[ 0.0000e+00,  0.0000e+00,  0.0000e+00,  ...,  0.0000e+00,
            0.0000e+00,  0.0000e+00],
          [-4.8340e-02, -3.7720e-02, -2.3010e-02,  ...,  1.6928e-03,
            8.2245e-03,  6.4209e-02],
          [-1.0025e-02,  2.7847e-02,  3.9649e-04,  ...,  7.7362e-03,
           -1.2131e-02, -8.5831e-03],
          ...,
          [-1.0490e-03,  3.6073e-04,  5.7030e-04,  ..., -1.9007e-03,
           -1.1522e-04, -1.7872e-03],
          [ 9.8705e-04,  2.3232e-03, -1.7424e-03,  ...,  1.7281e-03,
            2.4533e-04,  3.0708e-03],
          [ 1.5950e-04,  3.6488e-03,  1.7290e-03,  ..., -9.1887e-04,
            1.4448e-03,  1.1082e-03]],

         [[ 0.0000e+00,  0.0000e+00,  0.0000e+00,  ...,  0.0000e+00,
            0.0000e+00,  0.0000e+00],
          [-4.6326e-02, -1.9882e-02, -5.1918e-03,  ..., -3.3703e-03,
           -6.8245e-03,  4.0131e-02],
          [-1.4038e-02, -6.3782e-03, -2.9449e-03,  ..., -7.2432e-04,
           -2.4242e-03,  1.1269e-02],
          ...,
          [-1.2493e-03, -7.2145e-04, -2.2011e-03,  ..., -2.1515e-03,
           -3.1805e-04,  1.3161e-03],
          [ 2.5845e-04,  8.7452e-04,  2.2278e-03,  ..., -5.2786e-04,
            5.8603e-04,  8.0252e-04],
          [ 7.3481e-04, -2.7046e-03, -6.4230e-04,  ..., -1.0681e-03,
           -5.2786e-04,  1.5278e-03]],

         ...,

         [[ 0.0000e+00,  0.0000e+00,  0.0000e+00,  ...,  0.0000e+00,
            0.0000e+00,  0.0000e+00],
          [ 2.9205e-02, -6.3515e-04, -5.1041e-03,  ..., -9.8953e-03,
           -1.3084e-02, -2.2675e-02],
          [ 1.1703e-02, -7.6828e-03,  4.7035e-03,  ..., -3.3356e-02,
            1.0544e-02, -3.8666e-02],
          ...,
          [ 4.4918e-04,  1.0710e-03, -6.5708e-04,  ..., -2.3699e-04,
            4.6563e-04,  1.3762e-03],
          [-1.2989e-03,  7.2289e-04, -1.9419e-04,  ...,  2.7714e-03,
            4.2176e-04, -5.3942e-05],
          [ 1.6632e-03,  3.4761e-04,  9.0218e-04,  ...,  2.8534e-03,
           -1.5259e-03,  5.4789e-04]],

         [[ 0.0000e+00,  0.0000e+00,  0.0000e+00,  ...,  0.0000e+00,
            0.0000e+00,  0.0000e+00],
          [-6.5796e-02, -3.1052e-02, -2.7054e-02,  ..., -2.6718e-02,
            7.1182e-03, -2.3895e-02],
          [-1.6754e-02, -4.0665e-03,  9.6283e-03,  ..., -6.3286e-03,
            8.9951e-03,  4.4518e-03],
          ...,
          [ 1.0977e-03,  1.9760e-03,  7.8821e-04,  ..., -5.3310e-04,
           -1.2636e-03, -1.2932e-03],
          [-4.3488e-03,  8.5211e-04,  1.8816e-03,  ...,  1.5163e-03,
            7.0190e-04,  1.1480e-04],
          [ 6.9284e-04,  4.9162e-04, -3.0003e-03,  ..., -2.7790e-03,
            4.0078e-04,  8.1873e-04]],

         [[ 0.0000e+00,  0.0000e+00,  0.0000e+00,  ...,  0.0000e+00,
            0.0000e+00,  0.0000e+00],
          [-2.4139e-02,  3.1097e-02,  2.5970e-02,  ...,  2.6382e-02,
           -2.6657e-02, -2.6627e-02],
          [-4.1809e-03,  2.4242e-03,  4.0283e-03,  ...,  3.7403e-03,
           -3.9787e-03, -4.5738e-03],
          ...,
          [-1.5855e-05,  1.6129e-04, -2.5177e-03,  ..., -1.9779e-03,
            1.8129e-03, -1.7681e-03],
          [-1.3828e-04, -9.1314e-04, -1.3762e-03,  ...,  2.7161e-03,
           -7.1287e-05, -6.9141e-06],
          [ 5.2786e-04,  1.4372e-03,  5.0485e-05,  ..., -6.7759e-04,
            2.4605e-03,  2.3878e-04]]]], device='cuda:0', dtype=torch.float16)
triton:  tensor([[[[ 0.0000e+00,  0.0000e+00,  0.0000e+00,  ...,  0.0000e+00,
            0.0000e+00,  0.0000e+00],
          [ 1.8330e-03, -2.6321e-02, -4.8584e-02,  ..., -3.4607e-02,
            2.8276e-04,  2.3651e-02],
          [-1.1742e-02,  5.6648e-03, -1.2138e-02,  ...,  7.2021e-03,
            1.3382e-02, -1.4664e-02],
          ...,
          [-3.8509e-03, -2.9678e-03, -3.9558e-03,  ..., -3.6144e-03,
           -3.5820e-03, -2.6207e-03],
          [ 3.2139e-03,  4.7989e-03,  3.9711e-03,  ...,  5.5580e-03,
            5.0468e-03,  4.1008e-03],
          [ 3.2067e-04, -1.6499e-04,  2.1667e-03,  ...,  6.9332e-04,
            3.1242e-03,  1.1339e-03]],

         [[ 0.0000e+00,  0.0000e+00,  0.0000e+00,  ...,  0.0000e+00,
            0.0000e+00,  0.0000e+00],
          [ 2.8934e-03,  2.3315e-02, -1.0460e-02,  ...,  4.0474e-03,
           -1.8555e-02,  1.3603e-02],
          [ 8.0967e-04,  8.9741e-04,  7.5188e-03,  ...,  9.8877e-03,
           -5.1697e-02, -9.6283e-03],
          ...,
          [-1.8299e-04,  2.8725e-03,  4.8485e-03,  ...,  9.3877e-05,
            9.3651e-04,  1.7147e-03],
          [-4.5090e-03, -1.7548e-03, -1.3294e-03,  ..., -4.6682e-04,
           -5.9967e-03, -4.0817e-03],
          [-4.3917e-04, -7.0810e-05, -2.8248e-03,  ...,  2.6751e-04,
           -2.4071e-03, -1.9436e-03]],

         [[ 0.0000e+00,  0.0000e+00,  0.0000e+00,  ...,  0.0000e+00,
            0.0000e+00,  0.0000e+00],
          [-4.5929e-03,  1.3649e-02,  1.0406e-02,  ...,  2.4490e-02,
            1.5091e-02, -3.0746e-02],
          [-1.4053e-02, -2.6886e-02, -1.7639e-02,  ..., -5.8899e-02,
            6.8169e-03,  2.9922e-02],
          ...,
          [-5.2309e-04, -2.4395e-03, -2.6703e-03,  ..., -3.7460e-03,
           -3.9711e-03, -5.7449e-03],
          [-6.6299e-03, -3.7155e-03, -5.3520e-03,  ..., -3.7708e-03,
           -5.6267e-03, -3.2711e-03],
          [ 6.3057e-03,  2.2678e-03,  6.2675e-03,  ...,  5.5847e-03,
            3.8338e-03,  6.1836e-03]],

         ...,

         [[ 0.0000e+00,  0.0000e+00,  0.0000e+00,  ...,  0.0000e+00,
            0.0000e+00,  0.0000e+00],
          [ 3.8967e-03, -2.4811e-02,  6.1890e-02,  ..., -3.6682e-02,
            1.5802e-03, -1.2497e-02],
          [-4.7379e-03,  1.0729e-03,  1.7609e-02,  ..., -1.4687e-02,
            4.0863e-02,  1.1246e-02],
          ...,
          [-1.3704e-03, -1.0099e-03, -2.7752e-03,  ..., -2.3842e-03,
           -3.2377e-04, -1.9951e-03],
          [ 2.5749e-03,  4.6082e-03,  5.0011e-03,  ...,  3.5839e-03,
            5.0964e-03,  4.4975e-03],
          [-6.8932e-03, -4.1008e-03, -6.3133e-03,  ..., -4.0894e-03,
           -5.8403e-03, -2.8763e-03]],

         [[ 0.0000e+00,  0.0000e+00,  0.0000e+00,  ...,  0.0000e+00,
            0.0000e+00,  0.0000e+00],
          [ 9.0454e-02, -1.8152e-01, -4.0558e-02,  ...,  6.9389e-03,
            5.8624e-02, -2.1912e-02],
          [-2.6817e-03,  5.9013e-03,  4.4327e-03,  ...,  2.1248e-03,
           -4.8523e-03,  1.8072e-03],
          ...,
          [-1.8091e-03, -1.3523e-03, -4.0436e-04,  ...,  7.7820e-04,
           -7.6342e-04, -1.9178e-03],
          [-3.6774e-03, -4.2953e-03, -3.3054e-03,  ..., -3.2864e-03,
           -1.7080e-03, -3.2558e-03],
          [-3.6087e-03, -6.3972e-03, -3.1719e-03,  ..., -4.3259e-03,
           -7.1793e-03, -4.5853e-03]],

         [[ 0.0000e+00,  0.0000e+00,  0.0000e+00,  ...,  0.0000e+00,
            0.0000e+00,  0.0000e+00],
          [-9.7122e-03, -2.9259e-03,  1.7157e-03,  ..., -1.5450e-02,
            1.5235e-04,  9.8801e-03],
          [-9.6436e-03, -2.5806e-03, -1.9913e-03,  ..., -1.5621e-03,
           -3.9101e-03, -7.5531e-04],
          ...,
          [ 3.8033e-03,  2.0180e-03,  2.9731e-04,  ..., -2.8729e-04,
            2.4948e-03,  6.5184e-04],
          [-1.3657e-03, -1.6880e-03, -1.4057e-03,  ..., -2.4719e-03,
           -1.6260e-03, -9.0218e-04],
          [-1.2290e-04,  2.4948e-03,  1.0026e-04,  ...,  1.8921e-03,
            6.1798e-04,  1.6079e-03]]],


        [[[ 0.0000e+00,  0.0000e+00,  0.0000e+00,  ...,  0.0000e+00,
            0.0000e+00,  0.0000e+00],
          [ 1.2577e-05, -1.6235e-02, -1.0139e-02,  ..., -3.6407e-02,
           -3.6377e-02,  4.0771e-02],
          [-1.8188e-02, -4.1107e-02,  9.8114e-03,  ..., -1.0077e-01,
           -3.1311e-02,  3.5645e-02],
          ...,
          [-2.1210e-03, -2.6321e-03, -3.3436e-03,  ..., -2.0142e-03,
           -4.3869e-03, -4.6387e-03],
          [ 4.1103e-04,  1.9932e-03,  4.0650e-04,  ..., -1.6956e-03,
            7.1144e-04,  2.7657e-03],
          [ 1.0815e-03,  3.5477e-03,  1.5793e-03,  ...,  2.9683e-04,
            2.9621e-03,  1.7300e-03]],

         [[ 0.0000e+00,  0.0000e+00,  0.0000e+00,  ...,  0.0000e+00,
            0.0000e+00,  0.0000e+00],
          [ 8.3679e-02,  2.3026e-02, -5.9601e-02,  ...,  2.6474e-02,
           -2.7428e-03, -1.1005e-01],
          [-2.6520e-02, -1.3626e-02,  1.1200e-02,  ...,  5.6915e-03,
            9.7885e-03,  3.1281e-02],
          ...,
          [ 1.1206e-03,  7.3528e-04, -9.7942e-04,  ..., -8.7786e-04,
            5.8222e-04,  2.4796e-05],
          [-1.0967e-03, -2.1477e-03, -1.0748e-03,  ..., -8.9741e-04,
           -3.1376e-03, -1.8244e-03],
          [ 2.0657e-03,  1.0595e-03, -7.2479e-04,  ...,  2.5787e-03,
            1.9503e-03,  2.7618e-03]],

         [[ 0.0000e+00,  0.0000e+00,  0.0000e+00,  ...,  0.0000e+00,
            0.0000e+00,  0.0000e+00],
          [-1.0643e-03,  2.7084e-03,  7.3338e-04,  ...,  1.7619e-04,
           -3.4370e-03, -5.6446e-05],
          [-3.8986e-03,  1.0529e-02,  2.4376e-03,  ...,  1.0014e-04,
           -1.3466e-02, -2.5630e-04],
          ...,
          [ 2.7161e-03,  3.2558e-03,  4.3335e-03,  ...,  1.7815e-03,
            4.1618e-03,  4.2610e-03],
          [ 2.2106e-03, -3.2463e-03, -2.2087e-03,  ...,  2.3518e-03,
           -1.8406e-04, -1.8730e-03],
          [-3.8109e-03, -5.7831e-03,  1.9169e-04,  ..., -2.1725e-03,
           -4.9667e-03, -3.6583e-03]],

         ...,

         [[ 0.0000e+00,  0.0000e+00,  0.0000e+00,  ...,  0.0000e+00,
            0.0000e+00,  0.0000e+00],
          [-4.1618e-03, -2.7943e-03,  9.9182e-04,  ...,  3.2253e-03,
            5.0621e-03, -1.5411e-03],
          [-8.4915e-03, -2.9938e-02, -9.5520e-03,  ..., -3.4851e-02,
            8.7128e-03,  1.1574e-02],
          ...,
          [ 3.6049e-03,  2.8400e-03,  2.1572e-03,  ..., -1.3399e-04,
            2.8572e-03,  2.2793e-03],
          [ 2.4204e-03,  2.3861e-03,  2.4662e-03,  ...,  2.5330e-03,
            8.1348e-04,  4.9057e-03],
          [-1.2410e-04, -2.5978e-03,  9.9754e-04,  ...,  3.1590e-05,
           -2.2221e-04,  1.4057e-03]],

         [[ 0.0000e+00,  0.0000e+00,  0.0000e+00,  ...,  0.0000e+00,
            0.0000e+00,  0.0000e+00],
          [-1.7529e-01,  9.6252e-02,  2.1866e-02,  ...,  3.2562e-02,
           -1.3649e-02, -5.4718e-02],
          [ 1.2764e-02,  3.4058e-02,  9.3002e-03,  ...,  1.6373e-02,
            7.6599e-03, -6.7322e-02],
          ...,
          [ 7.0801e-03,  8.1635e-03,  5.8632e-03,  ...,  8.5449e-03,
            6.9656e-03,  6.6261e-03],
          [ 2.0809e-03,  1.0376e-03,  1.7052e-03,  ...,  1.3447e-03,
            2.7955e-05,  3.3722e-03],
          [ 6.0234e-03,  6.5918e-03,  7.5111e-03,  ...,  2.4395e-03,
            6.8474e-03,  6.2447e-03]],

         [[ 0.0000e+00,  0.0000e+00,  0.0000e+00,  ...,  0.0000e+00,
            0.0000e+00,  0.0000e+00],
          [ 7.9422e-03, -1.8606e-03,  1.3802e-02,  ...,  2.4033e-03,
            6.5727e-03,  4.7035e-03],
          [-1.8173e-02, -1.3184e-02, -6.4758e-02,  ..., -5.2765e-02,
            7.2327e-02, -4.5929e-02],
          ...,
          [ 3.0937e-03,  2.0828e-03,  4.6182e-04,  ...,  1.7481e-03,
            3.1033e-03,  1.4296e-03],
          [-1.0997e-04, -1.1663e-03,  7.9393e-04,  ..., -9.5415e-04,
           -4.3917e-04, -2.4910e-03],
          [-2.5425e-03, -4.1618e-03, -1.5841e-03,  ..., -3.3951e-03,
           -2.8839e-03, -2.4300e-03]]],


        [[[ 0.0000e+00,  0.0000e+00,  0.0000e+00,  ...,  0.0000e+00,
            0.0000e+00,  0.0000e+00],
          [-1.0233e-03, -4.9496e-04, -3.1257e-04,  ...,  3.7670e-04,
           -8.0442e-04, -5.0688e-04],
          [ 4.8187e-02,  2.1652e-02,  1.2543e-02,  ..., -1.9287e-02,
            3.6804e-02,  2.2202e-02],
          ...,
          [ 3.7365e-03,  2.7237e-03,  1.5297e-03,  ...,  3.7270e-03,
            3.1052e-03,  1.6470e-03],
          [ 2.7680e-04,  2.3441e-03,  1.1909e-04,  ...,  2.0142e-03,
            3.1338e-03,  1.2970e-03],
          [ 6.5384e-03,  1.1454e-03,  6.2990e-04,  ...,  3.1700e-03,
            3.4122e-03,  5.7716e-03]],

         [[ 0.0000e+00,  0.0000e+00,  0.0000e+00,  ...,  0.0000e+00,
            0.0000e+00,  0.0000e+00],
          [ 3.5553e-02, -2.1179e-02,  1.5823e-02,  ..., -3.1555e-02,
            5.6244e-02, -2.2659e-02],
          [-1.7181e-02,  1.3527e-02,  2.7557e-02,  ...,  4.6206e-04,
           -3.1555e-02, -3.0273e-02],
          ...,
          [ 2.6245e-03, -3.6259e-03,  1.3437e-03,  ...,  2.0618e-03,
           -4.7469e-04,  1.5516e-03],
          [-3.1090e-03, -3.6106e-03, -3.1605e-03,  ..., -1.1311e-03,
           -5.7650e-04, -2.3994e-03],
          [ 3.5648e-03,  1.6146e-03,  5.1880e-03,  ...,  3.1567e-03,
            4.9248e-03,  3.5629e-03]],

         [[ 0.0000e+00,  0.0000e+00,  0.0000e+00,  ...,  0.0000e+00,
            0.0000e+00,  0.0000e+00],
          [ 1.4219e-03, -1.8215e-03, -8.6212e-04,  ..., -3.1872e-03,
            9.2268e-04,  7.6408e-03],
          [ 3.8177e-02,  2.8229e-02, -1.2222e-02,  ...,  5.6410e-04,
           -3.5156e-02,  1.8646e-02],
          ...,
          [ 5.5275e-03,  6.6795e-03,  6.1836e-03,  ...,  4.8599e-03,
            3.9253e-03,  7.2174e-03],
          [-5.9662e-03, -2.9850e-03, -7.1859e-04,  ..., -5.4779e-03,
           -4.0283e-03, -2.6264e-03],
          [ 3.8242e-03,  1.4811e-03,  3.6049e-03,  ...,  3.0308e-03,
            4.6463e-03,  3.0041e-03]],

         ...,

         [[ 0.0000e+00,  0.0000e+00,  0.0000e+00,  ...,  0.0000e+00,
            0.0000e+00,  0.0000e+00],
          [ 2.0813e-02, -7.5188e-03, -1.7014e-02,  ...,  1.6613e-03,
           -1.1589e-02,  6.9008e-03],
          [-4.4891e-02, -1.9424e-02,  1.8021e-02,  ..., -4.9377e-02,
            2.8976e-02,  4.9162e-04],
          ...,
          [-3.5400e-03, -1.7381e-04, -3.3627e-03,  ..., -2.6150e-03,
           -3.5419e-03, -3.4351e-03],
          [ 4.3564e-03,  3.8338e-03,  6.6948e-03,  ...,  5.7335e-03,
            6.8398e-03,  2.4357e-03],
          [ 3.2673e-03, -5.5015e-05,  1.0996e-03,  ...,  1.8585e-04,
            4.0092e-03, -1.1234e-03]],

         [[ 0.0000e+00,  0.0000e+00,  0.0000e+00,  ...,  0.0000e+00,
            0.0000e+00,  0.0000e+00],
          [ 8.8120e-03, -3.3386e-02, -3.1311e-02,  ...,  2.5005e-03,
           -9.9258e-03,  6.9046e-03],
          [-1.9791e-02,  6.7627e-02,  5.0476e-02,  ..., -9.4070e-03,
            1.3145e-02, -1.2077e-02],
          ...,
          [-2.9697e-03,  8.3447e-04, -7.2861e-04,  ..., -1.2703e-03,
           -9.4128e-04, -2.0397e-04],
          [ 5.4836e-06,  1.7433e-03,  1.1292e-03,  ..., -6.2752e-04,
            5.0306e-04,  9.7132e-04],
          [ 1.6603e-03, -6.2513e-04,  1.4496e-03,  ...,  8.9884e-04,
            4.4012e-04, -8.9216e-04]],

         [[ 0.0000e+00,  0.0000e+00,  0.0000e+00,  ...,  0.0000e+00,
            0.0000e+00,  0.0000e+00],
          [ 6.8169e-03, -1.8875e-02,  5.4749e-02,  ...,  2.5421e-02,
            2.6871e-02, -2.7603e-02],
          [ 1.4709e-02,  1.5030e-03, -5.6549e-02,  ..., -2.0325e-02,
           -2.2034e-02,  1.0948e-02],
          ...,
          [ 1.7500e-04, -1.0490e-03, -3.0174e-03,  ..., -2.0428e-03,
            1.1110e-03,  5.1546e-04],
          [ 4.6310e-03,  2.7027e-03,  4.5166e-03,  ...,  3.5400e-03,
            7.1259e-03,  3.1624e-03],
          [-1.8091e-03, -5.2881e-04, -3.1872e-03,  ..., -4.0016e-03,
            5.6171e-04, -1.4648e-03]]],


        [[[ 0.0000e+00,  0.0000e+00,  0.0000e+00,  ...,  0.0000e+00,
            0.0000e+00,  0.0000e+00],
          [-6.6833e-02, -1.3008e-02, -5.6427e-02,  ...,  2.3376e-02,
            2.9526e-02, -4.6692e-02],
          [-4.6692e-03, -8.5306e-04, -2.2984e-03,  ...,  2.2125e-03,
            5.6505e-04, -1.7710e-03],
          ...,
          [-8.8882e-04,  1.9493e-03,  8.5497e-04,  ..., -1.4949e-04,
            8.3399e-04, -1.4915e-03],
          [ 4.4560e-04, -2.3518e-03, -4.1428e-03,  ...,  1.3752e-03,
           -1.0872e-04,  1.6832e-03],
          [-1.4353e-03, -2.8014e-04, -2.8534e-03,  ..., -1.3762e-03,
           -4.2582e-04, -3.6964e-03]],

         [[ 0.0000e+00,  0.0000e+00,  0.0000e+00,  ...,  0.0000e+00,
            0.0000e+00,  0.0000e+00],
          [-4.8309e-02, -3.7720e-02, -2.2980e-02,  ...,  1.7147e-03,
            8.2626e-03,  6.4270e-02],
          [-1.0048e-02,  2.7817e-02,  3.7432e-04,  ...,  7.7133e-03,
           -1.2154e-02, -8.6060e-03],
          ...,
          [-3.6011e-03, -2.2545e-03, -2.0523e-03,  ..., -4.3335e-03,
           -2.5845e-03, -4.2877e-03],
          [ 1.9875e-03,  3.3360e-03, -6.6566e-04,  ...,  2.7866e-03,
            1.2989e-03,  4.1161e-03],
          [-5.0545e-03, -1.6823e-03, -3.4218e-03,  ..., -6.0883e-03,
           -3.6850e-03, -4.1466e-03]],

         [[ 0.0000e+00,  0.0000e+00,  0.0000e+00,  ...,  0.0000e+00,
            0.0000e+00,  0.0000e+00],
          [-4.6326e-02, -1.9913e-02, -5.2376e-03,  ..., -3.4313e-03,
           -6.8893e-03,  4.0100e-02],
          [-1.4084e-02, -6.4125e-03, -2.9964e-03,  ..., -7.8249e-04,
           -2.4910e-03,  1.1253e-02],
          ...,
          [-5.8708e-03, -5.3253e-03, -6.6719e-03,  ..., -6.7177e-03,
           -4.7874e-03, -3.2177e-03],
          [ 2.2018e-04,  8.8024e-04,  2.2163e-03,  ..., -5.8270e-04,
            4.8494e-04,  7.1001e-04],
          [ 1.4963e-03, -1.9512e-03,  9.7930e-05,  ..., -3.1567e-04,
            2.6011e-04,  2.3460e-03]],

         ...,

         [[ 0.0000e+00,  0.0000e+00,  0.0000e+00,  ...,  0.0000e+00,
            0.0000e+00,  0.0000e+00],
          [ 2.9297e-02, -5.5170e-04, -4.9858e-03,  ..., -9.7580e-03,
           -1.3016e-02, -2.2568e-02],
          [ 1.1673e-02, -7.7019e-03,  4.6806e-03,  ..., -3.3386e-02,
            1.0536e-02, -3.8666e-02],
          ...,
          [-2.5082e-03, -1.9054e-03, -3.7708e-03,  ..., -3.0346e-03,
           -2.6989e-03, -1.5116e-03],
          [ 8.4257e-04,  3.0670e-03,  2.2564e-03,  ...,  5.2185e-03,
            2.8439e-03,  2.2755e-03],
          [ 3.9978e-03,  2.7847e-03,  3.3474e-03,  ...,  5.3596e-03,
            8.6403e-04,  2.8076e-03]],

         [[ 0.0000e+00,  0.0000e+00,  0.0000e+00,  ...,  0.0000e+00,
            0.0000e+00,  0.0000e+00],
          [-6.5796e-02, -3.1052e-02, -2.7054e-02,  ..., -2.6718e-02,
            7.1182e-03, -2.3895e-02],
          [-1.6754e-02, -4.0588e-03,  9.6130e-03,  ..., -6.3210e-03,
            9.0027e-03,  4.4441e-03],
          ...,
          [ 1.8358e-03,  2.6379e-03,  1.5402e-03,  ...,  2.1684e-04,
           -5.1737e-04, -6.5041e-04],
          [-5.5847e-03, -4.2129e-04,  5.6791e-04,  ...,  2.6727e-04,
           -5.3644e-04, -1.1692e-03],
          [-9.3460e-04, -1.1854e-03, -4.6425e-03,  ..., -4.3983e-03,
           -1.1549e-03, -8.6689e-04]],

         [[ 0.0000e+00,  0.0000e+00,  0.0000e+00,  ...,  0.0000e+00,
            0.0000e+00,  0.0000e+00],
          [-2.4033e-02,  3.1250e-02,  2.6199e-02,  ...,  2.6443e-02,
           -2.6489e-02, -2.6550e-02],
          [-4.2000e-03,  2.3956e-03,  4.0131e-03,  ...,  3.7365e-03,
           -3.9978e-03, -4.5929e-03],
          ...,
          [ 1.5469e-03,  1.5974e-03, -1.0643e-03,  ..., -3.7599e-04,
            3.2997e-03, -3.9864e-04],
          [ 7.0343e-03,  6.2790e-03,  5.4588e-03,  ...,  9.6664e-03,
            6.8703e-03,  7.0992e-03],
          [ 5.1022e-04,  1.4563e-03,  1.4210e-04,  ..., -6.9332e-04,
            2.4796e-03,  2.0671e-04]]]], device='cuda:0', dtype=torch.float16)
F

=================================== FAILURES ===================================
____________________________ test_op[4-48-2048-64] _____________________________

Z = 4, H = 48, N_CTX = 2048, D_HEAD = 64, dtype = torch.float16

    @pytest.mark.parametrize('Z, H, N_CTX, D_HEAD', [
        (4, 48, 128, 64),
        (4, 48, 256, 64),
        (4, 48, 512, 64),
        (4, 48, 1024, 64),
        (4, 48, 2048, 64),
        (4, 48, 4096, 64),
        #  (4, 48, 8192, 64), out of memory
    ])
    @pytest.mark.skipif(torch.cuda.get_device_capability()[0] < 9, reason="requires arch 9+")
    def test_op(Z, H, N_CTX, D_HEAD, dtype=torch.float16):
        g = torch.Generator(device="cpu")
        g.manual_seed(20)
        q = torch.empty((Z, H, N_CTX, D_HEAD), dtype=dtype, device="cpu").normal_(mean=0.1, std=0.2,
                                                                                   generator=g).to("cuda").requires_grad_()
        k = torch.empty((Z, H, N_CTX, D_HEAD), dtype=dtype, device="cpu").normal_(mean=0.4, std=0.2,
                                                                                   generator=g).to("cuda").requires_grad_()
        v = torch.empty((Z, H, N_CTX, D_HEAD), dtype=dtype, device="cpu").normal_(mean=0.3, std=0.2,
                                                                                   generator=g).to("cuda").requires_grad_()
        print("q input: ", q)
        print("k input: ", k)
        print("v input: ", v)
        sm_scale = 0.2
        dout = torch.randn_like(q)
        # reference implementation
        M = torch.tril(torch.ones((N_CTX, N_CTX), device="cuda"))
        p = torch.matmul(q, k.transpose(2, 3)) * sm_scale
        for z in range(Z):
            for h in range(H):
                p[:, :, M == 0] = float("-inf")
        p = torch.softmax(p.float(), dim=-1).half()
        # p = torch.exp(p)
        ref_out = torch.matmul(p, v)
        ref_out.backward(dout)
        ref_dv, v.grad = v.grad.clone(), None
        ref_dk, k.grad = k.grad.clone(), None
        ref_dq, q.grad = q.grad.clone(), None
        # triton implementation
        tri_out = attention(q, k, v, sm_scale)
        # print(ref_out)
        # print(tri_out)
        tri_out.backward(dout)
        tri_dv, v.grad = v.grad.clone(), None
        tri_dk, k.grad = k.grad.clone(), None
        tri_dq, q.grad = q.grad.clone(), None
        # compare
        torch.testing.assert_close(ref_out, tri_out, atol=1e-2, rtol=0)
        print(f"abs top (1, 26, 2029, 60). Ref: {ref_dq[1, 26, 2029, 60]}, Triton: {tri_dq[1, 26, 2029, 60]}")
        print("ref: ", ref_dq)
        print("triton: ", tri_dq)
>       torch.testing.assert_close(ref_dq, tri_dq, atol=1e-2, rtol=0)
E       AssertionError: Tensor-likes are not close!
E
E       Mismatched elements: 3047 / 25165824 (0.0%)
E       Greatest absolute difference: 0.0144805908203125 at index (2, 11, 1951, 50) (up to 0.01 allowed)
E       Greatest relative difference: 1.8818359375 at index (1, 21, 1751, 53) (up to 0 allowed)

python/test/unit/hopper/test_flashattention.py:411: AssertionError
=========================== short test summary info ============================
FAILED python/test/unit/hopper/test_flashattention.py::test_op[4-48-2048-64] - AssertionError: Tensor-likes are not close!

Mismatched elements: 3047 / 25165824 (0.0%)
Greatest absolute difference: 0.0144805908203125 at index (2, 11, 1951, 50) (up to 0.01 allowed)
Greatest relative difference: 1.8818359375 at index (1, 21, 1751, 53) (up to 0 allowed)
============================== 1 failed in 8.82s ===============================
