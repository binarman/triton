============================= test session starts ==============================
platform linux -- Python 3.9.19, pytest-7.3.2, pluggy-1.4.0
rootdir: /triton/python
plugins: shard-0.1.2, flakefinder-1.1.0, cpp-2.3.0, xdist-3.3.1, hypothesis-5.35.1, xdoctest-1.1.0, rerunfailures-14.0
collected 1 item
Running 1 items in this shard

python/test/unit/hopper/test_flashattention.py q input:  tensor([[[[ 8.4290e-02,  4.9713e-02, -1.0175e-01,  ...,  3.5645e-01,
            2.1936e-01,  1.5466e-01],
          [ 1.2733e-02,  1.5735e-01,  2.3621e-01,  ...,  2.3755e-01,
            2.3169e-01, -6.6650e-02],
          [-1.9861e-01,  1.3428e-01,  2.7130e-02,  ...,  8.7524e-02,
            2.1106e-01, -2.3743e-01],
          ...,
          [-2.8491e-01, -1.1963e-01, -5.0354e-03,  ..., -1.4417e-01,
            1.6919e-01,  2.7710e-01],
          [ 1.8909e-01,  8.7524e-02, -6.9580e-02,  ...,  1.3318e-01,
            2.1301e-01,  1.7651e-01],
          [ 1.6919e-01,  1.7471e-02,  4.3091e-01,  ..., -6.5125e-02,
            1.9519e-01,  4.3604e-01]],

         [[ 3.6896e-02,  7.4585e-02, -2.2571e-01,  ...,  2.8369e-01,
            3.9673e-02, -5.3711e-02],
          [ 2.9785e-01,  2.2156e-01,  4.4434e-02,  ...,  1.9470e-01,
            3.5669e-01,  9.1431e-02],
          [-1.8066e-01,  8.7585e-02,  2.3529e-02,  ...,  5.1636e-02,
           -2.1805e-02,  8.5815e-02],
          ...,
          [ 4.5679e-01,  1.4465e-01,  2.9346e-01,  ..., -3.5431e-02,
            9.8206e-02,  1.0120e-01],
          [ 2.4500e-01,  2.6172e-01,  4.8859e-02,  ...,  3.4644e-01,
            1.3989e-01,  8.2764e-02],
          [ 1.9312e-01,  1.6223e-01,  6.9946e-02,  ...,  5.3314e-02,
            2.4426e-01,  1.4038e-01]],

         [[ 3.5986e-01,  2.4524e-01,  6.9287e-01,  ...,  1.4978e-01,
            4.1040e-01,  2.3727e-02],
          [-5.5908e-02,  8.2397e-02,  8.1177e-02,  ..., -7.8857e-02,
            5.9387e-02,  5.1300e-02],
          [ 3.6377e-01,  1.8518e-01,  2.2961e-01,  ..., -4.4891e-02,
           -1.3123e-01, -2.6416e-01],
          ...,
          [ 2.8467e-01,  2.5049e-01,  2.1069e-01,  ..., -1.6162e-01,
            1.7749e-01,  2.5146e-01],
          [ 1.0323e-02,  6.4270e-02, -1.5710e-01,  ...,  2.1399e-01,
            2.1436e-01,  1.0089e-01],
          [ 3.1470e-01,  1.4404e-01,  3.8721e-01,  ...,  3.9893e-01,
           -4.2480e-02,  1.9241e-02]],

         ...,

         [[ 3.4473e-01,  1.9043e-01,  1.7590e-01,  ..., -5.0903e-02,
            1.3489e-01,  1.4136e-01],
          [-1.5796e-01,  2.9395e-01,  1.7041e-01,  ...,  2.8760e-01,
            3.5840e-01, -1.7120e-02],
          [ 2.1643e-01,  2.4194e-01,  2.9190e-02,  ...,  2.5537e-01,
            1.7957e-01, -4.1870e-02],
          ...,
          [-4.7089e-02,  2.4353e-01, -1.1121e-01,  ...,  2.6416e-01,
            1.2085e-01,  5.7953e-02],
          [ 2.3035e-01, -3.7170e-02,  1.8103e-01,  ...,  9.6558e-02,
            2.8369e-01, -2.2644e-01],
          [-8.4412e-02,  4.5020e-01, -1.0498e-01,  ...,  2.9077e-01,
            2.2144e-01,  9.1553e-02]],

         [[ 5.3662e-01, -4.1870e-02,  3.2837e-01,  ...,  1.7627e-01,
            6.7940e-03, -2.0554e-02],
          [ 5.6519e-02,  2.3364e-01,  1.5503e-01,  ...,  2.0020e-01,
           -2.0996e-01, -7.6355e-02],
          [ 6.7725e-01,  1.4978e-01,  1.7224e-01,  ...,  1.5161e-01,
            4.1168e-02,  2.1313e-01],
          ...,
          [ 2.2131e-01,  6.3232e-01,  1.6724e-01,  ...,  3.9404e-01,
            4.3115e-01,  1.7053e-01],
          [-6.6101e-02, -1.0187e-01,  2.7246e-01,  ..., -3.5248e-02,
            2.2534e-01,  2.7295e-01],
          [-7.6172e-02,  6.5186e-02, -1.8774e-01,  ...,  2.4097e-01,
           -2.6337e-02,  2.5195e-01]],

         [[-2.2852e-01,  2.9556e-02,  4.5837e-02,  ...,  1.9995e-01,
           -1.5701e-02, -3.6713e-02],
          [ 1.3928e-01,  6.0699e-02,  6.5918e-02,  ...,  2.5293e-01,
            1.6223e-01,  2.9858e-01],
          [ 1.8066e-02,  3.0176e-01, -3.2471e-01,  ...,  3.2104e-01,
            3.4570e-01, -3.8574e-02],
          ...,
          [ 4.1968e-01,  5.2197e-01, -2.9236e-02,  ..., -2.5848e-02,
            8.1848e-02,  1.1890e-01],
          [-1.1218e-01, -5.4413e-02, -1.2103e-01,  ..., -2.3041e-02,
            2.6758e-01,  1.4795e-01],
          [ 6.0742e-01, -1.6980e-01,  2.4805e-01,  ...,  2.5659e-01,
            3.8379e-01,  4.4141e-01]]],


        [[[ 8.7341e-02,  1.9128e-01,  8.7585e-02,  ...,  1.8567e-01,
            1.8127e-01,  1.3161e-02],
          [ 2.2705e-01,  2.1313e-01,  1.5295e-01,  ...,  1.4685e-01,
            6.4893e-01,  2.6318e-01],
          [ 3.1006e-01,  9.2773e-02,  8.0200e-02,  ..., -2.2571e-01,
            2.1500e-02,  7.7271e-02],
          ...,
          [-6.1554e-02,  3.9612e-02,  2.5513e-01,  ...,  1.5662e-01,
           -2.6932e-03,  8.5266e-02],
          [-1.0187e-01,  2.0459e-01, -1.8347e-01,  ..., -8.7814e-03,
           -4.0894e-02,  2.9297e-01],
          [-1.5671e-02,  1.3025e-01, -5.0415e-02,  ...,  2.1753e-01,
            3.7939e-01,  1.8701e-01]],

         [[ 4.4824e-01,  9.3872e-02,  2.6660e-01,  ...,  1.2292e-01,
            2.9810e-01,  1.9470e-01],
          [ 1.3016e-02,  4.3433e-01, -1.9867e-02,  ...,  1.1212e-01,
           -1.1292e-01,  5.5273e-01],
          [-7.5684e-02,  6.1157e-02,  5.6839e-03,  ...,  2.1643e-01,
            8.3130e-02,  2.3328e-01],
          ...,
          [ 1.4763e-03,  4.7192e-01,  1.0858e-01,  ..., -1.1615e-01,
           -2.3596e-01,  7.0801e-02],
          [ 1.6223e-01,  1.5967e-01,  3.6682e-02,  ...,  1.6309e-01,
            1.1566e-01, -2.3438e-02],
          [-2.9731e-04,  3.2471e-01,  1.9006e-01,  ..., -1.9250e-01,
            1.1426e-01,  2.0850e-01]],

         [[-1.9812e-01,  4.1772e-01, -2.7002e-01,  ..., -7.4158e-02,
            3.6157e-01, -8.3801e-02],
          [ 3.7939e-01, -2.5421e-02,  2.0703e-01,  ...,  2.5464e-01,
           -1.1652e-01,  3.4570e-01],
          [ 1.3489e-01, -2.5293e-01,  5.5127e-01,  ..., -3.0664e-01,
           -1.0272e-01,  1.7532e-02],
          ...,
          [ 2.2083e-01, -2.1692e-01,  2.2583e-02,  ...,  1.4868e-01,
           -4.8126e-02,  2.4646e-01],
          [ 3.2886e-01,  3.3813e-01,  3.2935e-01,  ...,  8.6517e-03,
            1.8176e-01,  1.1548e-01],
          [-3.9673e-02,  4.5581e-01, -3.9124e-02,  ...,  2.0340e-02,
            1.2372e-01,  5.6201e-01]],

         ...,

         [[ 1.0938e-01,  4.4556e-03,  1.3818e-01,  ...,  1.5344e-01,
           -5.7373e-03, -6.9031e-02],
          [ 3.2715e-01,  2.4170e-02,  1.9849e-01,  ..., -4.4525e-02,
           -4.9164e-02,  1.1554e-01],
          [ 1.9189e-01,  7.3303e-02,  3.1006e-01,  ...,  1.0883e-01,
            1.2878e-01, -1.9684e-02],
          ...,
          [ 1.7224e-01, -1.1255e-01, -5.0354e-02,  ...,  3.8025e-02,
            1.1536e-01, -3.4741e-01],
          [ 2.9099e-02,  1.9806e-02,  2.7441e-01,  ...,  1.3916e-01,
           -4.0833e-02,  1.4856e-01],
          [ 1.1887e-02,  3.2007e-01,  1.7676e-01,  ...,  6.4125e-03,
            5.9033e-01, -2.8214e-02]],

         [[ 3.0127e-01,  5.5084e-02,  5.4443e-01,  ...,  2.5000e-01,
           -1.7065e-01,  7.0007e-02],
          [ 5.7281e-02,  2.2095e-01,  1.1108e-01,  ...,  3.2043e-02,
            1.3953e-01, -8.9417e-02],
          [ 1.1273e-01,  1.7468e-01,  3.4943e-02,  ..., -3.0807e-02,
           -1.0034e-01,  4.3152e-02],
          ...,
          [ 5.2100e-01,  5.3253e-02,  9.2163e-02,  ..., -9.6130e-02,
            3.6938e-01,  1.3782e-01],
          [ 2.9321e-01, -4.0863e-02,  4.7534e-01,  ..., -3.8422e-02,
            9.1003e-02,  6.1615e-02],
          [-3.7842e-01,  3.7793e-01,  2.3572e-01,  ...,  1.4819e-01,
            3.6011e-01,  5.5469e-01]],

         [[ 1.9153e-01,  2.5711e-02,  7.9590e-02,  ..., -1.2561e-01,
            2.7710e-01,  2.7197e-01],
          [ 1.2378e-01,  2.4500e-01,  1.1633e-01,  ..., -3.1872e-03,
            1.9519e-01, -3.3966e-02],
          [ 9.3201e-02, -7.0740e-02,  1.1078e-01,  ...,  2.9099e-02,
           -1.2152e-01,  1.2561e-01],
          ...,
          [ 1.9092e-01,  4.2920e-01,  7.1228e-02,  ..., -1.6150e-01,
            5.2002e-02, -1.1497e-02],
          [ 1.7163e-01,  2.6709e-01,  3.2104e-02,  ...,  1.0352e-01,
            3.5004e-02,  1.3916e-01],
          [ 1.8806e-03, -1.9653e-02,  9.2773e-02,  ...,  2.0544e-01,
            3.1891e-02,  1.1517e-01]]],


        [[[ 2.7481e-02,  1.4618e-02,  2.8149e-01,  ...,  3.7354e-02,
           -3.6621e-02,  9.8083e-02],
          [-1.8115e-01,  1.6736e-01,  1.9702e-01,  ...,  3.1311e-02,
            3.2642e-01,  1.2744e-01],
          [ 3.3838e-01,  1.4050e-01,  2.8516e-01,  ...,  4.9023e-01,
            1.1017e-01, -7.9834e-02],
          ...,
          [ 7.5134e-02, -6.2286e-02,  4.2334e-01,  ...,  2.2314e-01,
            7.6532e-04, -1.4267e-02],
          [ 4.2603e-01,  3.8281e-01,  2.2729e-01,  ...,  5.1666e-02,
            4.1406e-01,  8.2397e-02],
          [-4.2755e-02,  4.1431e-01,  1.0352e-01,  ..., -2.0435e-01,
           -1.3635e-01,  1.5759e-01]],

         [[ 8.2397e-02, -1.1658e-01, -6.6833e-02,  ...,  1.5820e-01,
            6.3354e-02,  3.8422e-02],
          [-1.2230e-02, -1.1041e-01,  2.9370e-01,  ...,  2.8491e-01,
            1.5308e-01,  2.5098e-01],
          [-1.2067e-01, -1.3904e-01,  7.7209e-02,  ...,  4.9170e-01,
           -5.7739e-02,  3.4546e-02],
          ...,
          [ 1.7136e-02,  3.4766e-01, -3.0200e-01,  ...,  1.7380e-02,
            2.0605e-01,  2.9321e-01],
          [-2.6562e-01, -9.0149e-02, -1.2756e-01,  ...,  2.9495e-02,
            6.8283e-03,  1.2769e-01],
          [-1.3733e-01, -1.2611e-02, -8.1177e-02,  ..., -5.3131e-02,
            2.0523e-02,  4.7583e-01]],

         [[ 2.5903e-01,  8.8501e-02,  1.7444e-01,  ...,  1.7444e-01,
           -1.4392e-01,  1.4050e-01],
          [-7.0686e-03,  5.0342e-01, -2.5635e-01,  ..., -1.7529e-01,
           -3.0823e-03,  2.1509e-01],
          [ 1.2830e-01,  2.8711e-01, -8.4473e-02,  ...,  1.2402e-01,
           -4.1626e-01,  2.7466e-01],
          ...,
          [-3.0298e-01,  1.8933e-01, -8.7402e-02,  ...,  2.8833e-01,
            1.8097e-02,  3.1665e-01],
          [ 1.7456e-01,  3.5034e-01,  2.0178e-01,  ..., -2.5806e-01,
            3.3643e-01, -5.0812e-02],
          [-4.0344e-02, -2.0496e-01, -2.7832e-01,  ...,  4.1382e-01,
            1.4130e-02,  2.3499e-01]],

         ...,

         [[-1.0754e-01,  1.9092e-01, -1.2402e-01,  ...,  1.0748e-01,
           -3.7018e-02,  2.9639e-01],
          [ 1.6895e-01,  3.8788e-02, -2.6276e-02,  ...,  7.8674e-02,
           -8.0566e-02,  1.4343e-01],
          [ 3.4814e-01,  2.3438e-02,  6.0150e-02,  ...,  3.7158e-01,
            3.5327e-01, -1.2561e-01],
          ...,
          [ 1.8469e-01,  1.8323e-01, -2.8711e-01,  ..., -2.7319e-01,
            2.2949e-01, -1.0413e-01],
          [ 1.0577e-01,  7.0862e-02, -1.0382e-01,  ...,  2.7374e-02,
            3.7305e-01,  2.3120e-01],
          [-6.2103e-02, -6.5308e-02,  4.6045e-01,  ..., -2.8394e-01,
            3.2275e-01, -1.4905e-01]],

         [[-1.5979e-01,  3.9526e-01, -1.4209e-01,  ...,  7.1826e-01,
           -1.2131e-02,  1.8250e-01],
          [-9.5764e-02, -7.9346e-02, -1.0492e-01,  ...,  8.2703e-02,
            8.9355e-02,  5.2393e-01],
          [-3.8477e-01, -5.0537e-02,  3.3081e-01,  ...,  1.9080e-01,
            3.0640e-01,  2.6782e-01],
          ...,
          [ 1.1731e-01,  2.0410e-01,  2.1936e-01,  ..., -2.8076e-01,
           -4.3311e-01,  8.5266e-02],
          [-4.9805e-02, -3.6304e-01,  6.9397e-02,  ...,  3.3539e-02,
           -3.8818e-02,  4.3793e-02],
          [-4.5929e-02,  1.6577e-01,  2.2290e-01,  ...,  4.4727e-01,
           -2.6221e-01, -5.1971e-02]],

         [[ 3.2617e-01,  1.4026e-01,  4.3774e-01,  ...,  3.1250e-01,
           -2.3392e-02, -4.7180e-02],
          [-1.6003e-01,  3.3569e-02, -2.4646e-01,  ...,  3.5126e-02,
            2.4158e-01,  2.4597e-01],
          [ 2.4634e-01,  3.3154e-01,  2.8442e-01,  ...,  3.4424e-01,
           -6.2866e-02, -2.3547e-01],
          ...,
          [-1.5662e-01,  1.6736e-01, -1.3840e-02,  ..., -1.3354e-01,
            8.3862e-02, -2.4658e-02],
          [ 5.3027e-01,  1.4136e-01,  4.1382e-01,  ...,  3.2593e-01,
           -5.6824e-02,  4.4189e-01],
          [ 2.8271e-01,  2.2058e-01, -4.2267e-03,  ..., -1.7517e-02,
            1.5466e-01,  1.8152e-01]]],


        [[[ 2.0740e-01,  1.0083e-01, -9.4849e-02,  ...,  1.3867e-01,
           -6.3171e-02,  2.3270e-02],
          [-4.5593e-02, -8.7463e-02,  4.4287e-01,  ...,  4.7729e-01,
           -1.8787e-01, -3.8422e-02],
          [-5.2490e-02,  7.9529e-02,  3.7646e-01,  ...,  2.1347e-02,
            4.8291e-01, -2.8540e-01],
          ...,
          [ 1.0791e-01, -7.2998e-02,  4.3671e-02,  ...,  1.7236e-01,
           -5.9753e-02, -1.0699e-01],
          [ 7.0068e-01, -1.0187e-01,  3.5858e-02,  ..., -2.1045e-01,
            4.5850e-01,  1.7432e-01],
          [-2.0691e-02,  3.1128e-02, -2.7222e-02,  ..., -3.3984e-01,
            2.3193e-01,  3.9307e-01]],

         [[ 1.9516e-02,  4.7339e-01, -2.9248e-01,  ...,  1.4038e-01,
           -2.8801e-03, -1.6003e-01],
          [ 5.3253e-03, -2.0203e-01,  2.2607e-01,  ...,  2.3450e-01,
            1.6296e-01, -7.7881e-02],
          [-7.9468e-02,  3.6963e-01,  1.2537e-01,  ..., -5.2338e-03,
            2.2192e-01,  1.6785e-01],
          ...,
          [ 1.1737e-01,  1.0144e-01,  5.4779e-02,  ...,  2.1594e-01,
            8.5999e-02,  4.9902e-01],
          [-1.5442e-01,  2.1802e-01, -1.5564e-01,  ..., -5.5420e-02,
           -1.2384e-01,  4.5563e-02],
          [ 4.1699e-01,  1.0461e-01,  3.9600e-01,  ...,  3.1836e-01,
           -2.7515e-01, -2.5049e-01]],

         [[ 1.3269e-01, -7.3792e-02,  4.1138e-01,  ...,  1.4807e-01,
            1.0712e-02,  1.2830e-01],
          [-9.1797e-02,  5.2881e-01,  1.5698e-01,  ...,  4.2908e-02,
            8.6060e-02, -1.2286e-01],
          [ 3.1372e-01,  9.9304e-02, -2.9373e-02,  ...,  4.5605e-01,
            7.5073e-02,  1.1438e-01],
          ...,
          [ 8.8257e-02, -1.3171e-01,  2.7271e-01,  ...,  2.2437e-01,
           -6.7932e-02, -3.6914e-01],
          [ 2.4609e-01, -9.4223e-03, -6.2927e-02,  ...,  2.3669e-01,
            2.5342e-01, -3.1891e-02],
          [-1.0144e-01,  5.4883e-01,  1.4893e-01,  ...,  5.7275e-01,
            3.4229e-01,  3.2440e-02]],

         ...,

         [[-2.1606e-01,  3.3203e-01,  1.3672e-01,  ...,  2.4658e-01,
            1.9226e-01,  2.7417e-01],
          [ 6.2469e-02,  5.2376e-03, -6.2447e-03,  ...,  9.0393e-02,
            2.7881e-01,  1.9543e-01],
          [-4.9316e-02,  2.3849e-02,  2.1558e-01,  ..., -9.6069e-02,
           -7.5195e-02,  8.3191e-02],
          ...,
          [ 2.9236e-02,  1.7993e-01,  2.4646e-01,  ..., -1.5450e-02,
            3.1592e-01,  5.7495e-02],
          [ 3.6719e-01,  6.1523e-01,  4.3823e-01,  ...,  2.5464e-01,
            3.5986e-01,  3.1104e-01],
          [ 1.9440e-02,  2.5073e-01,  2.5879e-01,  ...,  3.3643e-01,
           -1.4137e-02,  2.9395e-01]],

         [[ 3.1616e-02,  3.5986e-01,  3.5962e-01,  ...,  7.2083e-02,
            1.0278e-01, -3.3844e-02],
          [-3.3545e-01,  3.4399e-01,  4.3384e-01,  ...,  9.5825e-02,
            1.6077e-01,  2.4756e-01],
          [-2.9346e-01,  4.3115e-01, -1.3904e-01,  ...,  1.3538e-01,
           -3.0579e-02,  6.4802e-04],
          ...,
          [ 2.8589e-01,  2.7295e-01,  2.1021e-01,  ..., -1.6577e-01,
            2.4011e-01,  4.2511e-02],
          [ 3.1201e-01,  2.8271e-01,  1.3611e-01,  ..., -4.9194e-02,
            1.3940e-01,  4.0503e-01],
          [-4.5624e-03,  2.0496e-01,  2.6416e-01,  ..., -9.3018e-02,
            3.6426e-01,  4.5532e-01]],

         [[ 9.6619e-02, -1.1551e-02, -1.7712e-01,  ...,  9.4833e-03,
            1.7090e-01,  4.0314e-02],
          [-1.6772e-01,  1.7041e-01, -1.0307e-02,  ...,  4.7900e-01,
            2.1957e-02,  4.3427e-02],
          [-4.1968e-01, -1.8762e-01,  3.5742e-01,  ...,  1.0504e-01,
            2.7734e-01,  1.4038e-01],
          ...,
          [ 1.2756e-01, -6.0181e-02,  2.8223e-01,  ...,  2.9468e-01,
            1.8359e-01, -2.9419e-01],
          [ 1.4771e-01,  8.0444e-02,  3.7201e-02,  ...,  8.4839e-02,
           -1.4368e-01, -1.3084e-02],
          [ 4.5410e-02,  7.0374e-02,  3.6133e-01,  ...,  4.8242e-01,
            1.9873e-01,  1.6809e-01]]]], device='cuda:0', dtype=torch.float16,
       requires_grad=True)
k input:  tensor([[[[ 0.5459,  0.4194,  0.3831,  ...,  0.3157,  0.1648,  0.3047],
          [ 0.5674,  0.1727,  0.6577,  ...,  0.5713,  0.4155,  0.3152],
          [ 0.2065,  0.3354,  0.5615,  ...,  0.1394,  0.3782,  0.3726],
          ...,
          [ 0.4836,  0.3223,  0.3076,  ..., -0.0473,  0.5127,  0.6040],
          [ 0.3748,  0.3167, -0.1853,  ...,  0.6055,  0.2705,  0.1934],
          [ 0.3022,  0.7393,  0.5879,  ...,  0.4084,  0.3784,  0.3396]],

         [[ 0.5322,  0.4824,  0.7803,  ...,  0.4680,  0.1490, -0.0046],
          [ 0.0852,  0.2050,  0.5586,  ...,  0.3618,  0.3269,  0.4504],
          [-0.0662,  0.2408,  0.5483,  ...,  0.7900,  0.4436,  0.3801],
          ...,
          [ 0.8813,  0.5034,  0.2515,  ...,  0.0312,  0.1855,  0.4204],
          [ 0.1851,  0.5010,  0.3933,  ...,  0.1895,  0.5454,  0.3816],
          [ 0.3213,  0.2820,  0.6182,  ...,  0.7725,  0.1260,  0.1087]],

         [[ 0.5327,  0.4929,  0.9214,  ...,  0.3560,  0.5742,  0.7217],
          [ 0.4778,  0.2278,  0.3801,  ...,  0.4155,  0.1464,  0.5400],
          [ 0.4670,  0.3379,  0.2551,  ...,  0.3652,  0.5830,  0.3826],
          ...,
          [ 0.4790,  0.5010,  0.5293,  ...,  0.4072,  0.6343,  0.7544],
          [ 0.5356,  0.4307,  0.5522,  ...,  0.3472,  0.3083,  0.4834],
          [ 0.4473,  0.3374,  0.2756,  ...,  0.5405,  0.7383,  0.0804]],

         ...,

         [[ 0.4841,  0.4348,  0.0081,  ...,  0.4807,  0.3430,  0.4617],
          [ 0.5518,  0.0588,  0.6411,  ...,  0.5273,  0.4263,  0.7041],
          [ 0.2460,  0.8408,  0.3845,  ...,  0.5137,  0.5601,  0.4082],
          ...,
          [ 0.3816,  0.3601,  0.2620,  ...,  0.6289,  0.1003,  0.6138],
          [ 0.2252,  0.3401,  0.4731,  ...,  0.4148,  0.4653,  0.4724],
          [ 0.1504,  1.0078,  0.2791,  ...,  0.1830,  0.1672,  0.3494]],

         [[ 0.6318,  0.6162,  0.8257,  ...,  0.5234,  0.4636,  0.5527],
          [ 0.4680,  0.4553,  0.7012,  ...,  0.3928,  0.3657,  0.4836],
          [ 0.5415,  0.3879,  0.5654,  ...,  0.7070,  0.1892,  0.7847],
          ...,
          [ 0.4780,  0.5845,  0.3081,  ...,  0.4438,  0.3816, -0.0222],
          [ 0.1737, -0.0474,  0.6128,  ...,  0.3623,  0.3350,  0.1995],
          [ 0.3125,  0.8193,  0.7329,  ...,  0.4346,  0.2039,  0.4612]],

         [[ 0.6235,  0.4907,  0.6729,  ...,  0.5269,  0.4004,  0.9175],
          [ 0.7280,  0.1248,  0.4570,  ...,  0.4009,  0.8647,  0.3828],
          [ 0.5610,  0.2891,  0.3557,  ...,  0.2959,  0.4983,  0.4492],
          ...,
          [ 0.1995,  0.6958,  0.5952,  ...,  0.2920,  1.0820,  0.4019],
          [ 0.1777,  0.5259,  0.2578,  ...,  0.3679,  0.5859,  0.4612],
          [ 0.3474,  0.8237,  0.0327,  ...,  0.3782,  0.4846,  0.3252]]],


        [[[ 0.4016,  0.4998,  0.4092,  ...,  0.1163,  0.4351,  0.4917],
          [ 0.0906,  0.1914,  0.5342,  ...,  0.4512,  0.4243,  0.2617],
          [ 0.4944,  0.3040,  0.3352,  ...,  0.1467,  0.2183,  0.5977],
          ...,
          [ 0.2952,  0.5596, -0.0396,  ...,  0.2690,  0.3604,  0.4070],
          [ 0.6870,  0.6709,  0.8418,  ...,  0.3059,  0.3186,  0.3425],
          [ 0.4707,  0.3491,  0.4321,  ...,  0.5869,  0.3608,  0.5938]],

         [[ 0.2311,  0.4485,  0.2524,  ...,  0.6919,  0.6646,  0.1644],
          [ 0.4307,  0.8721,  0.3374,  ...,  0.4932,  0.1854,  0.3540],
          [ 0.2603,  0.2351,  0.3215,  ...,  0.3723,  0.0574,  0.6079],
          ...,
          [ 0.5703,  0.4978,  0.2324,  ...,  0.3367,  0.3733,  0.4539],
          [ 0.4001,  0.5542, -0.0842,  ...,  0.2576,  0.7354,  0.1099],
          [ 0.2585,  0.3247,  0.5903,  ...,  0.2617,  0.4678,  0.4697]],

         [[ 0.2915,  0.2842,  0.4688,  ...,  0.6694,  0.1410, -0.0076],
          [ 0.5854,  0.8086,  0.3486,  ...,  0.4971,  0.4053,  0.2852],
          [ 0.6152, -0.0958,  0.5063,  ...,  0.3367,  0.4775,  0.4558],
          ...,
          [ 0.5254,  0.2153,  0.7183,  ...,  0.3860,  0.4377,  0.3718],
          [ 0.3748,  0.6226,  0.3643,  ...,  0.7168,  0.4922,  0.3513],
          [ 0.6709,  0.2401,  0.3918,  ...,  0.4585,  0.3401,  0.5107]],

         ...,

         [[ 0.3145,  0.3291,  0.4280,  ..., -0.1236,  0.4998,  0.2588],
          [ 0.2208,  0.1555,  0.6143,  ...,  0.4937,  0.1703,  0.3403],
          [ 0.6353,  0.2800, -0.0407,  ...,  0.3020,  0.1558,  0.3120],
          ...,
          [ 0.3748,  0.3333,  0.4155,  ...,  0.7046,  0.1364,  0.5928],
          [ 0.2185,  0.1948,  0.5688,  ...,  0.1346,  0.2644,  0.4941],
          [ 0.3403,  0.4956,  0.4141,  ...,  0.3677,  0.0812,  0.3091]],

         [[ 0.5127,  0.6587,  0.3247,  ...,  0.3225,  0.4104,  0.3132],
          [ 0.4790,  0.2173,  0.1798,  ...,  0.5098,  0.3884,  0.3015],
          [ 0.4270,  0.7446, -0.0403,  ...,  0.5054,  0.9155,  0.3955],
          ...,
          [ 0.4683,  0.0807,  0.4543,  ...,  0.2179,  0.1476,  0.2057],
          [ 0.1796,  0.4490,  0.4297,  ...,  0.3806,  0.0972,  1.0244],
          [ 0.4700,  0.2578,  0.4038,  ..., -0.0655,  0.4338,  0.1870]],

         [[ 0.5400,  0.5142,  0.5107,  ...,  0.2014,  0.4399,  0.5742],
          [ 0.6465,  0.3494,  0.5713,  ...,  0.3413,  0.3931,  0.8311],
          [ 0.7236,  0.0515,  0.7217,  ...,  0.4082,  0.3513,  0.5215],
          ...,
          [ 0.4277,  0.5435,  0.6953,  ...,  0.1670,  0.4072,  0.2617],
          [ 0.6821,  0.3550,  0.5288,  ...,  0.0505,  0.1577,  0.3955],
          [ 0.7261,  0.7153,  0.3984,  ...,  0.2283,  0.5142,  0.3845]]],


        [[[ 0.3367,  0.1195,  0.6719,  ...,  0.6382,  0.2871,  0.3108],
          [ 0.4524, -0.0537,  0.4834,  ...,  0.5332,  0.3562,  0.4382],
          [ 0.1404,  0.1315,  0.2917,  ...,  0.6001,  0.3896,  0.1080],
          ...,
          [ 0.2976,  0.3330,  0.2876,  ...,  0.4888,  0.4609, -0.1387],
          [ 0.3760,  0.4309,  0.6562,  ...,  0.5410,  0.3198,  0.2047],
          [ 0.2935,  0.1838,  0.6621,  ...,  0.1416,  0.1595,  0.1736]],

         [[ 0.2051,  0.3374,  0.2900,  ...,  0.1537,  0.3408,  0.4944],
          [ 0.5996,  0.5776,  0.6060,  ...,  0.3728,  0.3125,  0.4238],
          [ 0.3596,  0.1538,  0.6489,  ...,  0.8901,  0.7544,  0.4749],
          ...,
          [ 0.4539,  0.6807,  0.1663,  ...,  0.6836,  0.2961,  0.5732],
          [ 0.4080,  0.4490,  0.5410,  ...,  0.4902,  0.5107,  0.3030],
          [ 0.1533,  0.4517,  0.4224,  ...,  0.6069,  0.2356,  0.2776]],

         [[ 0.5361,  0.6211,  0.0564,  ...,  0.6787,  0.4395,  0.3813],
          [ 0.8999,  0.2079,  0.5708,  ...,  0.7563,  0.3933,  0.6392],
          [ 0.6333,  0.5420,  0.5654,  ...,  0.4546,  0.4045,  0.4961],
          ...,
          [ 0.4727,  0.4077,  0.4539,  ...,  0.3728,  0.4114,  0.6484],
          [ 0.4602,  0.9165,  0.5640,  ...,  0.3608,  0.1984,  0.5908],
          [ 0.5664,  0.5029,  0.3145,  ...,  0.1055,  0.2285,  0.7109]],

         ...,

         [[ 0.2561,  0.4290,  0.4360,  ...,  0.5171,  0.2499, -0.2054],
          [ 0.4556,  0.4438,  0.3606,  ...,  0.5767,  0.0546,  0.4365],
          [ 0.1215,  0.3928,  0.2375,  ...,  0.4233,  0.2852,  0.4580],
          ...,
          [ 0.2732,  0.4871,  0.4858,  ...,  0.6758,  0.5942,  0.4651],
          [ 0.7695,  0.3359,  0.2534,  ...,  0.2742,  0.5957,  0.2712],
          [ 0.3757,  0.5303,  0.2306,  ...,  0.8037,  0.4807,  0.4392]],

         [[ 0.3677,  0.3081,  0.4973,  ...,  0.1133,  0.4714, -0.1265],
          [ 0.3716,  0.4316,  0.3491,  ...,  0.5264,  0.2820,  0.3394],
          [ 0.1304,  0.4915,  0.2551,  ...,  0.1681,  0.5059,  0.4878],
          ...,
          [ 0.3396,  0.7002,  0.5254,  ...,  0.5400,  0.4534,  0.1730],
          [ 0.3049,  0.4961,  0.9463,  ...,  0.3899,  0.5405,  0.5161],
          [ 0.2001,  0.4792,  0.1831,  ...,  0.2325,  0.7676,  0.2195]],

         [[ 0.0119,  0.0820,  0.2339,  ...,  0.3506,  0.3984,  0.5908],
          [ 0.7891,  0.6909,  0.4492,  ...,  0.5005,  0.6519,  0.4609],
          [ 0.4744,  0.4163,  0.1066,  ...,  0.3008,  0.7480,  0.2871],
          ...,
          [ 0.3767,  0.4316,  0.1592,  ...,  0.2394,  0.6572,  0.3789],
          [ 0.3030,  0.4080, -0.0436,  ...,  0.1058,  0.4561,  0.1479],
          [ 0.0551,  0.2438,  0.4263,  ...,  0.5698,  0.2031,  0.5332]]],


        [[[ 0.3013,  0.5278,  0.8008,  ...,  0.4238,  0.3628,  0.4692],
          [ 0.6729,  0.2729,  0.2332,  ...,  0.3235,  0.2822,  0.3213],
          [ 0.6748,  0.1283,  0.4143,  ...,  0.4832,  0.3652,  0.8052],
          ...,
          [ 0.6763,  0.0698,  0.4031,  ...,  0.4124,  0.2585,  0.5352],
          [ 0.5288,  0.4783,  0.7217,  ...,  0.4854,  0.4651,  0.2705],
          [ 0.3682,  0.1698,  0.1954,  ...,  0.4363,  0.5312,  0.2971]],

         [[ 0.5317,  0.2881,  0.3293,  ...,  0.1649,  0.2385,  0.1688],
          [ 0.5874,  0.2961,  0.7363,  ...,  0.4021,  0.2908,  0.1849],
          [ 0.6138,  0.1649,  0.0725,  ...,  0.3801,  0.5439,  0.3718],
          ...,
          [ 0.6953,  0.3762,  0.1031,  ...,  0.6279,  0.5879,  0.2773],
          [ 0.3342,  0.4600,  0.4041,  ...,  0.3188,  0.5493,  0.3965],
          [ 0.5220,  0.6543,  0.6938,  ...,  0.3586,  0.5571,  0.5220]],

         [[ 0.4138,  0.6646,  0.2549,  ...,  0.6606,  0.3835,  0.6436],
          [ 0.3147,  0.1621,  0.2827,  ...,  0.4763,  0.3621,  0.2732],
          [ 0.6436,  0.4546,  0.8037,  ...,  0.5088,  0.1186,  0.7568],
          ...,
          [ 0.5684,  0.5288,  0.6050,  ...,  0.3423,  0.4526,  0.2959],
          [ 0.6147,  0.5000,  0.8135,  ...,  0.3015,  0.6592,  0.7979],
          [ 0.2028,  0.1945,  0.2412,  ...,  0.2761,  0.5103, -0.0213]],

         ...,

         [[ 0.5552,  0.1300,  0.4265,  ...,  0.1997,  0.1775,  0.7148],
          [ 0.9131,  0.5552,  0.5156,  ...,  0.4238,  0.6401,  0.0800],
          [ 0.4436,  0.2615,  0.5518,  ...,  0.3955,  0.4846,  0.7988],
          ...,
          [ 0.5684,  0.5757,  0.6372,  ...,  0.7417,  0.1388,  0.2651],
          [ 0.5161,  0.5889,  0.2201,  ...,  0.2998,  0.5869,  0.5273],
          [ 0.2208,  0.0505,  0.7363,  ...,  0.6001,  0.6123,  0.4380]],

         [[ 0.3809,  0.2996,  0.6934,  ...,  0.0266,  0.2153,  0.6309],
          [ 0.4255,  0.3367,  0.0915,  ...,  0.5332,  0.2830,  0.4363],
          [ 0.1058,  0.3772,  0.4048,  ...,  0.3833,  0.4727,  0.2939],
          ...,
          [ 0.0862,  0.3555,  0.6382,  ...,  0.3257,  0.1576,  0.4563],
          [ 0.6289,  0.2908,  0.2815,  ...,  0.2058,  0.4807,  0.1984],
          [ 0.4441,  0.6567,  0.0424,  ...,  0.1859,  0.4097,  0.4924]],

         [[ 0.1024, -0.0231,  0.6035,  ...,  0.6177,  0.3784,  0.1537],
          [ 0.6021,  0.4177,  0.1713,  ...,  0.1953,  0.3999,  0.3855],
          [ 0.1428,  0.3982,  0.2537,  ...,  0.1296,  0.4885,  0.4136],
          ...,
          [ 0.2561,  0.2352,  0.1997,  ...,  0.5210,  0.6064,  0.3064],
          [ 0.3342,  0.7207,  0.3000,  ...,  0.3118,  0.1021,  0.7529],
          [ 0.3982,  0.3518, -0.1678,  ...,  0.3879,  0.3276,  0.6641]]]],
       device='cuda:0', dtype=torch.float16, requires_grad=True)
v input:  tensor([[[[ 4.9609e-01, -6.2805e-02,  5.5054e-02,  ...,  3.8867e-01,
            5.3650e-02,  3.1152e-01],
          [ 2.3840e-01,  2.6465e-01,  5.8136e-02,  ...,  5.1416e-01,
            2.5122e-01,  3.0713e-01],
          [ 1.4185e-01,  6.5918e-01,  1.4221e-01,  ...,  4.1382e-01,
            8.4412e-02,  5.5923e-03],
          ...,
          [ 3.8281e-01,  5.1971e-02,  2.6929e-01,  ...,  3.0542e-01,
            1.8762e-01,  1.5283e-01],
          [ 3.3911e-01,  4.2847e-01,  3.1201e-01,  ...,  2.8589e-01,
            3.2275e-01,  4.0186e-01],
          [ 7.3242e-02,  6.3184e-01,  2.1631e-01,  ...,  5.4004e-01,
            2.6782e-01,  3.7891e-01]],

         [[ 5.7617e-01,  6.7688e-02,  4.4897e-01,  ...,  1.8323e-01,
            2.8271e-01,  7.4219e-01],
          [ 1.6687e-01,  4.4727e-01,  2.9028e-01,  ...,  3.0469e-01,
            2.4487e-01,  3.5327e-01],
          [ 4.6606e-01,  1.2756e-01,  4.0479e-01,  ...,  5.2637e-01,
            3.6743e-01,  5.5664e-01],
          ...,
          [ 3.0518e-01,  2.0837e-01,  3.2080e-01,  ...,  1.4905e-01,
            2.9541e-01,  4.8730e-01],
          [ 3.9038e-01,  4.8389e-01, -4.2969e-02,  ...,  1.0486e-01,
            1.7371e-01,  4.7363e-01],
          [ 5.8075e-02,  1.3171e-01,  2.4927e-01,  ...,  4.1675e-01,
            2.3450e-01, -2.9199e-01]],

         [[ 3.7378e-01,  3.0396e-01,  3.2935e-01,  ...,  4.5190e-01,
            3.5718e-01,  6.8799e-01],
          [ 4.9658e-01,  5.3857e-01,  4.5190e-01,  ...,  3.4985e-01,
            3.5791e-01,  3.6621e-01],
          [ 4.7192e-01,  3.6597e-01,  5.4199e-01,  ...,  7.2449e-02,
            1.9360e-01,  2.6123e-01],
          ...,
          [ 4.2969e-01,  1.6504e-01,  1.2610e-01,  ..., -2.0630e-02,
            4.1895e-01,  4.0405e-01],
          [ 3.1885e-01,  2.2278e-01, -2.3560e-02,  ...,  2.6489e-01,
            4.9408e-02,  5.1367e-01],
          [ 5.0391e-01,  8.1934e-01,  2.5513e-01,  ...,  3.6768e-01,
            1.1871e-01,  2.2278e-01]],

         ...,

         [[ 5.1172e-01,  4.4360e-01,  3.8672e-01,  ...,  5.0586e-01,
            2.3743e-02,  2.3950e-01],
          [ 4.4385e-01,  4.2236e-01,  4.6777e-01,  ...,  5.2197e-01,
            2.3486e-01,  4.3311e-01],
          [ 3.9624e-01,  1.5649e-01,  5.4688e-01,  ...,  2.6172e-01,
            3.1787e-01, -1.8707e-02],
          ...,
          [ 2.2217e-02,  3.4033e-01,  2.2522e-01,  ...,  2.6831e-01,
            6.4795e-01, -7.1812e-04],
          [-3.6530e-02,  3.7915e-01,  7.1045e-01,  ...,  6.7078e-02,
            7.3633e-01,  2.0349e-01],
          [ 3.3398e-01,  4.8920e-02,  2.8369e-01,  ..., -3.0713e-01,
            2.6270e-01,  4.0088e-01]],

         [[ 2.9541e-01,  2.6855e-01,  4.2139e-01,  ...,  2.1619e-01,
            3.9355e-01,  2.3230e-01],
          [ 2.1375e-01,  7.1533e-01,  3.6255e-01,  ...,  5.2637e-01,
            6.5137e-01,  1.0803e-01],
          [ 5.3223e-01,  1.7676e-01,  4.8608e-01,  ...,  2.9248e-01,
            5.4834e-01,  6.0498e-01],
          ...,
          [ 4.9561e-01,  5.6250e-01,  3.4985e-01,  ...,  7.4951e-02,
            3.8184e-01,  2.9028e-01],
          [ 2.6172e-01,  4.0503e-01,  4.8682e-01,  ...,  1.0913e-01,
            2.2168e-01,  1.8478e-02],
          [ 3.2446e-01, -1.0513e-02,  4.0967e-01,  ...,  3.8892e-01,
            5.3516e-01, -1.0291e-01]],

         [[ 3.0371e-01,  1.6589e-01,  5.5127e-01,  ...,  1.5527e-01,
            1.7480e-01,  2.6685e-01],
          [ 3.1714e-01,  6.1719e-01,  2.8052e-01,  ...,  2.0203e-01,
            1.0537e+00,  3.1152e-01],
          [ 3.2227e-01,  7.4023e-01,  2.8931e-01,  ...,  3.0811e-01,
            5.8105e-01,  8.4912e-01],
          ...,
          [ 3.7231e-01,  4.2603e-01,  5.3125e-01,  ...,  1.3513e-01,
            3.8940e-01,  2.4939e-01],
          [ 3.8395e-03,  2.5366e-01,  1.8115e-01,  ...,  1.2573e-01,
            2.4719e-01,  1.1548e-01],
          [ 6.5674e-01,  9.2285e-02,  9.0210e-02,  ...,  6.4453e-01,
            1.9824e-01,  1.5149e-01]]],


        [[[ 2.0813e-01,  3.9233e-01,  5.5762e-01,  ...,  3.8281e-01,
            2.8076e-01,  3.1982e-01],
          [ 1.5186e-01,  3.5229e-01,  1.9153e-01,  ...,  2.5488e-01,
            2.1753e-01, -5.8563e-02],
          [ 7.3608e-02,  2.5293e-01,  5.1361e-02,  ...,  2.3474e-01,
            2.8149e-01,  2.9663e-01],
          ...,
          [ 2.7734e-01,  3.9893e-01,  4.0576e-01,  ...,  2.2046e-01,
            1.8640e-01,  1.5967e-01],
          [ 7.2607e-01,  1.0419e-01,  2.6294e-01,  ...,  5.3613e-01,
           -8.7952e-02,  4.6948e-01],
          [-1.6614e-01,  2.8271e-01,  1.1584e-01,  ...,  5.5023e-02,
           -1.8753e-02,  6.1084e-01]],

         [[ 3.9917e-01,  1.0364e-01,  4.5996e-01,  ...,  2.5659e-01,
            2.8174e-01,  3.0664e-01],
          [ 3.0981e-01,  5.0537e-01,  9.8816e-02,  ...,  3.5693e-01,
            6.2158e-01,  5.0342e-01],
          [ 5.7471e-01,  2.3303e-01,  2.8534e-02,  ...,  1.3977e-01,
            1.9543e-01, -1.4307e-01],
          ...,
          [ 2.2534e-01,  8.7769e-02,  2.4536e-01,  ...,  1.4148e-01,
            2.2571e-01,  6.2842e-01],
          [ 6.2305e-01,  3.6792e-01,  3.4473e-01,  ...,  5.8203e-01,
            2.4219e-01, -1.0681e-01],
          [ 5.0830e-01, -1.1945e-01,  4.0186e-01,  ...,  2.1704e-01,
            2.4365e-01,  6.3184e-01]],

         [[ 3.8037e-01,  5.1221e-01,  3.9648e-01,  ...,  3.5620e-01,
            6.6553e-01,  4.5874e-01],
          [ 5.3329e-03,  5.6006e-01,  2.6465e-01,  ...,  1.9922e-01,
            7.1960e-02,  2.3291e-01],
          [ 1.4941e-01,  4.0991e-01,  2.0264e-01,  ...,  4.1382e-01,
           -1.7761e-01,  2.2620e-01],
          ...,
          [ 1.6235e-01,  3.4766e-01,  3.0566e-01,  ...,  2.5781e-01,
            3.5767e-01,  2.3608e-01],
          [ 1.9385e-01,  1.1877e-01,  2.5330e-02,  ...,  3.0859e-01,
            7.1533e-01,  4.3286e-01],
          [ 1.2610e-01,  3.6499e-01, -1.9928e-02,  ...,  4.6411e-01,
            2.8101e-01,  2.4255e-01]],

         ...,

         [[ 3.1885e-01,  2.1448e-01,  3.0908e-01,  ...,  1.2199e-02,
            4.0942e-01,  3.8867e-01],
          [ 3.4595e-01,  5.8887e-01,  1.7896e-01,  ...,  2.1753e-01,
            4.3970e-01,  6.1684e-03],
          [ 2.7075e-01,  8.8745e-02,  2.7661e-01,  ...,  8.3496e-01,
            4.2603e-01,  4.8511e-01],
          ...,
          [ 3.6328e-01,  4.9927e-02,  2.5342e-01,  ...,  6.3232e-01,
            4.6802e-01,  4.0186e-01],
          [ 4.3384e-01,  3.5034e-01, -9.0088e-02,  ...,  6.9678e-01,
            4.6582e-01,  9.2773e-02],
          [ 3.0518e-01,  2.9492e-01,  4.5972e-01,  ...,  7.5684e-01,
            2.0288e-01,  4.4946e-01]],

         [[ 4.5801e-01, -1.1292e-01,  5.1221e-01,  ...,  7.0654e-01,
            3.4888e-01,  1.9592e-02],
          [ 3.6841e-01,  5.7812e-01,  2.1313e-01,  ..., -1.0217e-01,
            7.3926e-01,  3.4937e-01],
          [-4.2358e-02,  1.2781e-01,  4.2212e-01,  ...,  3.4229e-01,
            1.5771e-01,  4.5581e-01],
          ...,
          [ 2.8662e-01,  1.5515e-01,  4.0332e-01,  ...,  2.9083e-02,
           -9.4055e-02,  1.6577e-01],
          [ 3.0640e-01,  3.0469e-01, -7.3792e-02,  ...,  3.5010e-01,
            3.2227e-01,  9.0271e-02],
          [ 3.3374e-01,  6.4795e-01,  4.9072e-01,  ...,  2.7588e-01,
            1.1847e-01,  3.8550e-01]],

         [[ 1.8262e-01,  5.7568e-01,  6.4111e-01,  ...,  4.7876e-01,
            8.9417e-02,  3.8525e-01],
          [ 4.6802e-01,  2.5098e-01,  5.7953e-02,  ...,  6.7969e-01,
            1.1304e-01,  3.9746e-01],
          [ 2.5464e-01,  3.0566e-01,  1.8665e-01,  ...,  6.6504e-01,
            1.5845e-01,  4.0479e-01],
          ...,
          [ 3.1299e-01,  3.9111e-01,  1.8042e-01,  ...,  1.4954e-01,
            1.6211e-01,  1.6956e-01],
          [ 4.4531e-01,  4.0985e-02, -7.1106e-02,  ...,  2.8760e-01,
            8.0566e-01,  2.4780e-01],
          [ 2.6709e-01,  7.3364e-02,  3.6035e-01,  ...,  1.7627e-01,
            1.0553e-01,  3.5132e-01]]],


        [[[ 4.5874e-01,  1.0950e-01,  5.2490e-01,  ...,  3.0933e-01,
            2.0642e-01,  3.5083e-01],
          [ 3.4180e-01,  2.0654e-01,  4.1895e-01,  ...,  1.4771e-01,
            1.5625e-01,  5.2539e-01],
          [ 2.0679e-01, -1.9958e-01,  6.9336e-01,  ...,  3.8135e-01,
            2.5195e-01, -4.3121e-02],
          ...,
          [ 3.9624e-01, -7.5745e-02,  3.2642e-01,  ...,  5.6152e-01,
            2.2314e-01, -8.8623e-02],
          [ 5.0830e-01,  7.2754e-02, -7.4158e-02,  ...,  1.6577e-01,
            1.8005e-01,  2.7695e-02],
          [ 4.0186e-01,  4.6570e-02,  2.8882e-01,  ...,  4.0259e-01,
            2.5635e-01,  2.0557e-01]],

         [[ 1.2469e-01,  2.6221e-01,  2.1667e-01,  ..., -2.9999e-02,
            3.9429e-01,  4.1846e-01],
          [ 2.0691e-01,  1.4148e-01,  2.9126e-01,  ...,  4.8584e-01,
            1.3660e-01,  6.7444e-02],
          [ 1.8494e-01,  6.0010e-01,  2.5122e-01,  ...,  5.5518e-01,
            3.9551e-01, -6.9763e-02],
          ...,
          [ 3.4985e-01,  4.4403e-02,  3.7158e-01,  ...,  9.3689e-02,
           -1.2291e-02,  2.9980e-01],
          [ 6.2402e-01,  8.5022e-02,  4.1064e-01,  ...,  1.4038e-01,
            5.5859e-01,  2.6904e-01],
          [ 3.7744e-01,  3.9282e-01,  1.9531e-01,  ...,  2.7756e-02,
            6.7688e-02,  5.0000e-01]],

         [[ 3.9014e-01, -1.4722e-01,  5.2734e-01,  ...,  1.8481e-01,
            1.6821e-01,  1.7407e-01],
          [-5.9570e-02,  8.5449e-02,  2.3474e-01,  ...,  1.2402e-01,
            1.5833e-01,  6.6064e-01],
          [ 4.6606e-01,  2.7930e-01,  1.5808e-01,  ...,  1.6968e-01,
            5.3467e-01,  2.5903e-01],
          ...,
          [ 6.4453e-01,  6.6162e-01,  1.7004e-01,  ..., -1.4175e-02,
            3.9551e-01,  3.2471e-01],
          [-1.7065e-01,  2.6343e-01,  2.7344e-01,  ...,  3.5327e-01,
            4.4434e-01,  3.3862e-01],
          [ 3.6938e-01,  5.5176e-01,  4.4922e-01,  ...,  4.7668e-02,
            1.1371e-01,  4.9536e-01]],

         ...,

         [[ 1.4746e-01,  4.4141e-01,  2.9932e-01,  ..., -4.9622e-02,
            7.1875e-01,  2.4585e-01],
          [ 6.6699e-01,  6.0205e-01, -1.0095e-01,  ...,  5.8936e-01,
            3.2275e-01,  2.8638e-01],
          [ 5.1416e-01,  3.0103e-01,  4.8413e-01,  ...,  2.7298e-02,
            8.6731e-02,  9.3933e-02],
          ...,
          [ 2.4182e-01,  4.3921e-01,  3.5913e-01,  ...,  5.4980e-01,
            4.1577e-01,  3.7964e-01],
          [ 2.4756e-01,  1.8524e-02,  1.4575e-01,  ...,  8.8684e-02,
            4.9390e-01,  4.9219e-01],
          [ 3.1567e-01,  1.7603e-01,  2.5732e-01,  ...,  2.8906e-01,
            1.0132e-01,  7.1924e-01]],

         [[ 6.6566e-03,  4.1260e-01,  2.8369e-01,  ...,  1.5454e-01,
            2.1057e-01,  5.7812e-01],
          [ 3.7402e-01,  3.9087e-01, -2.2070e-01,  ...,  2.8296e-01,
            1.5491e-01,  3.3350e-01],
          [ 1.3391e-01,  3.4131e-01,  1.4722e-01,  ...,  3.6157e-01,
            1.8481e-01,  5.9131e-01],
          ...,
          [ 2.3392e-02,  3.1860e-01, -3.2422e-01,  ...,  5.2930e-01,
            2.2614e-02,  3.1616e-01],
          [ 4.2163e-01, -6.7871e-02,  4.5337e-01,  ...,  3.0469e-01,
            5.0928e-01,  2.6538e-01],
          [ 4.0112e-01,  5.0195e-01,  2.5049e-01,  ...,  4.1919e-01,
            6.7188e-01,  6.0107e-01]],

         [[ 3.5864e-01,  2.0984e-01,  4.3488e-02,  ...,  7.3425e-02,
           -3.9154e-02,  3.7280e-01],
          [ 5.9180e-01,  4.0894e-01,  7.2594e-03,  ...,  8.4961e-02,
            3.0380e-02,  4.3286e-01],
          [ 8.4534e-02,  8.1482e-02,  2.4719e-01,  ..., -4.6356e-02,
            4.5874e-01,  6.1914e-01],
          ...,
          [ 9.8328e-02,  2.9590e-01,  1.3586e-01,  ...,  5.8105e-01,
            3.4351e-01,  4.9316e-01],
          [ 7.5012e-02,  3.7769e-01,  5.7227e-01,  ..., -9.1705e-03,
            4.2871e-01,  2.2192e-01],
          [ 8.8135e-02,  1.5198e-01, -6.2103e-02,  ...,  3.7915e-01,
            3.6206e-01,  2.8418e-01]]],


        [[[ 1.3208e-01,  8.0322e-02,  2.4512e-01,  ...,  6.6223e-02,
           -1.2988e-01,  4.0723e-01],
          [-3.6316e-02,  1.0645e-01,  3.1763e-01,  ...,  1.5747e-01,
            4.4873e-01,  5.9418e-02],
          [ 4.8145e-01,  8.8440e-02,  3.4326e-01,  ..., -3.1877e-04,
            4.8950e-01,  5.9082e-01],
          ...,
          [ 3.9258e-01,  5.1544e-02,  2.1948e-01,  ...,  4.3774e-01,
            4.8511e-01,  2.1252e-01],
          [ 3.6523e-01,  2.1167e-01,  2.6318e-01,  ...,  3.7671e-01,
            1.9873e-01,  6.1816e-01],
          [ 1.5802e-03,  9.8633e-02,  1.2097e-01,  ...,  2.3486e-01,
            3.7085e-01,  2.0654e-01]],

         [[ 3.9404e-01,  2.8595e-02,  4.5728e-01,  ...,  3.2422e-01,
            7.1729e-01,  2.5806e-01],
          [ 4.7559e-01,  3.4253e-01,  5.0732e-01,  ...,  3.7842e-01,
            8.0750e-02,  3.0005e-01],
          [ 3.4546e-01,  3.3447e-01,  1.2671e-01,  ...,  3.0103e-01,
            6.5479e-01, -2.4414e-02],
          ...,
          [ 4.7632e-01,  5.7373e-01,  1.7053e-01,  ...,  4.2773e-01,
            4.0796e-01,  2.5562e-01],
          [ 1.3477e-01,  4.3628e-01,  7.9773e-02,  ...,  3.2666e-01,
            1.2115e-01,  7.8320e-01],
          [ 3.1567e-01,  3.5889e-01,  3.6084e-01,  ...,  3.4766e-01,
            4.7821e-02,  3.6816e-01]],

         [[ 1.5173e-01,  7.3047e-01,  1.6272e-01,  ...,  4.7900e-01,
            3.7427e-01,  3.5962e-01],
          [ 1.5894e-01,  2.5928e-01,  2.9785e-01,  ...,  5.3271e-01,
            4.6411e-01,  5.3809e-01],
          [ 5.6592e-01,  4.9536e-01,  2.9956e-01,  ...,  3.4155e-01,
           -5.7648e-02,  4.6021e-01],
          ...,
          [ 4.4727e-01,  3.7109e-01,  4.3237e-01,  ...,  2.2791e-01,
            1.7859e-01,  4.2896e-01],
          [ 3.4399e-01,  4.6338e-01,  5.0391e-01,  ...,  4.7827e-01,
            1.9617e-01,  5.8838e-01],
          [-6.1798e-02,  7.6318e-01,  3.7207e-01,  ...,  2.5000e-01,
            3.7720e-01,  3.4180e-01]],

         ...,

         [[ 3.0060e-03,  3.3984e-01,  4.0063e-01,  ..., -7.3303e-02,
            1.1151e-01,  3.8159e-01],
          [ 3.8013e-01,  2.9468e-01,  2.9956e-01,  ..., -1.8359e-01,
            4.4727e-01,  4.3433e-01],
          [ 6.5771e-01,  2.2522e-01,  7.4756e-01,  ...,  2.1069e-01,
            2.4084e-01,  3.2251e-01],
          ...,
          [ 5.2100e-01, -2.9404e-02,  2.0239e-01,  ...,  8.1592e-01,
            5.3040e-02,  4.6265e-01],
          [ 1.9458e-01,  2.6025e-01,  3.9062e-01,  ...,  3.5828e-02,
            4.1309e-01,  3.7036e-01],
          [ 3.8647e-01,  3.5913e-01,  2.3022e-01,  ...,  3.2861e-01,
            5.8740e-01,  6.2256e-01]],

         [[ 1.8591e-01,  1.2128e-01,  1.9678e-01,  ...,  3.4351e-01,
            5.5566e-01,  5.1172e-01],
          [ 3.0298e-01,  2.8149e-01,  4.9019e-03,  ...,  2.4121e-01,
            5.1611e-01,  4.4092e-01],
          [ 4.7437e-01,  4.1089e-01,  2.4097e-01,  ...,  2.5244e-01,
            1.1957e-01,  2.5708e-01],
          ...,
          [ 6.0693e-01,  5.6396e-01,  5.1270e-01,  ...,  5.8789e-01,
            2.9224e-01,  4.8633e-01],
          [ 8.6304e-02,  2.3547e-01,  3.2080e-01,  ...,  8.8257e-02,
            3.0249e-01,  2.8760e-01],
          [ 3.0273e-01,  3.8647e-01,  1.5967e-01,  ...,  1.4246e-01,
            1.5173e-01,  4.5972e-01]],

         [[ 3.6865e-01,  4.7827e-01, -2.6199e-02,  ...,  4.4556e-01,
            1.8213e-01,  3.2349e-01],
          [ 4.1162e-01,  3.1201e-01,  3.2153e-01,  ...,  2.4002e-02,
            2.1997e-01,  4.9268e-01],
          [ 5.5176e-01,  3.0786e-01,  3.5791e-01,  ...,  1.9751e-01,
            1.4392e-01,  1.4075e-01],
          ...,
          [-1.9373e-01,  4.6753e-01,  1.5479e-01,  ..., -4.4922e-02,
            6.3574e-01,  2.0728e-01],
          [ 3.5840e-01, -7.0374e-02,  6.0089e-02,  ...,  4.7583e-01,
            1.2549e-01,  1.1035e-01],
          [ 2.7441e-01,  5.6006e-01,  4.0698e-01,  ...,  1.6235e-01,
            1.5576e-01,  1.4404e-01]]]], device='cuda:0', dtype=torch.float16,
       requires_grad=True)
abs top (1, 26, 2029, 60). Ref: -0.0006122589111328125, Triton: 0.006328582763671875
ref:  tensor([[[[ 0.0000e+00,  0.0000e+00,  0.0000e+00,  ...,  0.0000e+00,
            0.0000e+00,  0.0000e+00],
          [ 4.2801e-03, -4.9133e-02,  5.4718e-02,  ...,  5.0934e-02,
            4.9957e-02,  2.0905e-03],
          [ 3.7170e-02, -1.7990e-02,  1.1215e-02,  ...,  4.5654e-02,
            5.0659e-03, -5.8746e-03],
          ...,
          [ 2.1553e-03, -2.3994e-03,  1.0767e-03,  ...,  1.7774e-04,
           -3.3498e-04,  2.9635e-04],
          [-2.4509e-03, -1.2760e-03,  2.2717e-03,  ..., -2.1706e-03,
           -4.1084e-03, -3.0637e-04],
          [ 1.4629e-03, -1.4715e-03,  2.2717e-03,  ..., -1.7595e-03,
            9.1124e-04, -5.9080e-04]],

         [[ 0.0000e+00,  0.0000e+00,  0.0000e+00,  ...,  0.0000e+00,
            0.0000e+00,  0.0000e+00],
          [ 4.7089e-02,  2.9236e-02,  2.3346e-02,  ...,  1.1185e-02,
           -1.8738e-02, -4.7943e-02],
          [ 1.2360e-03,  1.3132e-03,  8.8549e-04,  ...,  2.2449e-03,
           -2.5439e-04, -2.2011e-03],
          ...,
          [-1.4925e-03, -1.0262e-03, -2.1629e-03,  ..., -3.1433e-03,
           -3.1567e-04, -1.5440e-03],
          [ 9.4843e-04, -9.7466e-04, -2.3041e-03,  ...,  4.0102e-04,
            7.7963e-04, -3.0689e-03],
          [-1.0996e-03, -1.5144e-03, -4.8423e-04,  ..., -2.7332e-03,
           -3.1242e-03, -2.6665e-03]],

         [[ 0.0000e+00,  0.0000e+00,  0.0000e+00,  ...,  0.0000e+00,
            0.0000e+00,  0.0000e+00],
          [-9.6741e-03, -4.6692e-02, -9.5337e-02,  ...,  1.0490e-02,
           -7.5378e-02, -3.1982e-02],
          [ 9.3460e-03,  3.8330e-02,  9.3201e-02,  ..., -7.5493e-03,
            5.0812e-02,  3.6163e-02],
          ...,
          [ 5.3358e-04,  4.6515e-04,  2.2888e-03,  ...,  2.1133e-03,
            3.6640e-03,  7.0286e-04],
          [-8.6248e-05,  1.2140e-03, -2.3155e-03,  ...,  6.9523e-04,
            2.3613e-03, -4.9162e-04],
          [ 1.2321e-03,  1.5917e-03,  1.3275e-03,  ..., -1.5745e-03,
            7.1716e-04,  2.0790e-03]],

         ...,

         [[ 0.0000e+00,  0.0000e+00,  0.0000e+00,  ...,  0.0000e+00,
            0.0000e+00,  0.0000e+00],
          [ 2.4719e-03, -1.3748e-02,  2.3148e-02,  ...,  1.7052e-03,
            3.0441e-03,  8.8654e-03],
          [ 3.6346e-02, -1.1694e-01,  9.8083e-02,  ...,  6.6795e-03,
           -2.7466e-03,  5.5908e-02],
          ...,
          [-3.0880e-03,  1.1263e-03, -8.9264e-04,  ...,  2.6822e-04,
            1.6823e-03,  9.3031e-04],
          [ 8.6451e-04,  3.0289e-03, -2.4281e-03,  ...,  7.0333e-04,
           -3.5262e-04,  8.7738e-04],
          [-7.1526e-04, -1.3218e-03, -7.7629e-04,  ..., -1.9159e-03,
            2.4259e-04,  1.0462e-03]],

         [[ 0.0000e+00,  0.0000e+00,  0.0000e+00,  ...,  0.0000e+00,
            0.0000e+00,  0.0000e+00],
          [-2.5742e-02, -2.5284e-02, -1.9562e-02,  ..., -2.0523e-02,
           -1.5381e-02, -1.0857e-02],
          [-1.6220e-02, -2.3026e-02, -2.2049e-02,  ...,  7.0810e-05,
           -2.0889e-02,  6.9084e-03],
          ...,
          [-1.3170e-03, -8.4257e-04,  1.1835e-03,  ...,  1.7071e-03,
            7.7057e-04, -2.3861e-03],
          [-5.6624e-06, -1.1355e-04,  1.2426e-03,  ...,  8.9645e-04,
           -1.7300e-03,  2.6047e-05],
          [-1.0948e-03, -6.8998e-04,  5.9175e-04,  ..., -2.1267e-03,
           -1.0004e-03,  1.5211e-03]],

         [[ 0.0000e+00,  0.0000e+00,  0.0000e+00,  ...,  0.0000e+00,
            0.0000e+00,  0.0000e+00],
          [-1.2772e-02,  4.4739e-02,  2.6382e-02,  ...,  1.5404e-02,
           -5.6763e-02,  6.5369e-02],
          [-2.4261e-02,  2.3865e-02, -1.4717e-02,  ..., -1.5251e-02,
           -5.3223e-02,  9.6436e-03],
          ...,
          [-1.4484e-04, -1.4896e-03,  1.2054e-03,  ...,  2.2659e-03,
            7.7105e-04, -1.3542e-03],
          [-1.2970e-03, -4.0960e-04,  8.7214e-04,  ..., -6.8235e-04,
           -6.0129e-04,  4.0932e-03],
          [ 8.0967e-04,  4.3607e-04, -2.5291e-03,  ..., -6.6471e-04,
            1.3132e-03,  5.3644e-04]]],


        [[[ 0.0000e+00,  0.0000e+00,  0.0000e+00,  ...,  0.0000e+00,
            0.0000e+00,  0.0000e+00],
          [-2.9755e-03, -2.9507e-03,  1.1959e-03,  ...,  3.2043e-03,
           -1.0276e-04, -2.2011e-03],
          [-5.7037e-02, -2.2079e-02,  2.7328e-02,  ...,  4.5807e-02,
            2.4384e-02, -4.6631e-02],
          ...,
          [ 7.0906e-04,  7.2956e-04,  1.6003e-03,  ...,  1.1883e-03,
           -1.0576e-03,  1.0309e-03],
          [ 4.2987e-04, -1.3323e-03, -1.1835e-03,  ...,  5.0259e-04,
           -1.4000e-03,  3.3021e-04],
          [ 5.4026e-04, -1.5078e-03,  1.8950e-03,  ..., -8.9407e-04,
           -2.4533e-04,  3.7813e-04]],

         [[ 0.0000e+00,  0.0000e+00,  0.0000e+00,  ...,  0.0000e+00,
            0.0000e+00,  0.0000e+00],
          [-1.6174e-02, -3.4332e-02, -6.8855e-03,  ...,  1.6113e-02,
            3.8849e-02, -1.5366e-02],
          [-5.3444e-03, -5.3558e-02,  6.4240e-03,  ..., -3.9154e-02,
           -6.9458e-02,  5.8655e-02],
          ...,
          [-1.7843e-03, -9.9850e-04,  3.5357e-04,  ..., -1.2531e-03,
           -1.9159e-03, -7.7581e-04],
          [ 1.2627e-03,  1.2960e-03,  4.0674e-04,  ...,  1.2121e-03,
            9.8991e-04, -1.7176e-03],
          [ 1.1721e-03, -2.5702e-04, -6.8378e-04,  ...,  7.7868e-04,
            3.6645e-04, -8.4496e-04]],

         [[ 0.0000e+00,  0.0000e+00,  0.0000e+00,  ...,  0.0000e+00,
            0.0000e+00,  0.0000e+00],
          [-1.8204e-02, -3.2471e-02,  7.4387e-03,  ...,  1.0674e-02,
           -1.6357e-02, -1.8127e-02],
          [-4.0833e-02, -3.6072e-02,  1.0147e-02,  ...,  2.9419e-02,
           -3.8483e-02, -4.6082e-02],
          ...,
          [ 3.9148e-04, -1.5526e-03,  1.4334e-03,  ..., -7.3481e-04,
           -8.7643e-04,  2.2888e-03],
          [ 4.7183e-04, -7.1573e-04, -1.8463e-03,  ..., -7.2050e-04,
            1.5545e-03, -5.8556e-04],
          [-2.2602e-03,  3.8075e-04,  1.7226e-05,  ..., -1.9360e-03,
           -3.7146e-04, -5.9009e-06]],

         ...,

         [[ 0.0000e+00,  0.0000e+00,  0.0000e+00,  ...,  0.0000e+00,
            0.0000e+00,  0.0000e+00],
          [ 8.0261e-03,  1.4885e-02, -1.5976e-02,  ..., -5.2917e-02,
            2.8259e-02, -6.9923e-03],
          [-6.3629e-03, -2.0409e-03,  1.0086e-02,  ...,  3.4504e-03,
           -7.2896e-05,  5.0068e-04],
          ...,
          [-1.4954e-03, -1.6022e-03, -1.6165e-03,  ..., -1.2550e-03,
            1.0574e-04,  2.7323e-04],
          [-9.6858e-05,  6.0463e-04,  1.7576e-03,  ...,  1.3363e-04,
            2.5501e-03,  5.1641e-04],
          [-2.5678e-04, -7.2050e-04, -3.6001e-04,  ..., -7.8440e-04,
            9.7132e-04, -6.7520e-04]],

         [[ 0.0000e+00,  0.0000e+00,  0.0000e+00,  ...,  0.0000e+00,
            0.0000e+00,  0.0000e+00],
          [ 1.8539e-03,  2.4292e-02,  7.9727e-03,  ..., -1.0300e-02,
            1.2093e-03,  6.4468e-04],
          [-1.0841e-02,  3.3203e-02, -4.6173e-02,  ...,  1.7761e-02,
            7.4341e-02,  1.2505e-02],
          ...,
          [-2.9316e-03,  1.5259e-03, -1.7872e-03,  ..., -4.2772e-04,
           -8.8501e-04, -1.9760e-03],
          [-3.4189e-04, -1.9360e-03, -1.5247e-04,  ..., -3.2806e-04,
           -3.2139e-04,  5.7757e-05],
          [-3.2520e-03,  2.5768e-03,  8.8871e-05,  ..., -5.0306e-04,
            7.4863e-05, -2.4567e-03]],

         [[ 0.0000e+00,  0.0000e+00,  0.0000e+00,  ...,  0.0000e+00,
            0.0000e+00,  0.0000e+00],
          [ 1.0910e-03, -1.6899e-03,  6.2084e-04,  ...,  1.4343e-03,
           -4.8065e-04,  2.6340e-03],
          [ 5.7220e-03, -1.7242e-03, -9.7370e-04,  ...,  8.8806e-03,
           -2.1896e-03,  3.3508e-02],
          ...,
          [ 1.0662e-03,  2.6774e-04,  6.2585e-05,  ..., -3.1586e-03,
            4.2319e-04, -1.8854e-03],
          [ 1.9741e-03,  9.1743e-04,  6.1464e-04,  ...,  6.9499e-05,
           -9.9659e-04, -8.5974e-04],
          [ 6.1333e-05,  6.7186e-04, -3.5596e-04,  ..., -7.7200e-04,
           -2.0618e-03, -1.2579e-03]]],


        [[[ 0.0000e+00,  0.0000e+00,  0.0000e+00,  ...,  0.0000e+00,
            0.0000e+00,  0.0000e+00],
          [-2.7725e-02,  4.1504e-02,  4.5166e-02,  ...,  2.5162e-02,
           -1.6556e-02, -3.0533e-02],
          [ 4.3823e-02, -3.3783e-02,  7.5531e-03,  ..., -1.5343e-02,
            1.4105e-03,  4.6753e-02],
          ...,
          [ 9.9087e-04,  8.3685e-04, -9.8324e-04,  ..., -2.8610e-03,
            1.8778e-03, -4.1842e-04],
          [ 3.2711e-03, -5.7554e-04, -1.1072e-03,  ..., -9.3794e-04,
           -1.8835e-03,  1.3847e-03],
          [ 2.2545e-03, -2.1386e-04,  5.4240e-06,  ...,  6.1703e-04,
           -8.9312e-04, -3.9220e-04]],

         [[ 0.0000e+00,  0.0000e+00,  0.0000e+00,  ...,  0.0000e+00,
            0.0000e+00,  0.0000e+00],
          [ 6.9580e-02,  4.2389e-02,  5.5725e-02,  ...,  3.8635e-02,
           -4.9973e-03, -1.2444e-02],
          [ 2.5940e-02, -1.9211e-02,  5.0385e-02,  ...,  9.6375e-02,
            5.1605e-02, -3.6488e-03],
          ...,
          [ 8.4352e-04,  8.2684e-04,  3.0375e-04,  ..., -3.5667e-04,
           -2.7218e-03,  4.2534e-04],
          [ 3.0518e-04,  7.6580e-04,  8.9693e-04,  ...,  1.6680e-03,
           -9.8610e-04, -7.3862e-04],
          [ 7.3195e-04,  3.1853e-03, -2.6112e-03,  ..., -1.1311e-03,
            1.6155e-03, -9.4557e-04]],

         [[ 0.0000e+00,  0.0000e+00,  0.0000e+00,  ...,  0.0000e+00,
            0.0000e+00,  0.0000e+00],
          [-9.2392e-03,  1.0490e-02, -1.3062e-02,  ..., -1.9722e-03,
            1.1711e-03, -6.5460e-03],
          [-1.6815e-02,  1.6983e-02, -4.9164e-02,  ...,  1.3145e-02,
            3.6831e-03, -1.5053e-02],
          ...,
          [ 8.1921e-04,  6.4421e-04, -9.1076e-04,  ...,  1.0061e-03,
           -1.1759e-03,  1.7166e-03],
          [-1.4420e-03,  7.8487e-04,  3.0088e-04,  ...,  2.1994e-05,
            6.5756e-04, -1.2913e-03],
          [-1.8096e-04,  3.0403e-03,  2.4300e-03,  ..., -1.5154e-03,
            7.9823e-04, -1.0347e-03]],

         ...,

         [[ 0.0000e+00,  0.0000e+00,  0.0000e+00,  ...,  0.0000e+00,
            0.0000e+00,  0.0000e+00],
          [-2.2476e-02, -1.6775e-03,  8.4991e-03,  ..., -6.7101e-03,
            2.2003e-02, -7.2327e-02],
          [-5.3802e-02, -1.0017e-02, -3.6652e-02,  ..., -2.8336e-02,
            3.0563e-02,  7.7393e-02],
          ...,
          [ 1.5187e-04, -8.6021e-04, -2.4605e-03,  ...,  5.1785e-04,
            1.0738e-03,  1.4038e-03],
          [-4.3678e-04, -5.2977e-04, -2.2259e-03,  ...,  1.5507e-03,
            9.4938e-04, -1.4277e-03],
          [ 1.5044e-04,  2.2449e-03,  1.7757e-03,  ..., -9.0361e-04,
            1.0777e-03, -1.8177e-03]],

         [[ 0.0000e+00,  0.0000e+00,  0.0000e+00,  ...,  0.0000e+00,
            0.0000e+00,  0.0000e+00],
          [ 3.3140e-04,  1.0483e-02, -1.2573e-02,  ...,  3.5034e-02,
           -1.6068e-02,  3.9520e-02],
          [-1.6998e-02,  1.4038e-02, -1.8448e-02,  ...,  6.9160e-03,
            1.0872e-03,  4.7424e-02],
          ...,
          [ 1.4794e-04, -3.6907e-03, -1.2386e-04,  ...,  9.1076e-04,
           -6.7663e-04,  2.2106e-03],
          [ 8.7690e-04, -1.7130e-04, -1.3428e-03,  ...,  9.9564e-04,
            2.5425e-03, -1.5249e-03],
          [ 1.4544e-03, -3.1328e-04, -3.0375e-04,  ..., -3.5882e-04,
            1.3638e-04,  3.0994e-04]],

         [[ 0.0000e+00,  0.0000e+00,  0.0000e+00,  ...,  0.0000e+00,
            0.0000e+00,  0.0000e+00],
          [-2.8467e-04, -2.2292e-04, -7.8857e-05,  ..., -5.4896e-05,
           -9.2804e-05,  4.7565e-05],
          [ 8.5510e-02,  6.9214e-02,  4.3427e-02,  ...,  2.7252e-02,
            1.2566e-02,  3.2234e-03],
          ...,
          [-5.2166e-04, -2.8114e-03,  2.0015e-04,  ..., -6.0177e-04,
           -3.2558e-03, -6.5756e-04],
          [ 4.1795e-04,  1.6093e-06, -9.6655e-04,  ..., -2.3580e-04,
            2.6932e-03,  1.5144e-03],
          [ 3.2043e-04, -1.6556e-03, -4.2534e-04,  ...,  2.5539e-03,
           -2.0850e-04, -2.0409e-03]]],


        [[[ 0.0000e+00,  0.0000e+00,  0.0000e+00,  ...,  0.0000e+00,
            0.0000e+00,  0.0000e+00],
          [ 2.6474e-02, -1.8158e-02, -4.0436e-02,  ..., -7.1487e-03,
           -5.7373e-03, -1.0536e-02],
          [ 3.6163e-02, -3.5156e-02, -4.1901e-02,  ...,  1.8225e-03,
           -1.8053e-03,  2.0660e-02],
          ...,
          [-3.7432e-04,  1.1504e-05, -6.1417e-04,  ..., -2.3861e-03,
            4.2868e-04, -2.0161e-03],
          [ 7.7915e-04, -2.7504e-03, -2.5444e-03,  ..., -5.9700e-04,
           -1.2789e-03, -1.0004e-03],
          [-1.1597e-03, -1.1978e-03,  1.3199e-03,  ..., -6.5136e-04,
            3.1719e-03,  8.5878e-04]],

         [[ 0.0000e+00,  0.0000e+00,  0.0000e+00,  ...,  0.0000e+00,
            0.0000e+00,  0.0000e+00],
          [-1.1177e-02, -1.6174e-03, -8.1726e-02,  ..., -4.7638e-02,
           -1.0490e-02, -3.2349e-03],
          [ 2.6627e-03, -1.0803e-02, -5.1758e-02,  ...,  1.1039e-04,
            2.1439e-02,  1.5640e-02],
          ...,
          [-1.3847e-03,  5.3549e-04, -2.3246e-04,  ..., -2.2182e-03,
            4.4370e-04,  3.7136e-03],
          [-8.2350e-04, -9.7656e-04, -6.4421e-04,  ...,  1.4086e-03,
            4.4403e-03,  1.3762e-03],
          [-4.6234e-03,  3.1986e-03,  1.2112e-03,  ..., -1.4544e-03,
            3.3927e-04, -1.5154e-03]],

         [[ 0.0000e+00,  0.0000e+00,  0.0000e+00,  ...,  0.0000e+00,
            0.0000e+00,  0.0000e+00],
          [ 3.7689e-03,  1.9104e-02, -1.0586e-03,  ...,  7.0076e-03,
            8.1682e-04,  1.4084e-02],
          [ 6.7596e-03, -5.5466e-03,  1.5869e-02,  ..., -4.2038e-03,
           -7.6561e-03,  3.6774e-03],
          ...,
          [ 9.8705e-04, -9.2745e-04, -3.7432e-04,  ...,  1.2712e-03,
           -1.3552e-03, -8.6355e-04],
          [-2.3098e-03, -1.3714e-03, -1.0118e-03,  ...,  1.5087e-03,
           -3.3188e-03, -7.6628e-04],
          [-1.1797e-03,  1.1234e-03,  1.5249e-03,  ..., -2.7943e-04,
            1.3494e-04, -2.2149e-04]],

         ...,

         [[ 0.0000e+00,  0.0000e+00,  0.0000e+00,  ...,  0.0000e+00,
            0.0000e+00,  0.0000e+00],
          [ 1.9226e-02,  2.2842e-02,  4.7874e-03,  ...,  1.2039e-02,
            2.4857e-02, -3.4088e-02],
          [-4.3365e-02, -4.3335e-02, -6.0730e-03,  ..., -1.8936e-02,
           -4.2084e-02,  7.3303e-02],
          ...,
          [ 9.2268e-04, -1.8978e-03,  3.8433e-04,  ..., -6.2752e-04,
            4.6444e-04, -1.2884e-03],
          [-2.1896e-03,  1.4448e-03,  2.0885e-03,  ...,  6.1989e-04,
            1.1940e-03,  1.4305e-06],
          [-1.2474e-03, -2.0065e-03, -1.3685e-03,  ..., -1.4696e-03,
           -2.6608e-04, -2.9030e-03]],

         [[ 0.0000e+00,  0.0000e+00,  0.0000e+00,  ...,  0.0000e+00,
            0.0000e+00,  0.0000e+00],
          [-8.5297e-03, -7.0839e-03,  1.1493e-01,  ..., -9.6741e-02,
           -1.2909e-02,  3.7140e-02],
          [ 4.3884e-02, -6.8626e-03, -2.6077e-02,  ...,  5.8403e-03,
           -2.8900e-02,  2.6031e-02],
          ...,
          [ 1.6451e-04, -8.1301e-04,  1.7319e-03,  ..., -2.1229e-03,
            2.8267e-03, -1.4400e-04],
          [ 2.7514e-04,  9.5463e-04, -5.9485e-05,  ..., -6.7329e-04,
            3.0828e-04,  9.2888e-04],
          [-6.9141e-04,  8.7976e-05, -8.7917e-05,  ..., -2.5501e-03,
            1.2245e-03,  2.6245e-03]],

         [[ 0.0000e+00,  0.0000e+00,  0.0000e+00,  ...,  0.0000e+00,
            0.0000e+00,  0.0000e+00],
          [ 2.0618e-01,  1.8188e-01, -1.7834e-01,  ..., -1.7432e-01,
            8.8654e-03,  9.5642e-02],
          [ 6.5231e-04,  2.3331e-02, -1.9165e-02,  ..., -2.7359e-02,
            6.4163e-03,  1.4534e-02],
          ...,
          [-3.1967e-03,  2.0962e-03,  1.9875e-03,  ..., -1.7452e-03,
            1.4296e-03,  2.6875e-03],
          [-1.3733e-03, -1.4286e-03, -7.6342e-04,  ...,  2.8496e-03,
            1.5936e-03, -3.8910e-04],
          [ 4.0150e-04,  9.1982e-04, -1.1282e-03,  ...,  2.5177e-03,
            1.0166e-03, -4.1962e-05]]]], device='cuda:0', dtype=torch.float16)
triton:  tensor([[[[ 0.0000e+00,  0.0000e+00,  0.0000e+00,  ...,  0.0000e+00,
            0.0000e+00,  0.0000e+00],
          [ 4.3449e-03, -4.9103e-02,  5.4779e-02,  ...,  5.0964e-02,
            4.9957e-02,  2.1286e-03],
          [ 3.7201e-02, -1.7975e-02,  1.1284e-02,  ...,  4.5685e-02,
            5.1117e-03, -5.8403e-03],
          ...,
          [ 3.0975e-03, -1.6451e-03,  1.8539e-03,  ...,  1.1759e-03,
            7.2002e-04,  1.2531e-03],
          [-2.8515e-03, -1.7090e-03,  1.8187e-03,  ..., -2.6417e-03,
           -4.5509e-03, -6.8903e-04],
          [-3.4428e-03, -6.3744e-03, -2.7351e-03,  ..., -6.7139e-03,
           -3.9864e-03, -5.5466e-03]],

         [[ 0.0000e+00,  0.0000e+00,  0.0000e+00,  ...,  0.0000e+00,
            0.0000e+00,  0.0000e+00],
          [ 4.7058e-02,  2.9205e-02,  2.3300e-02,  ...,  1.1162e-02,
           -1.8753e-02, -4.7943e-02],
          [ 1.2274e-03,  1.2989e-03,  8.3971e-04,  ...,  2.2278e-03,
           -2.7966e-04, -2.2449e-03],
          ...,
          [-4.3821e-04,  4.8339e-05, -1.1559e-03,  ..., -2.0447e-03,
            6.9046e-04, -5.7077e-04],
          [-3.4847e-03, -5.4665e-03, -6.6719e-03,  ..., -4.0283e-03,
           -3.4542e-03, -7.4081e-03],
          [ 3.9558e-03,  3.5133e-03,  4.4098e-03,  ...,  2.2259e-03,
            1.7138e-03,  2.4433e-03]],

         [[ 0.0000e+00,  0.0000e+00,  0.0000e+00,  ...,  0.0000e+00,
            0.0000e+00,  0.0000e+00],
          [-9.6741e-03, -4.6692e-02, -9.5337e-02,  ...,  1.0490e-02,
           -7.5378e-02, -3.1982e-02],
          [ 9.3918e-03,  3.8361e-02,  9.3201e-02,  ..., -7.5150e-03,
            5.0842e-02,  3.6224e-02],
          ...,
          [ 2.5806e-03,  2.5482e-03,  4.4289e-03,  ...,  4.0855e-03,
            5.7945e-03,  2.7695e-03],
          [-2.6073e-03, -1.3819e-03, -4.7760e-03,  ..., -1.7939e-03,
           -2.7061e-04, -3.0689e-03],
          [-1.1110e-03, -8.9073e-04, -1.0738e-03,  ..., -3.9597e-03,
           -1.7357e-03, -2.9039e-04]],

         ...,

         [[ 0.0000e+00,  0.0000e+00,  0.0000e+00,  ...,  0.0000e+00,
            0.0000e+00,  0.0000e+00],
          [ 2.4090e-03, -1.3779e-02,  2.3102e-02,  ...,  1.6432e-03,
            2.9964e-03,  8.7891e-03],
          [ 3.6285e-02, -1.1707e-01,  9.8022e-02,  ...,  6.5880e-03,
           -2.8362e-03,  5.5847e-02],
          ...,
          [ 4.3449e-03,  8.6670e-03,  6.5536e-03,  ...,  7.7171e-03,
            8.9722e-03,  8.4763e-03],
          [ 8.5306e-04,  2.9869e-03, -2.4509e-03,  ...,  6.8521e-04,
           -3.9077e-04,  8.5163e-04],
          [-2.0313e-03, -2.6321e-03, -2.1706e-03,  ..., -3.2940e-03,
           -1.0576e-03, -3.3641e-04]],

         [[ 0.0000e+00,  0.0000e+00,  0.0000e+00,  ...,  0.0000e+00,
            0.0000e+00,  0.0000e+00],
          [-2.5604e-02, -2.5146e-02, -1.9379e-02,  ..., -2.0401e-02,
           -1.5282e-02, -1.0727e-02],
          [-1.6174e-02, -2.2980e-02, -2.1988e-02,  ...,  1.1635e-04,
           -2.0859e-02,  6.9618e-03],
          ...,
          [ 3.0308e-03,  3.3493e-03,  5.2910e-03,  ...,  6.0120e-03,
            5.0697e-03,  1.8740e-03],
          [ 3.0537e-03,  2.9392e-03,  4.5166e-03,  ...,  3.9864e-03,
            1.1349e-03,  3.1681e-03],
          [-3.4523e-03, -3.0479e-03, -1.7757e-03,  ..., -4.6310e-03,
           -3.4142e-03, -8.6641e-04]],

         [[ 0.0000e+00,  0.0000e+00,  0.0000e+00,  ...,  0.0000e+00,
            0.0000e+00,  0.0000e+00],
          [-1.3031e-02,  4.4647e-02,  2.6184e-02,  ...,  1.5236e-02,
           -5.7037e-02,  6.5186e-02],
          [-2.4185e-02,  2.3911e-02, -1.4671e-02,  ..., -1.5213e-02,
           -5.3162e-02,  9.7046e-03],
          ...,
          [-1.8187e-03, -3.2444e-03, -4.6325e-04,  ...,  5.7983e-04,
           -9.3460e-04, -2.8706e-03],
          [-3.4428e-03, -2.5272e-03, -1.4429e-03,  ..., -2.8286e-03,
           -2.8553e-03,  2.0370e-03],
          [ 1.4601e-03,  1.0395e-03, -1.9045e-03,  ..., -4.0114e-05,
            1.9855e-03,  1.1282e-03]]],


        [[[ 0.0000e+00,  0.0000e+00,  0.0000e+00,  ...,  0.0000e+00,
            0.0000e+00,  0.0000e+00],
          [-3.0003e-03, -2.9888e-03,  1.1234e-03,  ...,  3.1509e-03,
           -1.6475e-04, -2.2469e-03],
          [-5.7098e-02, -2.2156e-02,  2.7222e-02,  ...,  4.5746e-02,
            2.4292e-02, -4.6753e-02],
          ...,
          [ 7.5626e-04,  6.6996e-04,  1.6270e-03,  ...,  1.1902e-03,
           -1.1158e-03,  9.4604e-04],
          [-2.9144e-03, -4.6310e-03, -4.5967e-03,  ..., -2.9125e-03,
           -4.7989e-03, -3.2158e-03],
          [ 4.2839e-03,  2.3403e-03,  5.4855e-03,  ...,  2.7142e-03,
            3.6106e-03,  4.0894e-03]],

         [[ 0.0000e+00,  0.0000e+00,  0.0000e+00,  ...,  0.0000e+00,
            0.0000e+00,  0.0000e+00],
          [-1.6113e-02, -3.4210e-02, -6.8283e-03,  ...,  1.6205e-02,
            3.8910e-02, -1.5312e-02],
          [-5.3635e-03, -5.3558e-02,  6.3896e-03,  ..., -3.9215e-02,
           -6.9519e-02,  5.8594e-02],
          ...,
          [-7.1049e-04,  7.2002e-05,  1.5030e-03,  ..., -1.7750e-04,
           -8.6451e-04,  3.7622e-04],
          [ 6.3276e-04,  6.6376e-04, -2.1458e-04,  ...,  6.7043e-04,
            3.3450e-04, -2.2469e-03],
          [-3.2654e-03, -4.5929e-03, -5.3596e-03,  ..., -3.6335e-03,
           -4.0627e-03, -5.5389e-03]],

         [[ 0.0000e+00,  0.0000e+00,  0.0000e+00,  ...,  0.0000e+00,
            0.0000e+00,  0.0000e+00],
          [-1.8066e-02, -3.2318e-02,  7.5607e-03,  ...,  1.0849e-02,
           -1.6281e-02, -1.8082e-02],
          [-4.0802e-02, -3.6041e-02,  1.0170e-02,  ...,  2.9449e-02,
           -3.8452e-02, -4.6082e-02],
          ...,
          [ 1.1797e-03, -7.5865e-04,  2.0809e-03,  ..., -6.6459e-05,
           -1.3423e-04,  2.9716e-03],
          [ 6.9733e-03,  5.5733e-03,  4.4289e-03,  ...,  5.3635e-03,
            7.9041e-03,  5.7716e-03],
          [ 1.8206e-03,  4.4518e-03,  4.3182e-03,  ...,  2.2259e-03,
            3.7365e-03,  4.2114e-03]],

         ...,

         [[ 0.0000e+00,  0.0000e+00,  0.0000e+00,  ...,  0.0000e+00,
            0.0000e+00,  0.0000e+00],
          [ 8.0109e-03,  1.4862e-02, -1.6006e-02,  ..., -5.2917e-02,
            2.8229e-02, -7.0076e-03],
          [-6.2828e-03, -1.9932e-03,  1.0155e-02,  ...,  3.5057e-03,
           -2.4676e-05,  5.6219e-04],
          ...,
          [ 3.3855e-03,  3.0899e-03,  3.0937e-03,  ...,  3.5591e-03,
            4.8943e-03,  4.9515e-03],
          [ 1.1835e-03,  1.8406e-03,  3.1090e-03,  ...,  1.5097e-03,
            3.8300e-03,  1.8225e-03],
          [-1.5211e-04, -6.8617e-04, -4.2939e-04,  ..., -7.3004e-04,
            1.0223e-03, -6.5088e-04]],

         [[ 0.0000e+00,  0.0000e+00,  0.0000e+00,  ...,  0.0000e+00,
            0.0000e+00,  0.0000e+00],
          [ 1.8682e-03,  2.4292e-02,  7.9803e-03,  ..., -1.0284e-02,
            1.2207e-03,  6.5422e-04],
          [-1.0956e-02,  3.3051e-02, -4.6204e-02,  ...,  1.7654e-02,
            7.4219e-02,  1.2413e-02],
          ...,
          [-3.4046e-03,  1.1339e-03, -2.2125e-03,  ..., -8.8978e-04,
           -1.3723e-03, -2.4281e-03],
          [-4.2191e-03, -5.6496e-03, -4.0321e-03,  ..., -3.9902e-03,
           -4.2076e-03, -3.6030e-03],
          [ 1.0862e-03,  7.2746e-03,  4.4365e-03,  ...,  4.1428e-03,
            4.6310e-03,  1.8940e-03]],

         [[ 0.0000e+00,  0.0000e+00,  0.0000e+00,  ...,  0.0000e+00,
            0.0000e+00,  0.0000e+00],
          [ 1.3065e-03, -1.5488e-03,  8.1444e-04,  ...,  1.5383e-03,
           -3.3736e-04,  2.8954e-03],
          [ 5.7564e-03, -1.6928e-03, -9.4271e-04,  ...,  8.8882e-03,
           -2.1629e-03,  3.3539e-02],
          ...,
          [ 6.4011e-03,  5.5504e-03,  5.1117e-03,  ...,  2.2182e-03,
            5.5542e-03,  3.1796e-03],
          [ 9.9030e-03,  8.9188e-03,  8.3313e-03,  ...,  8.2855e-03,
            7.0190e-03,  7.1754e-03],
          [ 2.6875e-03,  3.4790e-03,  2.0733e-03,  ...,  1.8835e-03,
            6.3515e-04,  1.4181e-03]]],


        [[[ 0.0000e+00,  0.0000e+00,  0.0000e+00,  ...,  0.0000e+00,
            0.0000e+00,  0.0000e+00],
          [-2.7847e-02,  4.1534e-02,  4.5074e-02,  ...,  2.5040e-02,
           -1.6647e-02, -3.0655e-02],
          [ 4.3793e-02, -3.3813e-02,  7.5111e-03,  ..., -1.5381e-02,
            1.3933e-03,  4.6722e-02],
          ...,
          [ 1.3390e-03,  1.2074e-03, -6.1321e-04,  ..., -2.4815e-03,
            2.1954e-03, -7.7486e-05],
          [ 4.1161e-03,  1.2398e-04, -3.7336e-04,  ..., -1.1373e-04,
           -1.1511e-03,  2.0943e-03],
          [-1.9217e-03, -4.3526e-03, -4.1885e-03,  ..., -3.5477e-03,
           -4.8904e-03, -4.4975e-03]],

         [[ 0.0000e+00,  0.0000e+00,  0.0000e+00,  ...,  0.0000e+00,
            0.0000e+00,  0.0000e+00],
          [ 6.9580e-02,  4.2389e-02,  5.5725e-02,  ...,  3.8635e-02,
           -4.9973e-03, -1.2444e-02],
          [ 2.5909e-02, -1.9226e-02,  5.0354e-02,  ...,  9.6375e-02,
            5.1605e-02, -3.6678e-03],
          ...,
          [-5.6496e-03, -5.8212e-03, -6.2904e-03,  ..., -6.8703e-03,
           -9.0179e-03, -6.0043e-03],
          [-2.7065e-03, -2.2907e-03, -2.0504e-03,  ..., -1.2960e-03,
           -3.9597e-03, -3.7899e-03],
          [ 3.2234e-03,  5.8670e-03, -1.4234e-04,  ...,  1.3323e-03,
            4.0207e-03,  1.6012e-03]],

         [[ 0.0000e+00,  0.0000e+00,  0.0000e+00,  ...,  0.0000e+00,
            0.0000e+00,  0.0000e+00],
          [-9.1782e-03,  1.0536e-02, -1.3039e-02,  ..., -1.9064e-03,
            1.2102e-03, -6.5041e-03],
          [-1.6937e-02,  1.6891e-02, -4.9225e-02,  ...,  1.3031e-02,
            3.6068e-03, -1.5144e-02],
          ...,
          [-2.7313e-03, -2.7180e-03, -4.3983e-03,  ..., -2.4529e-03,
           -4.6844e-03, -1.7824e-03],
          [-3.2387e-03, -9.9182e-04, -1.4572e-03,  ..., -1.7710e-03,
           -1.1415e-03, -3.0880e-03],
          [-2.2202e-03,  1.0557e-03,  4.2939e-04,  ..., -3.5019e-03,
           -1.1129e-03, -3.0403e-03]],

         ...,

         [[ 0.0000e+00,  0.0000e+00,  0.0000e+00,  ...,  0.0000e+00,
            0.0000e+00,  0.0000e+00],
          [-2.2537e-02, -1.7328e-03,  8.4610e-03,  ..., -6.7863e-03,
            2.2003e-02, -7.2449e-02],
          [-5.3833e-02, -1.0071e-02, -3.6713e-02,  ..., -2.8412e-02,
            3.0548e-02,  7.7393e-02],
          ...,
          [ 2.3403e-03,  1.3447e-03, -3.2806e-04,  ...,  2.7142e-03,
            3.2711e-03,  3.5038e-03],
          [ 2.9869e-03,  2.8954e-03,  1.2980e-03,  ...,  4.9591e-03,
            4.4746e-03,  2.0161e-03],
          [ 2.1095e-03,  4.2877e-03,  3.7937e-03,  ...,  1.1358e-03,
            3.2635e-03,  2.9755e-04]],

         [[ 0.0000e+00,  0.0000e+00,  0.0000e+00,  ...,  0.0000e+00,
            0.0000e+00,  0.0000e+00],
          [ 3.3140e-04,  1.0483e-02, -1.2573e-02,  ...,  3.5034e-02,
           -1.6068e-02,  3.9520e-02],
          [-1.6937e-02,  1.4130e-02, -1.8372e-02,  ...,  6.9809e-03,
            1.1730e-03,  4.7485e-02],
          ...,
          [-1.9970e-03, -5.8327e-03, -2.2373e-03,  ..., -1.2598e-03,
           -2.8610e-03,  1.1581e-04],
          [ 3.3569e-03,  2.2240e-03,  1.1263e-03,  ...,  3.4103e-03,
            4.8828e-03,  9.1028e-04],
          [ 1.5173e-03, -1.9479e-04, -1.0371e-04,  ..., -3.1424e-04,
            1.9407e-04,  3.8195e-04]],

         [[ 0.0000e+00,  0.0000e+00,  0.0000e+00,  ...,  0.0000e+00,
            0.0000e+00,  0.0000e+00],
          [-3.0184e-04, -2.4199e-04, -1.0109e-04,  ..., -8.4639e-05,
           -1.2839e-04,  5.4836e-06],
          [ 8.5449e-02,  6.9153e-02,  4.3365e-02,  ...,  2.7191e-02,
            1.2505e-02,  3.1490e-03],
          ...,
          [ 1.5488e-03, -8.0681e-04,  2.1553e-03,  ...,  1.2560e-03,
           -1.2722e-03,  1.3876e-03],
          [-1.8759e-03, -2.2373e-03, -3.2654e-03,  ..., -2.4624e-03,
            4.3535e-04, -5.2786e-04],
          [-3.8218e-04, -2.4147e-03, -1.1673e-03,  ...,  1.8444e-03,
           -9.8705e-04, -2.6131e-03]]],


        [[[ 0.0000e+00,  0.0000e+00,  0.0000e+00,  ...,  0.0000e+00,
            0.0000e+00,  0.0000e+00],
          [ 2.6581e-02, -1.8051e-02, -4.0314e-02,  ..., -7.0572e-03,
           -5.6610e-03, -1.0445e-02],
          [ 3.6163e-02, -3.5126e-02, -4.1870e-02,  ...,  1.8291e-03,
           -1.7967e-03,  2.0645e-02],
          ...,
          [-5.8708e-03, -5.4817e-03, -5.9967e-03,  ..., -7.8888e-03,
           -5.0430e-03, -7.5035e-03],
          [ 2.7084e-03, -8.2350e-04, -5.5361e-04,  ...,  1.3294e-03,
            6.0368e-04,  8.7261e-04],
          [ 1.8644e-03,  1.7414e-03,  4.1885e-03,  ...,  2.1744e-03,
            6.1493e-03,  3.7460e-03]],

         [[ 0.0000e+00,  0.0000e+00,  0.0000e+00,  ...,  0.0000e+00,
            0.0000e+00,  0.0000e+00],
          [-1.1314e-02, -1.6890e-03, -8.1848e-02,  ..., -4.7699e-02,
           -1.0559e-02, -3.2787e-03],
          [ 2.5673e-03, -1.0857e-02, -5.1849e-02,  ...,  5.3704e-05,
            2.1393e-02,  1.5610e-02],
          ...,
          [-2.9049e-03, -9.3460e-04, -1.8253e-03,  ..., -3.8300e-03,
           -1.1034e-03,  2.0657e-03],
          [ 4.2610e-03,  4.2267e-03,  4.2496e-03,  ...,  6.5651e-03,
            9.4070e-03,  6.4926e-03],
          [-5.1575e-03,  2.6207e-03,  6.9189e-04,  ..., -2.0771e-03,
           -2.3425e-04, -2.0313e-03]],

         [[ 0.0000e+00,  0.0000e+00,  0.0000e+00,  ...,  0.0000e+00,
            0.0000e+00,  0.0000e+00],
          [ 3.8013e-03,  1.9135e-02, -1.0328e-03,  ...,  7.0572e-03,
            8.5068e-04,  1.4122e-02],
          [ 6.6566e-03, -5.6381e-03,  1.5762e-02,  ..., -4.3335e-03,
           -7.7248e-03,  3.5515e-03],
          ...,
          [-8.7881e-04, -2.6264e-03, -2.1973e-03,  ..., -4.7517e-04,
           -3.2845e-03, -2.7161e-03],
          [ 1.7929e-04,  1.1282e-03,  1.3475e-03,  ...,  3.7994e-03,
           -8.5306e-04,  1.5841e-03],
          [-4.6158e-03, -2.2717e-03, -1.8892e-03,  ..., -3.6488e-03,
           -3.3855e-03, -3.5496e-03]],

         ...,

         [[ 0.0000e+00,  0.0000e+00,  0.0000e+00,  ...,  0.0000e+00,
            0.0000e+00,  0.0000e+00],
          [ 1.9302e-02,  2.2858e-02,  4.8409e-03,  ...,  1.2070e-02,
            2.4887e-02, -3.4027e-02],
          [-4.3457e-02, -4.3365e-02, -6.1569e-03,  ..., -1.8982e-02,
           -4.2145e-02,  7.3242e-02],
          ...,
          [ 2.4300e-03, -4.3297e-04,  1.8358e-03,  ...,  8.3208e-04,
            1.8463e-03,  2.2805e-04],
          [ 1.5306e-03,  5.0507e-03,  5.5809e-03,  ...,  4.2000e-03,
            4.7646e-03,  3.4008e-03],
          [-4.0283e-03, -4.9515e-03, -4.0512e-03,  ..., -4.2572e-03,
           -3.0975e-03, -5.8212e-03]],

         [[ 0.0000e+00,  0.0000e+00,  0.0000e+00,  ...,  0.0000e+00,
            0.0000e+00,  0.0000e+00],
          [-8.5754e-03, -7.1220e-03,  1.1481e-01,  ..., -9.6741e-02,
           -1.2939e-02,  3.7079e-02],
          [ 4.3884e-02, -6.8588e-03, -2.6108e-02,  ...,  5.8708e-03,
           -2.8885e-02,  2.6031e-02],
          ...,
          [-1.8387e-03, -2.6379e-03, -2.2507e-04,  ..., -3.9940e-03,
            7.6675e-04, -2.0790e-03],
          [ 9.1124e-04,  1.5774e-03,  5.7220e-04,  ..., -5.0724e-05,
            9.6798e-04,  1.5869e-03],
          [ 9.3460e-04,  1.8349e-03,  1.6174e-03,  ..., -8.7118e-04,
            2.9526e-03,  4.3259e-03]],

         [[ 0.0000e+00,  0.0000e+00,  0.0000e+00,  ...,  0.0000e+00,
            0.0000e+00,  0.0000e+00],
          [ 2.0618e-01,  1.8188e-01, -1.7834e-01,  ..., -1.7432e-01,
            8.8654e-03,  9.5642e-02],
          [ 6.8951e-04,  2.3361e-02, -1.9104e-02,  ..., -2.7283e-02,
            6.4697e-03,  1.4565e-02],
          ...,
          [-5.8060e-03, -3.9482e-04, -6.6996e-04,  ..., -4.4365e-03,
           -1.1988e-03,  1.0324e-04],
          [ 4.7150e-03,  4.3488e-03,  5.0621e-03,  ...,  8.3466e-03,
            7.2670e-03,  5.2032e-03],
          [ 3.2997e-04,  9.0694e-04, -1.2169e-03,  ...,  2.5005e-03,
            9.4223e-04, -2.2590e-05]]]], device='cuda:0', dtype=torch.float16)
F

=================================== FAILURES ===================================
____________________________ test_op[4-48-2048-64] _____________________________

Z = 4, H = 48, N_CTX = 2048, D_HEAD = 64, dtype = torch.float16

    @pytest.mark.parametrize('Z, H, N_CTX, D_HEAD', [
        (4, 48, 128, 64),
        (4, 48, 256, 64),
        (4, 48, 512, 64),
        (4, 48, 1024, 64),
        (4, 48, 2048, 64),
        (4, 48, 4096, 64),
        #  (4, 48, 8192, 64), out of memory
    ])
    @pytest.mark.skipif(torch.cuda.get_device_capability()[0] < 9, reason="requires arch 9+")
    def test_op(Z, H, N_CTX, D_HEAD, dtype=torch.float16):
        g = torch.Generator(device="cuda")
        g.manual_seed(20)
        q = torch.empty((Z, H, N_CTX, D_HEAD), dtype=dtype, device="cuda").normal_(mean=0.1, std=0.2,
                                                                                   generator=g).requires_grad_()
        k = torch.empty((Z, H, N_CTX, D_HEAD), dtype=dtype, device="cuda").normal_(mean=0.4, std=0.2,
                                                                                   generator=g).requires_grad_()
        v = torch.empty((Z, H, N_CTX, D_HEAD), dtype=dtype, device="cuda").normal_(mean=0.3, std=0.2,
                                                                                   generator=g).requires_grad_()
        print("q input: ", q)
        print("k input: ", k)
        print("v input: ", v)
        sm_scale = 0.2
        dout = torch.randn_like(q)
        # reference implementation
        M = torch.tril(torch.ones((N_CTX, N_CTX), device="cuda"))
        p = torch.matmul(q, k.transpose(2, 3)) * sm_scale
        for z in range(Z):
            for h in range(H):
                p[:, :, M == 0] = float("-inf")
        p = torch.softmax(p.float(), dim=-1).half()
        # p = torch.exp(p)
        ref_out = torch.matmul(p, v)
        ref_out.backward(dout)
        ref_dv, v.grad = v.grad.clone(), None
        ref_dk, k.grad = k.grad.clone(), None
        ref_dq, q.grad = q.grad.clone(), None
        # triton implementation
        tri_out = attention(q, k, v, sm_scale)
        # print(ref_out)
        # print(tri_out)
        tri_out.backward(dout)
        tri_dv, v.grad = v.grad.clone(), None
        tri_dk, k.grad = k.grad.clone(), None
        tri_dq, q.grad = q.grad.clone(), None
        # compare
        torch.testing.assert_close(ref_out, tri_out, atol=1e-2, rtol=0)
        print(f"abs top (1, 26, 2029, 60). Ref: {ref_dq[1, 26, 2029, 60]}, Triton: {tri_dq[1, 26, 2029, 60]}")
        print("ref: ", ref_dq)
        print("triton: ", tri_dq)
>       torch.testing.assert_close(ref_dq, tri_dq, atol=1e-2, rtol=0)
E       AssertionError: Tensor-likes are not close!
E
E       Mismatched elements: 3753 / 25165824 (0.0%)
E       Greatest absolute difference: 0.0141143798828125 at index (3, 0, 1937, 22) (up to 0.01 allowed)
E       Greatest relative difference: 2.0703125 at index (0, 4, 1955, 53) (up to 0 allowed)

python/test/unit/hopper/test_flashattention.py:411: AssertionError
=========================== short test summary info ============================
FAILED python/test/unit/hopper/test_flashattention.py::test_op[4-48-2048-64] - AssertionError: Tensor-likes are not close!

Mismatched elements: 3753 / 25165824 (0.0%)
Greatest absolute difference: 0.0141143798828125 at index (3, 0, 1937, 22) (up to 0.01 allowed)
Greatest relative difference: 2.0703125 at index (0, 4, 1955, 53) (up to 0 allowed)
============================== 1 failed in 6.87s ===============================
